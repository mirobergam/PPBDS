<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Chapter 8 Two Parameters | Preceptor’s Primer for Bayesian Data Science" />
<meta property="og:type" content="book" />



<meta name="github-repo" content="davidkane9/PPBDS" />

<meta name="author" content="David Kane" />

<meta name="date" content="2020-07-08" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="Chapter 8 Two Parameters | Preceptor’s Primer for Bayesian Data Science">

<title>Chapter 8 Two Parameters | Preceptor’s Primer for Bayesian Data Science</title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css-0/msmb.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }

code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Preceptor's Primer for Bayesian Data Science<p><p class="author">David Kane</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html">Cover</a>
<a href="preamble.html">Preamble</a>
<a href="visualization.html"><span class="toc-section-number">1</span> Visualization</a>
<a href="wrangling.html"><span class="toc-section-number">2</span> Tidyverse</a>
<a href="rubin-causal-model.html"><span class="toc-section-number">3</span> Rubin Causal Model</a>
<a href="functions.html"><span class="toc-section-number">4</span> Functions</a>
<a href="probability.html"><span class="toc-section-number">5</span> Probability</a>
<a href="sampling.html"><span class="toc-section-number">6</span> Sampling</a>
<a href="one-parameter.html"><span class="toc-section-number">7</span> One Parameter</a>
<a id="active-page" href="two-parameters.html"><span class="toc-section-number">8</span> Two Parameters</a><ul class="toc-sections">
<li class="toc"><a href="#eda-for-trains"> EDA for <code>trains</code></a></li>
<li class="toc"><a href="#estimate-age"> Estimate Age</a></li>
<li class="toc"><a href="#two-parameters-1"> Two Parameters</a></li>
<li class="toc"><a href="#calculating-a-third-parameter"> Calculating a third parameter</a></li>
<li class="toc"><a href="#estimate-other-things"> Estimate other things</a></li>
<li class="toc"><a href="#estimate-trickier-things"> Estimate trickier things</a></li>
<li class="toc"><a href="#using-lm"> Using <code>lm()</code></a></li>
<li class="toc"><a href="#the-prediction-game"> The prediction game</a></li>
<li class="toc"><a href="#using-the-predict-function"> Using the predict() function</a></li>
<li class="toc"><a href="#rubin-causal-model-will-come-back-to-this-last"> Rubin Causal Model (WILL COME BACK TO THIS LAST)</a></li>
<li class="toc"><a href="#uncertainties"> Uncertainties</a></li>
<li class="toc"><a href="#testing-is-evil"> Testing is Evil</a></li>
</ul>
<a href="n-parameters.html"><span class="toc-section-number">9</span> N Parameters</a>
<a href="regression.html"><span class="toc-section-number">10</span> Continuous Response I</a>
<a href="multiple-regression.html"><span class="toc-section-number">11</span> Continuous Response II</a>
<a href="classification.html"><span class="toc-section-number">12</span> Discrete Response</a>
<a href="appendices.html">Appendices</a>
<a href="productivity.html">Productivity</a>
<a href="shiny.html">Shiny</a>
<a href="maps.html">Maps</a>
<a href="animation.html">Animation</a>
<a href="rubin-causal-model.html">References</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div id="two-parameters" class="section level1">
<h1>
<span class="header-section-number">Chapter 8</span> Two Parameters</h1>
<!-- This section is for general author comments and discussion. -->
<!-- 0) Make clear the distinction between "modeling for prediction" and "modeling for causation." The first is only about comparisons between categories. The second is stronger, a claim about changing an individual; it is a claim about potential outcomes. Multiple paragraphs throughout the chapter. -->
<!-- 1) Do we want to play the prediction game? If so, how? -->
<!-- 2) How do we connect this to the probability chapter? I am still thinking about this. Basic idea is that, what would we estimate would happen with a new experiment, which might include one or 10 or 1,000 new people? Just like coin-tossing from chapter 5. We need to make this connection very explicit. Read through chapter 5 and discuss.  Posterior distribution, given the data we have, of an unknown parameter. -->
<!-- 3) Should we make an explicit connection to the probability chapter by adding another dimension to that work? We have two coins, each with their own p. Build the joint distribution for them, with one on the x-axis and one on the y-axis. You need a near graphic for each value of the H number of heads total that you get from flipping them each N times. Then, you run the experiment, and you select the correct graphic. That shows you the best guess joint distribution. This is confusing!  -->
<div id="eda-for-trains" class="section level2">
<h2>
<span class="header-section-number">8.1</span> EDA for <code>trains</code>
</h2>
<!--  Point out that att_start is not something we will use in this chapter, but will use later. This is a brief warm up. Don't need to explore each variable in detail. All we are using is `treatment` and `income`. -->
<p>Let’s do some exploratory data analysis (EDA) of the <code>trains</code> data set from the <strong>PPBDS.data</strong> package. Enos (2014) randomly placed Spanish-speaking confederates on nine train platforms around Boston, Massachusetts. They examined how exposure to Spanish-speakers – the <code>treatment</code> – influenced attitudes toward immigration. These reactions were measured through changes in answers to three survey questions. Let’s load the libraries we will need in this chapter and look at the data.</p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="two-parameters.html#cb751-1"></a><span class="kw">library</span>(PPBDS.data)</span>
<span id="cb751-2"><a href="two-parameters.html#cb751-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb751-3"><a href="two-parameters.html#cb751-3"></a><span class="kw">library</span>(rsample)</span>
<span id="cb751-4"><a href="two-parameters.html#cb751-4"></a><span class="kw">library</span>(skimr)</span></code></pre></div>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="two-parameters.html#cb752-1"></a><span class="kw">glimpse</span>(trains)</span></code></pre></div>
<pre><code>## Rows: 115
## Columns: 8
## $ gender    &lt;chr&gt; "Female", "Female", "Male", "Male", "Male", "Female", "Fema…
## $ liberal   &lt;lgl&gt; FALSE, FALSE, TRUE, FALSE, TRUE, FALSE, FALSE, FALSE, FALSE…
## $ party     &lt;chr&gt; "Democrat", "Republican", "Democrat", "Democrat", "Democrat…
## $ age       &lt;dbl&gt; 31, 34, 63, 45, 55, 37, 53, 36, 54, 42, 33, 50, 24, 40, 53,…
## $ income    &lt;dbl&gt; 135000, 105000, 135000, 300000, 135000, 87500, 87500, 13500…
## $ att_start &lt;dbl&gt; 11, 9, 3, 11, 8, 13, 13, 10, 12, 9, 10, 11, 13, 6, 8, 13, 7…
## $ treatment &lt;fct&gt; Treated, Treated, Treated, Treated, Control, Treated, Contr…
## $ att_end   &lt;dbl&gt; 11, 10, 5, 11, 5, 13, 13, 11, 12, 10, 9, 9, 13, 7, 8, 13, 8…</code></pre>
<p>Here, we can see variables that indicate each respondent’s gender, political affiliation, age, and income. Additionally, we have variables that indicate whether a subject was in the control or treatment group, and the attitudes before or after the study in each of these subjects. Remember that for the <code>att_start</code> and <code>att_end</code> variables, a higher number means to a more conservative political standing and, correspondingly, a more exclusionary stance on immigration into the United States.</p>
<p>Although the <code>att_start</code> and <code>att_end</code> variables are central to Enos’ experiment, we will now focus our attention to the relationship between the <code>age</code> and <code>party</code> variable. The reason for investigating this instead of att_start and att_end will become clear later in the chapter. Furthermore, instead of investigating a single parameter of comparison like we did in chapter 7, we will incorporate the use of <em>two parameters</em> to create a holistic picture of how these two variables are related. How do our estimates and predictions regarding income change when we identify a specific party we want to work with within the data?</p>
</div>
<div id="estimate-age" class="section level2">
<h2>
<span class="header-section-number">8.2</span> Estimate Age</h2>
<!-- EM: We have decided to pivot this section away from income (due to its wonky distribution) and move to estimating AGE as our dependent variable -->
<!-- EM: We are also eliminating the bootstrap portion of this chapter in its entirety, as it was covered in ch7. At the very most, a reiteration of lm()'s validity is acceptable. Otherwise, it takes up too much space. -->
<!-- EM: Lastly, there should also be a Rubin table that is constructed for age ~ party. Ask Preceptor for more detailed instructions regarding this as he does a fantastic job explaining why it's necessary. In summary: age~party instead of income~party, get rid of bootstrapping because it's redundant, and have a Rubin table for age~party (there's already one for att_end~treatment later in the chapter. -->
<!-- EM: I cannot find the document that labels all the different kinds of uncertainty — I'm pretty sure "unknown unknowns" is used incorrectly below.-->
<!-- EM: Small change here -->
<!-- All the same tools which we used to estimate a single parameter in the previous chapter apply to estimate two parameters in this chapter. (Not sure what examples we will use in that chapter.) In fact, it is easy! We only need to do the bootstrap once. And, once we have those bootstrap samples, we just calculate mean(income) for treated and mean(income) for control. Key insight is that we don't need to do a bootstrap for each parameter we want to calculate. We do one bootstrap and then calculate as many parameters as we need to. We can also calculate medians or items like 5th highest income, and our uncertainty associated with those items. -->
<!-- The difference between the means is the same as the mean of the differences, but the ratio of the means is not the same as the mean of the ratios, and the same for confidence intervals. -->
<p>Recall how we constructed bootstrap distributions for select parameters through sampling with replacement in ch7. Through this bootstrapping process, we were able to construct <em>confidence intervals</em> for these parameters. Remember, confidence intervals are a tool to help us identify <em>parameter uncertainty</em>, which is the degree to which we are confident in these approximations of the <em>true values</em>, which are the real-life values we hope to capture through our work. Using the limited data in the <code>trains</code> dataset as representative of homogeneous white populations of the United States, bootstrap resampling will allow us to approximate a true value for any statistic with a certain degree of confidence — this could, for example, be the true average income of Boston commuters, or the true percentage of Boston commuters that are Republican (refer back to chapter 7 for a refresher on how this works out mathematically).</p>
<p>We will once again be using the <code>bootstraps()</code> function from the <strong>rsample</strong> package. You might think that since we’re shifting to calculating two parameters of comparison, we might need to conduct the entire bootstrapping process twice, once for each parameter. However, it’s much, much easier than that! We can actually calculate as many parameters as we need to for each replicate instead of doing a separate bootstrap for each parameter we want to track.</p>
<p>That was a lot of words; the idea is best illustrated for an example. Here is a bootstrap sample of the trains dataset with 1000 replicates, and the data contained in the first of these 1000 replicates (note that we need the <code>analysis()</code> function in order to view the data stored within each replicate because of the split data column):</p>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="two-parameters.html#cb754-1"></a>x &lt;-<span class="st"> </span><span class="kw">bootstraps</span>(trains, <span class="dv">1000</span>)</span>
<span id="cb754-2"><a href="two-parameters.html#cb754-2"></a></span>
<span id="cb754-3"><a href="two-parameters.html#cb754-3"></a>x<span class="op">$</span>splits[[<span class="dv">1</span>]] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">analysis</span>()</span></code></pre></div>
<pre><code>## # A tibble: 115 x 8
##    gender liberal party        age income att_start treatment att_end
##    &lt;chr&gt;  &lt;lgl&gt;   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;       &lt;dbl&gt;
##  1 Male   TRUE    Democrat      55 135000         8 Control         5
##  2 Male   TRUE    Democrat      60 135000        13 Control        13
##  3 Male   TRUE    Democrat      20 135000        14 Control        11
##  4 Female TRUE    Democrat      33 105000        10 Control        10
##  5 Male   FALSE   Democrat      29  62500        11 Control        14
##  6 Male   FALSE   Republican    36 135000        12 Treated        12
##  7 Male   FALSE   Democrat      63 250000        13 Control        10
##  8 Male   TRUE    Democrat      40  62500         6 Control         7
##  9 Male   TRUE    Democrat      55 135000         8 Control         5
## 10 Male   TRUE    Democrat      27 105000         8 Treated         8
## # … with 105 more rows</code></pre>
<p>Now, let’s say we’re interested in calculating a single parameter across each of these bootstrapped samples: the mean income for each of these replicates. We can achieve this by applying the <code>mean()</code> function iteratively across each of the replicates using a mapping function, and adding a column to the condensed “data” tibble, as shown below:</p>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="two-parameters.html#cb756-1"></a>get_mean_income &lt;-<span class="st"> </span><span class="cf">function</span>(splits) {</span>
<span id="cb756-2"><a href="two-parameters.html#cb756-2"></a>  x &lt;-<span class="st"> </span><span class="kw">analysis</span>(splits)</span>
<span id="cb756-3"><a href="two-parameters.html#cb756-3"></a>  <span class="kw">return</span>(<span class="kw">mean</span>(x<span class="op">$</span>income))</span>
<span id="cb756-4"><a href="two-parameters.html#cb756-4"></a>}</span>
<span id="cb756-5"><a href="two-parameters.html#cb756-5"></a></span>
<span id="cb756-6"><a href="two-parameters.html#cb756-6"></a>x<span class="op">$</span>mean_income &lt;-<span class="st"> </span><span class="kw">map_dbl</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="op">~</span><span class="kw">get_mean_income</span>(x<span class="op">$</span>splits[[.]]))</span>
<span id="cb756-7"><a href="two-parameters.html#cb756-7"></a></span>
<span id="cb756-8"><a href="two-parameters.html#cb756-8"></a>x</span></code></pre></div>
<pre><code>## # Bootstrap sampling 
## # A tibble: 1,000 x 3
##    splits           id            mean_income
##    &lt;list&gt;           &lt;chr&gt;               &lt;dbl&gt;
##  1 &lt;split [115/43]&gt; Bootstrap0001     137574.
##  2 &lt;split [115/44]&gt; Bootstrap0002     137226.
##  3 &lt;split [115/41]&gt; Bootstrap0003     129800 
##  4 &lt;split [115/45]&gt; Bootstrap0004     137500 
##  5 &lt;split [115/38]&gt; Bootstrap0005     147000 
##  6 &lt;split [115/43]&gt; Bootstrap0006     141109.
##  7 &lt;split [115/39]&gt; Bootstrap0007     140239.
##  8 &lt;split [115/42]&gt; Bootstrap0008     139309.
##  9 &lt;split [115/45]&gt; Bootstrap0009     145891.
## 10 &lt;split [115/44]&gt; Bootstrap0010     142139.
## # … with 990 more rows</code></pre>
<p>Now we have 1000 replicates and 1000 values of mean_income to work with. If we want to construct a distribution for the bootstrapped values of <code>mean_income</code> with a 95 percent confidence interval, we can calculate the bounds of this interval, just as we did in the previous chapter.</p>
<!-- Make sure this is done in previous chapter. I would be very surprised if it isn't-->
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="two-parameters.html#cb758-1"></a>quantiles &lt;-<span class="st"> </span>x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(mean_income) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">quantile</span>(<span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>), <span class="dt">names =</span> F)</span>
<span id="cb758-2"><a href="two-parameters.html#cb758-2"></a></span>
<span id="cb758-3"><a href="two-parameters.html#cb758-3"></a><span class="kw">ggplot</span>(x, <span class="kw">aes</span>(<span class="dt">x =</span> mean_income)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb758-4"><a href="two-parameters.html#cb758-4"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">20</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb758-5"><a href="two-parameters.html#cb758-5"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> quantiles[<span class="dv">1</span>]) <span class="op">+</span><span class="st"> </span></span>
<span id="cb758-6"><a href="two-parameters.html#cb758-6"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> quantiles[<span class="dv">2</span>]) <span class="op">+</span><span class="st"> </span></span>
<span id="cb758-7"><a href="two-parameters.html#cb758-7"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> mean_income_value, <span class="dt">color =</span> <span class="st">"blue"</span>) <span class="op">+</span></span>
<span id="cb758-8"><a href="two-parameters.html#cb758-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Mean Income"</span>,</span>
<span id="cb758-9"><a href="two-parameters.html#cb758-9"></a>       <span class="dt">y =</span> <span class="st">"Number of Replicates"</span>,</span>
<span id="cb758-10"><a href="two-parameters.html#cb758-10"></a>       <span class="dt">title =</span> <span class="st">"Mean Income for 1000 Bootstrapped Samples of Trains Dataset"</span>) <span class="op">+</span></span>
<span id="cb758-11"><a href="two-parameters.html#cb758-11"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="book_temp_files/figure-html/unnamed-chunk-473-1.png" width="672"></p>
<p>We’ve calculated the mean income for each bootstrapped replicate and constructed a nice distribution graphic for it — and this is all well and good, but it’s exactly the same thing that we did back in ch7. Extending our analysis of income to two parameters would allow us to investigate new trends and patterns in the data.</p>
<p>What if we wanted to extend this calculation to distinguish between, say, democratic and republican subjects in Enos’ study?</p>
</div>
<div id="two-parameters-1" class="section level2">
<h2>
<span class="header-section-number">8.3</span> Two Parameters</h2>
<p>Sampling with respect to two parameters will require a bit of additional work but will not require any more bootstrapping. First, we’ll slightly modify the <code>get_mean_income()</code> function: we’ll add an input to the function, <code>whichParty</code>, that will allow the function to distinguish between subjects that identified as democrat and those that identified as republican.</p>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="two-parameters.html#cb759-1"></a>get_mean_income &lt;-<span class="st"> </span><span class="cf">function</span>(splits, whichParty) {</span>
<span id="cb759-2"><a href="two-parameters.html#cb759-2"></a>  x &lt;-<span class="st"> </span><span class="kw">analysis</span>(splits) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(party <span class="op">==</span><span class="st"> </span>whichParty)</span>
<span id="cb759-3"><a href="two-parameters.html#cb759-3"></a>  <span class="kw">return</span>(<span class="kw">mean</span>(x<span class="op">$</span>income))</span>
<span id="cb759-4"><a href="two-parameters.html#cb759-4"></a>}</span></code></pre></div>
<p>Now that we’ve rewritten <code>get_mean_income()</code>, we can map the function onto each replicate. Here, we create two columns, mean_income_control and mean_income_treated, that distinguish between the mean incomes of the two groups.</p>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="two-parameters.html#cb760-1"></a>x<span class="op">$</span>mean_income_democrat &lt;-<span class="st"> </span><span class="kw">map_dbl</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="op">~</span><span class="kw">get_mean_income</span>(x<span class="op">$</span>splits[[.]], <span class="st">"Democrat"</span>))</span>
<span id="cb760-2"><a href="two-parameters.html#cb760-2"></a></span>
<span id="cb760-3"><a href="two-parameters.html#cb760-3"></a>x<span class="op">$</span>mean_income_republican &lt;-<span class="st"> </span><span class="kw">map_dbl</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="op">~</span><span class="kw">get_mean_income</span>(x<span class="op">$</span>splits[[.]], <span class="st">"Republican"</span>))</span>
<span id="cb760-4"><a href="two-parameters.html#cb760-4"></a></span>
<span id="cb760-5"><a href="two-parameters.html#cb760-5"></a>x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(id, mean_income_democrat, mean_income_republican)</span></code></pre></div>
<pre><code>## # A tibble: 1,000 x 3
##    id            mean_income_democrat mean_income_republican
##    &lt;chr&gt;                        &lt;dbl&gt;                  &lt;dbl&gt;
##  1 Bootstrap0001              131479.                170417.
##  2 Bootstrap0002              132953.                158816.
##  3 Bootstrap0003              123545                 171500 
##  4 Bootstrap0004              127143.                176771.
##  5 Bootstrap0005              141156.                171705.
##  6 Bootstrap0006              135815.                162283.
##  7 Bootstrap0007              134874.                173438.
##  8 Bootstrap0008              130333.                194844.
##  9 Bootstrap0009              144974.                150250 
## 10 Bootstrap0010              135735                 184833.
## # … with 990 more rows</code></pre>
<p>If we wanted to construct separate distributions for <code>mean_income_democrat</code> and <code>mean_income_republican</code>, we would need to be able to distinguish the two columns by a single variable. To do this, we use <code>pivot_longer()</code> and combine the two columns under a new column called <code>subject_party</code>:</p>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="two-parameters.html#cb762-1"></a>pivoted_data &lt;-<span class="st"> </span>x <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb762-2"><a href="two-parameters.html#cb762-2"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(mean_income_democrat, mean_income_republican), </span>
<span id="cb762-3"><a href="two-parameters.html#cb762-3"></a>               <span class="dt">names_to =</span> <span class="st">"subject_party"</span>,</span>
<span id="cb762-4"><a href="two-parameters.html#cb762-4"></a>               <span class="dt">values_to =</span> <span class="st">"income"</span>)</span>
<span id="cb762-5"><a href="two-parameters.html#cb762-5"></a></span>
<span id="cb762-6"><a href="two-parameters.html#cb762-6"></a>pivoted_data</span></code></pre></div>
<pre><code>## # A tibble: 2,000 x 5
##    splits           id            mean_income subject_party           income
##    &lt;list&gt;           &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;                    &lt;dbl&gt;
##  1 &lt;split [115/43]&gt; Bootstrap0001     137574. mean_income_democrat   131479.
##  2 &lt;split [115/43]&gt; Bootstrap0001     137574. mean_income_republican 170417.
##  3 &lt;split [115/44]&gt; Bootstrap0002     137226. mean_income_democrat   132953.
##  4 &lt;split [115/44]&gt; Bootstrap0002     137226. mean_income_republican 158816.
##  5 &lt;split [115/41]&gt; Bootstrap0003     129800  mean_income_democrat   123545 
##  6 &lt;split [115/41]&gt; Bootstrap0003     129800  mean_income_republican 171500 
##  7 &lt;split [115/45]&gt; Bootstrap0004     137500  mean_income_democrat   127143.
##  8 &lt;split [115/45]&gt; Bootstrap0004     137500  mean_income_republican 176771.
##  9 &lt;split [115/38]&gt; Bootstrap0005     147000  mean_income_democrat   141156.
## 10 &lt;split [115/38]&gt; Bootstrap0005     147000  mean_income_republican 171705.
## # … with 1,990 more rows</code></pre>
<p>Now, if we want to calculate 95 percent confidence intervals for both the democrat and republican subjects, we can calculate these values manually and plot them both on the same graph, distinguishing between the two sets of values and intervals using color:</p>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="two-parameters.html#cb764-1"></a>democrat_intervals &lt;-<span class="st"> </span>pivoted_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(subject_party <span class="op">==</span><span class="st"> "mean_income_democrat"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(income) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">quantile</span>(<span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>), <span class="dt">names =</span> F)</span>
<span id="cb764-2"><a href="two-parameters.html#cb764-2"></a></span>
<span id="cb764-3"><a href="two-parameters.html#cb764-3"></a>republican_intervals &lt;-<span class="st"> </span>pivoted_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(subject_party <span class="op">==</span><span class="st"> "mean_income_republican"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(income) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">quantile</span>(<span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>), <span class="dt">names =</span> F)</span>
<span id="cb764-4"><a href="two-parameters.html#cb764-4"></a></span>
<span id="cb764-5"><a href="two-parameters.html#cb764-5"></a><span class="kw">ggplot</span>(pivoted_data, <span class="kw">aes</span>(<span class="dt">x =</span> income, <span class="dt">fill =</span> subject_party)) <span class="op">+</span></span>
<span id="cb764-6"><a href="two-parameters.html#cb764-6"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">40</span>) <span class="op">+</span></span>
<span id="cb764-7"><a href="two-parameters.html#cb764-7"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb764-8"><a href="two-parameters.html#cb764-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Mean Income"</span>,</span>
<span id="cb764-9"><a href="two-parameters.html#cb764-9"></a>       <span class="dt">y =</span> <span class="st">"Number of Replicates"</span>,</span>
<span id="cb764-10"><a href="two-parameters.html#cb764-10"></a>       <span class="dt">title =</span> <span class="st">"Mean Income for 1000 Bootstrapped Samples"</span>,</span>
<span id="cb764-11"><a href="two-parameters.html#cb764-11"></a>       <span class="dt">subtitle =</span> <span class="st">"Bars represent 95 percent confidence intervals and original value"</span>,</span>
<span id="cb764-12"><a href="two-parameters.html#cb764-12"></a>       <span class="dt">fill =</span> <span class="st">"Subject Party"</span>) <span class="op">+</span></span>
<span id="cb764-13"><a href="two-parameters.html#cb764-13"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"Democrat"</span>, <span class="st">"Republican"</span>)) <span class="op">+</span></span>
<span id="cb764-14"><a href="two-parameters.html#cb764-14"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> democrat_intervals[<span class="dv">1</span>], <span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb764-15"><a href="two-parameters.html#cb764-15"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> democrat_intervals[<span class="dv">2</span>], <span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb764-16"><a href="two-parameters.html#cb764-16"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> republican_intervals[<span class="dv">1</span>], <span class="dt">color =</span> <span class="st">"turquoise3"</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb764-17"><a href="two-parameters.html#cb764-17"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> republican_intervals[<span class="dv">2</span>], <span class="dt">color =</span> <span class="st">"turquoise3"</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb764-18"><a href="two-parameters.html#cb764-18"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> mean_income_value_democrat, <span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb764-19"><a href="two-parameters.html#cb764-19"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> mean_income_value_republican, <span class="dt">color =</span> <span class="st">"turquoise3"</span>) </span></code></pre></div>
<p><img src="book_temp_files/figure-html/unnamed-chunk-477-1.png" width="672"></p>
<p>This is a bit messy and difficult to decipher, but there are two observations regarding these distributions that we can make right off the bat:</p>
<p>Observation 1: The <code>mean_income_republican</code> income distribution is visibly further to the right than the <code>mean_income_democrat</code> distribution; this means that the mean incomes for republicans are generally higher than the mean incomes for democrats in our bootstrap samples.</p>
<p>Observation 2: There are wider confidence intervals for <code>mean_income_republican</code> than there are for <code>mean_income_democrat</code>. This means that we are less confident in our approximation of <code>mean_income_republican</code> than we are for <code>mean_income_democrats</code>.</p>
<p>Observation 1 is pretty self-explanatory — it is simply a trend in the data that can be explained in a sentence or two — but why is Observation 2 the case?</p>
<p>This requires a bit more explanation. Let’s take a look at the party splits in the train dataset:</p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="two-parameters.html#cb765-1"></a>trains <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb765-2"><a href="two-parameters.html#cb765-2"></a><span class="st">  </span><span class="kw">count</span>(party)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   party          n
##   &lt;chr&gt;      &lt;int&gt;
## 1 Democrat      96
## 2 Republican    19</code></pre>
<p>In the original dataset — and therefore, most likely for the majority of the bootstrapped samples — the number of democratic subjects vastly outnumber the number of republican subjects. Why does this lead to wider confidence intervals?</p>
<p>Intuitively, we can think about the matter like this: since we have more data to work with for the democratic party, we are more confident that the mean income measurement from each bootstrapped sample is representative of the <em>true mean income of that sample</em> — remember, this “true value” is what we’re trying to approximate through the bootstrapping process. This idea is more obvious on an extreme scale: if we were given one billion individuals’ incomes, we’d feel more comfortable approximating the world’s average income from that dataset than if we only had two individual’s incomes to work with. These two individuals could be impoverished, or they could be billionaires, and we wouldn’t reliably make any conclusions regarding world income based on those two individuals alone. Because there are far more democrats in the original sample than there are republicans, we are therefore more confident that the democrats’ true average income is represented by the democratic subset of the data than we are of the republicans’ true average income being accurately represented by the republican subset.</p>
<p>The math behind the confidence INTERVALS specifically is a little more complex, but the premise behind it is simple. First, recall that bootstrapping with replacement creates different assortments of the data due to the possibility of data points being omitted from each sample, or values being included more than once. If I was sampling with replacement from the list of 1, 2, 3, 4, 5, One replicate might include “1” three times, while another might include “1” zero times.</p>
<p>It is because of this possibility for omission/duplicate inclusion that subsets with small sample sizes are at the mercy of being misrepresented by sampling with replacement. In small sample sizes, individual points carry significant weight. As a result, we are more likely to get extreme values — values that are unreasonably small or large — the smaller the size of the subset.</p>
<p>As it relates to the <code>trains</code> dataset, the subset with the larger sample size, the democrat contingent, is less susceptible from this because each data point carries far less weight — each one gets drowned out by the many other democrats in the dataset, and removing or duplicating a single or even a few data points won’t drastically shift measurements, such as mean and median, for most of the bootstrap samples. However, for the smaller republican subset, even a single omission or double inclusion of a data point through bootstrapping with replacement could generate extreme values for these measurements.</p>
<p>That’s a mouthful, but it’s also better illustrated by an extreme example. Let’s consider a hypothetical dataset with 3 republican subjects and 112 democrat subjects, with everyone’s income falling between 75000 and 150000, and bootstrap this data 10 times:</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="two-parameters.html#cb767-1"></a>fake_data &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">party =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">"Republican"</span>, <span class="dv">3</span>), <span class="kw">rep</span>(<span class="st">"Democrat"</span>, <span class="dv">112</span>)),</span>
<span id="cb767-2"><a href="two-parameters.html#cb767-2"></a>                    <span class="dt">income =</span> <span class="kw">sample</span>(<span class="dv">75000</span><span class="op">:</span><span class="dv">150000</span>, <span class="dv">115</span>, <span class="dt">replace =</span> F))</span>
<span id="cb767-3"><a href="two-parameters.html#cb767-3"></a></span>
<span id="cb767-4"><a href="two-parameters.html#cb767-4"></a>fake_data_bootstrap &lt;-<span class="st"> </span><span class="kw">bootstraps</span>(fake_data, <span class="dv">10</span>)</span></code></pre></div>
<p>Now, let’s calculate <code>mean_income_democrat</code> and <code>mean_income_republican</code> for each of these ten samples:</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="two-parameters.html#cb768-1"></a>fake_data_bootstrap<span class="op">$</span>mean_income_democrat &lt;-<span class="st"> </span><span class="kw">map_dbl</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="op">~</span><span class="kw">get_mean_income</span>(fake_data_bootstrap<span class="op">$</span>splits[[.]], <span class="st">"Democrat"</span>))</span>
<span id="cb768-2"><a href="two-parameters.html#cb768-2"></a></span>
<span id="cb768-3"><a href="two-parameters.html#cb768-3"></a>fake_data_bootstrap<span class="op">$</span>mean_income_republican &lt;-<span class="st"> </span><span class="kw">map_dbl</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="op">~</span><span class="kw">get_mean_income</span>(fake_data_bootstrap<span class="op">$</span>splits[[.]], <span class="st">"Republican"</span>))</span>
<span id="cb768-4"><a href="two-parameters.html#cb768-4"></a></span>
<span id="cb768-5"><a href="two-parameters.html#cb768-5"></a>fake_data_bootstrap</span></code></pre></div>
<pre><code>## # Bootstrap sampling 
## # A tibble: 10 x 4
##    splits           id          mean_income_democrat mean_income_republican
##    &lt;list&gt;           &lt;chr&gt;                      &lt;dbl&gt;                  &lt;dbl&gt;
##  1 &lt;split [115/47]&gt; Bootstrap01              115097.                   NaN 
##  2 &lt;split [115/42]&gt; Bootstrap02              114459.                117406.
##  3 &lt;split [115/48]&gt; Bootstrap03              111111.                124564.
##  4 &lt;split [115/40]&gt; Bootstrap04              113352.                125559.
##  5 &lt;split [115/45]&gt; Bootstrap05              111657.                133331 
##  6 &lt;split [115/44]&gt; Bootstrap06              116669.                133331 
##  7 &lt;split [115/44]&gt; Bootstrap07              113678.                 99144 
##  8 &lt;split [115/44]&gt; Bootstrap08              110522.                 99144 
##  9 &lt;split [115/41]&gt; Bootstrap09              111272.                121935.
## 10 &lt;split [115/46]&gt; Bootstrap10              112553.                133798.</code></pre>
<p>One thing we can notice right away is the wider spread of <code>mean_income_republican</code> in spite of the fact that all the income values were randomly generated within the same number range. Because each of the three republican income values carried so much weight, duplicating one or omitting one in a bootstrap sample more easily led to extreme <code>mean_income_republican</code> values.</p>
<p>In short: If we have fewer data points, bootstrap parameter calculations are more likely to be further from the true values, and our confidence intervals will be wider as a result. It’s important to understand the mechanics behind these relationships as we continue our work with confidence intervals going forward.</p>
</div>
<div id="calculating-a-third-parameter" class="section level2">
<h2>
<span class="header-section-number">8.4</span> Calculating a third parameter</h2>
<p>Now, the above graph looks a bit messy: trying to graph two distributions on the same graph often can turn out this way. So, how might we go about simplifying the graph but still show the differences in distributions?</p>
<p>Let’s say that we are now interested in a more viewable statistic that captures the same information, such as the <em>average difference</em> between treated income and control income. How do we go about calculating this kind of statistic?</p>
<p>Before we dive into the different ways we can calculate this parameter across our bootstrap samples, it is helpful to understand a shortcut we can take due to the nature of mean as a mathematical function. because mean is linear, <em>the average difference is equivalent to the difference in averages</em> — so, instead of averaging the difference between every single combination of democrat and republican in each sample, we can simply calculate the average income for democrat subjects, the average income for republican subjects, and take the difference of the two to get the average income difference for democrats and republicans.</p>
<p>Since we’ve already calculated mean income for republicans and democrat, we can simply create a third column that represents the difference between these two parameters. Note that we subtract <code>mean_income_democrat</code> from <code>mean_income_republican</code> because the above distribution indicates the latter is larger, and it’s convenient to work with positive values. However, we have to keep this ordering constant while we work with this parameter, or our differences might get flipped!</p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="two-parameters.html#cb770-1"></a>x<span class="op">$</span>mean_income_difference &lt;-<span class="st"> </span>x<span class="op">$</span>mean_income_republican <span class="op">-</span><span class="st"> </span>x<span class="op">$</span>mean_income_democrat</span></code></pre></div>
<p>The key insight here is that instead of going through with this messy calculation, we can utilize the two columns we had already created — and, as we can see, we achieve the same result with many less lines of code. It is always important to be wary of the tools you have at your disposal, as well as the calculations you have already made.</p>
<p>Now, we can plot everything on a nice bootstrap distribution that displays the average difference in income, the new parameter we calculated from our previous two parameters:</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="two-parameters.html#cb771-1"></a>difference_intervals &lt;-<span class="st"> </span><span class="kw">quantile</span>(x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(mean_income_difference), </span>
<span id="cb771-2"><a href="two-parameters.html#cb771-2"></a>                                 <span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>),</span>
<span id="cb771-3"><a href="two-parameters.html#cb771-3"></a>                                 <span class="dt">names =</span> <span class="ot">FALSE</span>)</span>
<span id="cb771-4"><a href="two-parameters.html#cb771-4"></a></span>
<span id="cb771-5"><a href="two-parameters.html#cb771-5"></a></span>
<span id="cb771-6"><a href="two-parameters.html#cb771-6"></a><span class="kw">ggplot</span>(x, <span class="kw">aes</span>(<span class="dt">x =</span> mean_income_difference)) <span class="op">+</span></span>
<span id="cb771-7"><a href="two-parameters.html#cb771-7"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">40</span>) <span class="op">+</span></span>
<span id="cb771-8"><a href="two-parameters.html#cb771-8"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb771-9"><a href="two-parameters.html#cb771-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Average Differences in Income for Democrats And Republicans"</span>,</span>
<span id="cb771-10"><a href="two-parameters.html#cb771-10"></a>       <span class="dt">y =</span> <span class="st">"Number of Replicates"</span>,</span>
<span id="cb771-11"><a href="two-parameters.html#cb771-11"></a>       <span class="dt">title =</span> <span class="st">"Average Differences in Income for 1000 Bootstrapped Samples"</span>,</span>
<span id="cb771-12"><a href="two-parameters.html#cb771-12"></a>       <span class="dt">subtitle =</span> <span class="st">"Bars represent 95 percent confidence intervals and original value"</span>) <span class="op">+</span></span>
<span id="cb771-13"><a href="two-parameters.html#cb771-13"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> difference_intervals[<span class="dv">1</span>], <span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb771-14"><a href="two-parameters.html#cb771-14"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> difference_intervals[<span class="dv">2</span>], <span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb771-15"><a href="two-parameters.html#cb771-15"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> mean_income_difference_value)</span></code></pre></div>
<p><img src="book_temp_files/figure-html/unnamed-chunk-483-1.png" width="672"></p>
<p>As the distribution shows, the average difference in income of treated subjects and income of control subjects is skewed towards the right of 0, with republicans on average having a higher income than democrats.</p>
<p>Recall that mean is a linear measurement. Let’s now say that we’re interested a separate parameter that is nonlinear — for example, we could be interested in the ratio of median treated income to median control income.</p>
<p>Like we did with mean incomes, let’s iteratively calculate the median incomes and their ratio across each bootstrap sample:</p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="two-parameters.html#cb772-1"></a>get_median_income &lt;-<span class="st"> </span><span class="cf">function</span>(splits, whichParty) {</span>
<span id="cb772-2"><a href="two-parameters.html#cb772-2"></a>  x &lt;-<span class="st"> </span><span class="kw">analysis</span>(splits) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(party <span class="op">==</span><span class="st"> </span>whichParty) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(income)</span>
<span id="cb772-3"><a href="two-parameters.html#cb772-3"></a>  <span class="kw">return</span>(<span class="kw">median</span>(x))</span>
<span id="cb772-4"><a href="two-parameters.html#cb772-4"></a>}</span>
<span id="cb772-5"><a href="two-parameters.html#cb772-5"></a></span>
<span id="cb772-6"><a href="two-parameters.html#cb772-6"></a>x<span class="op">$</span>median_income_democrat &lt;-<span class="st"> </span><span class="kw">map_dbl</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="op">~</span><span class="kw">get_median_income</span>(x<span class="op">$</span>splits[[.]], <span class="st">"Democrat"</span>))</span>
<span id="cb772-7"><a href="two-parameters.html#cb772-7"></a></span>
<span id="cb772-8"><a href="two-parameters.html#cb772-8"></a>x<span class="op">$</span>median_income_republican &lt;-<span class="st"> </span><span class="kw">map_dbl</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="op">~</span><span class="kw">get_median_income</span>(x<span class="op">$</span>splits[[.]], <span class="st">"Republican"</span>))</span>
<span id="cb772-9"><a href="two-parameters.html#cb772-9"></a></span>
<span id="cb772-10"><a href="two-parameters.html#cb772-10"></a></span>
<span id="cb772-11"><a href="two-parameters.html#cb772-11"></a>x<span class="op">$</span>median_income_ratio &lt;-<span class="st"> </span>x<span class="op">$</span>median_income_republican<span class="op">/</span>x<span class="op">$</span>median_income_democrat</span></code></pre></div>
<p>And now, we’ll construct a distribution out of this new parameter, like we did with the average difference in incomes:</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="two-parameters.html#cb773-1"></a>ratio_intervals &lt;-<span class="st"> </span><span class="kw">quantile</span>(x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(median_income_ratio), <span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>))</span>
<span id="cb773-2"><a href="two-parameters.html#cb773-2"></a></span>
<span id="cb773-3"><a href="two-parameters.html#cb773-3"></a><span class="kw">ggplot</span>(x, <span class="kw">aes</span>(<span class="dt">x =</span> median_income_ratio)) <span class="op">+</span></span>
<span id="cb773-4"><a href="two-parameters.html#cb773-4"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">35</span>) <span class="op">+</span></span>
<span id="cb773-5"><a href="two-parameters.html#cb773-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Ratio of Median Incomes"</span>,</span>
<span id="cb773-6"><a href="two-parameters.html#cb773-6"></a>       <span class="dt">y =</span> <span class="st">"Number of Replicates"</span>,</span>
<span id="cb773-7"><a href="two-parameters.html#cb773-7"></a>       <span class="dt">title =</span> <span class="st">"Ratio of median incomes across 1000 bootstrapped samples"</span>,</span>
<span id="cb773-8"><a href="two-parameters.html#cb773-8"></a>       <span class="dt">subtitle =</span> <span class="st">"Bars represent 95% confidence intervals"</span>) <span class="op">+</span></span>
<span id="cb773-9"><a href="two-parameters.html#cb773-9"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> ratio_intervals[<span class="dv">1</span>]) <span class="op">+</span></span>
<span id="cb773-10"><a href="two-parameters.html#cb773-10"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> ratio_intervals[<span class="dv">2</span>]) <span class="op">+</span></span>
<span id="cb773-11"><a href="two-parameters.html#cb773-11"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> median_income_ratio_value, <span class="dt">color =</span> <span class="st">"blue"</span>) <span class="op">+</span></span>
<span id="cb773-12"><a href="two-parameters.html#cb773-12"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="book_temp_files/figure-html/unnamed-chunk-486-1.png" width="672"></p>
<p>Since there was some degree of rounding done to calculate income in the data, the spreads of median values and the ratio of median values are not that varied. However, we once again see that the data is skewed to the right, and that the republican median income exceeds democrat mean income more often than the other way around.</p>
</div>
<div id="estimate-other-things" class="section level2">
<h2>
<span class="header-section-number">8.5</span> Estimate other things</h2>
<!-- Often functions of these parameters, which are, after all, just functions of the bootstrap samples. Consider the difference in income between treated and control. Again, this is a case in which we know every number. There is no missing data. So, we can calculate exactly the average income for control and the average income for treated, as we did above. With those two parameters estimated, we can calculate the average difference between the two --- or the difference between the averages, which is the same thing because all this is linear. But what about the uncertainty of that difference? Again, the bootstrap comes to our rescue. What does the 95% confidence interval of the difference look like? Does it include zero? Would we expect it to? How does randomization of treatment/control figure in? -->
</div>
<div id="estimate-trickier-things" class="section level2">
<h2>
<span class="header-section-number">8.6</span> Estimate trickier things</h2>
<!-- Explain how the above is a bit of a cheat since linear functions are special: the average difference is the same as the difference between the averages. This is an important point. But there are lots of things which are not like that! Consider the income ratio between the median treated and median control. This is something which, a priori, I might be as interested in as the difference in means. But the ratio of the medians is not the same thing as the median of the ratios! This is a key point. In order to calculate this, we need to, again, take the bootstrap and, in each bootstrap sample, calculate the median income of the treated, the median income of the controls, and record that ratio. We then save that ratio and look at its bootstrap distribution at the end of the exercise. -->
<!-- EM: I feel like having "Estimate other things" and "Estimate trickier things" are redundant as chapter sections because they are mostly addressed through the sections that sandwich them.  -->
</div>
<div id="using-lm" class="section level2">
<h2>
<span class="header-section-number">8.7</span> Using <code>lm()</code>
</h2>
<p>The bootstrapping process is a fantastic way to generate confidence intervals, but luckily for us, R has built-in functions that make the process of calculating confidence intervals much quicker. Recall the <code>lm()</code> and <code>tidy()</code> functions, which were used extensively in ch7.</p>
<p>One trick we can use here that we didn’t have the chance to use in chapter 7 is adding a “-1” to the lm expression, as shown below. This allows us to independently investigate regressions for the two separate parameters, <code>mean_income_democrat</code> and <code>mean_income_republican</code>, by telling <code>lm()</code> not to create a general intercept.</p>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="two-parameters.html#cb774-1"></a><span class="kw">lm</span>(<span class="dt">data =</span> trains, income <span class="op">~</span><span class="st"> </span><span class="dv">-1</span> <span class="op">+</span><span class="st"> </span>party) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tidy</span>(<span class="dt">conf.int =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(term, estimate, conf.low, conf.high)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 4
##   term            estimate conf.low conf.high
##   &lt;chr&gt;              &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 partyDemocrat    136755.  121808.   151702.
## 2 partyRepublican  167368.  133770.   200967.</code></pre>
<p>Recall that the third parameter we calculated, <code>mean_income_difference</code>, represents the average difference between republican income and democrat income. If we wanted to analyze this difference, which can be modeled as the offset in income that exists specifically due to a subject being a republican instead of a democrat, we can remove the “-1” to get the <code>partyRepublican</code> term that demonstrates this difference:</p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="two-parameters.html#cb776-1"></a><span class="kw">lm</span>(<span class="dt">data =</span> trains, income <span class="op">~</span><span class="st"> </span>party) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tidy</span>(<span class="dt">conf.int =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(term, estimate, conf.low, conf.high)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 4
##   term            estimate conf.low conf.high
##   &lt;chr&gt;              &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)      136755.  121808.   151702.
## 2 partyRepublican   30613.   -6160.    67386.</code></pre>
<p>As you can see, the estimates for the mean income values and the mean income difference values generated by <code>lm()</code> are the same as those we calculated at the beginning of the chapter, and the confindence intervals generated by the function are virtually identical to those created by conducting bootstrap resampling. So, you might be wondering: why the heck did we make you go through the trouble of bootstrapping when we could’ve just run <code>lm()</code> from the beginning? You probably think we were just having a laugh by making you write hundreds more lines of code.</p>
<p>Although writing code is fun, we didn’t make you write out the bootstrap solely for the purpose of fun. It turns out that while <code>lm()</code> works spectacularly for linear calculations, such as mean income and the difference of mean incomes, it is useless when it comes to nonlinear measurements such as the ratio of median incomes. We can’t even give you an example that throws out an error to demonstrate this, because there’s literally no way to write <code>lm()</code> to construct non-linear parameters. In those cases, the best tool we have to construct confidence intervals is bootstrapping.</p>
</div>
<div id="the-prediction-game" class="section level2">
<h2>
<span class="header-section-number">8.8</span> The prediction game</h2>
<p>Let’s say that we want to play the “predicton game”, so to speak. If we were to take a look at a brand new subject and predict their income based on their party affiliation, what would we guess their income to be, and how confident would we be in this guess?</p>
<p>You might be tempted to say that the best guess for the new subject’s income would be the mean income of this new subject’s party — this instinct is correct! But if you say the prediction intervals for this new subject’s income are the same as the confidence interval for the mean income of that new subject’s party, that would be incorrect, although it might not be immediately clear as to why.</p>
<p>Here’s why. Take a look at the <code>summary()</code> function applied to the linear model we generated previously:</p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="two-parameters.html#cb778-1"></a><span class="kw">lm</span>(<span class="dt">data =</span> trains, income <span class="op">~</span><span class="st"> </span>party) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = income ~ party, data = trains)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -113255  -49255  -31755   -1755  163245 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       136755       7544  18.126   &lt;2e-16 ***
## partyRepublican    30613      18561   1.649    0.102    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 73920 on 113 degrees of freedom
## Multiple R-squared:  0.02351,	Adjusted R-squared:  0.01487 
## F-statistic:  2.72 on 1 and 113 DF,  p-value: 0.1019</code></pre>
<p>The residual standard error term corresponds to the variation in individual data — more specifically, it is the average deviation from the true regression line across all the data points in the trains dataset. This variation is omitted when generating confidence intervals for mean income, as those calculations only deal with <em>averages across and not the range of the data</em>.</p>
<p>Therefore, while we are 95% certain that the mean income falls inbetween the confidence intervals we generated, we are less than 95% sure that any given person’s income falls within that range. This added uncertainty is called <em>unmodeled variation</em>, and it becomes relevant when we use our models to analyze and predict individual data points instead of summary statistics.</p>
<!-- Add a paragraph above about unmodeled variation. -->
</div>
<div id="using-the-predict-function" class="section level2">
<h2>
<span class="header-section-number">8.9</span> Using the predict() function</h2>
<p>We will introduce a new function here, <code>predict()</code>, which takes in a model as input and, given a specified parameter, will predict the value and confidence intervals of any given data point:</p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="two-parameters.html#cb780-1"></a>trains.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data =</span> trains, income <span class="op">~</span><span class="st"> </span>party)</span>
<span id="cb780-2"><a href="two-parameters.html#cb780-2"></a>newdata &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">party =</span> <span class="kw">c</span>(<span class="st">"Republican"</span>, <span class="st">"Democrat"</span>))</span>
<span id="cb780-3"><a href="two-parameters.html#cb780-3"></a></span>
<span id="cb780-4"><a href="two-parameters.html#cb780-4"></a><span class="kw">predict</span>(trains.lm, newdata, <span class="dt">interval =</span> <span class="st">"prediction"</span>)</span></code></pre></div>
<pre><code>##        fit       lwr      upr
## 1 167368.4  17113.05 317623.8
## 2 136755.2 -10456.40 283966.8</code></pre>
<p>Note that for both democrats and republicans, the prediction interval is significantly wider than the confidence interval. This discrepancy illustrates the <em>unmodeled variation</em> of the dataset: while the mean values, as indicated by the “fit” column, are still the best guess you can make for any given subject, we are less confident in the value range of that individual subject than we are of the value range of the mean. <em>The unmodeled variation widens the prediction intervals relative to the confidence intervals.</em></p>
<p>Recall our discussion regarding the wider confidence intervals for republican subjects than democrat subjects (<em>would like to attach a link here that takes reader up to that part of the chapter</em>). Although the republican and democrat average incomes had vastly different confidence intervals — the republican convidence intervals were much wider — they have very similar prediction intervals. Although the <em>parameter uncertainty</em> of these two parameters were very different, the <em>unmodeled variation</em> for both parameters was roughly the same. Even though the data points were equally spread out for both democrat and republican income, were were able to more confidently pinpoint a true value for democrat income because we had more data to work with.</p>
<div id="validity" class="section level4">
<h4>
<span class="header-section-number">8.9.0.1</span> Validity</h4>
<p>We just spent a ton of time analyzing the relationship between party and income in Enos’ study. Although we have already accounted for parameter uncertainty (the confidence intervals) and unmodeled variation uncertainty (the prediction intervals), we have not accounted for the <em>validity</em> of his model — that is, whether the ideas he wishes to capture are truly represented by the data he collects.</p>
<p>For example, take the <code>income</code> variable. How do you answer this question if you, having made a fortune years ago, are currently earning an income of zero? How do you answer it if you are one-half of a married couple — is it both your incomes combined, your incomes divided by two, or some other calculation? Enos really means to distinguish between poorer and richer subjects through this measure, but the ambiguity in the question “what is your income” makes us doubt whether the income figures truly help us distinguish between these two types of people.</p>
<p>Another variable which, troublingly, raises concerns regarding validity is the <code>att_end</code> variable. Through this variable, Enos hopes to measure how people’s political attitudes change, and the implications this could have for the political landscape of the United States— however, what he is truly measuring is how people respond to his specific survey questions, which required responses on a scale of 1-5 and were aggregated and scaled to a total out of 15. What if he asked people to respond on a scale of 1-3, or a scale of 1-30? We do not mean to say that his choices were unreasonable — rather, we think it is important to note that he would have gotten very different answers using different reasonable choices. <strong>If you’re running Trump’s 2020 campaign, you don’t care about how people filled out Enos’ specific survey. You care about the statistics that data claims to represent</strong>.</p>
<p>It is always important to keep the problem of validity in the back of our minds as we investigate data sets and how the data within these sets are collected. Given the many factors — those we are aware of and those we are not aware of — that go into any kind of data collection, there is no way to guarantee 100 percent validity.</p>
</div>
<div id="unknown-unknowns" class="section level4">
<h4>
<span class="header-section-number">8.9.0.2</span> Unknown unknowns</h4>
<p>Yet another area of uncertainty that might not be immediately obvious is the possibiity of unknown unknowns — that is, all the things that might change with time. How do we know that our model — which relies heavily on figures like income and party affiliation — will still be able to draw conclusions about America 50 years from now? Mass migrations, political revolutions, and world wars are just a few of the things that could render all the conclusions we draw from the <code>trains</code> dataset moot. And, other than expanding our confidence intervals to the point of uselessness, there’s no way to account for the unknown unknowns.</p>
<p>In short, <em>while we can accept the model as representative of the United States at or around 2012 (the year in which Enos conducted his study), we cannot reasonably extrapolate that to the far future</em>.</p>
<p>It is always important to keep the problem of validity in the back of our minds as we investigate data sets and how the data within these sets are collected. Given the many factors — those we are aware of and those we are not aware of — that go into any kind of data collection, there is no way to guarantee 100 percent validity.</p>
</div>
<div id="unknown-unknowns-1" class="section level4">
<h4>
<span class="header-section-number">8.9.0.3</span> Unknown unknowns</h4>
<p>Yet another area of uncertainty that might not be immediately obvious is the possibiity of unknown unknowns — that is, all the things that might change with time. How do we know that our model — which relies heavily on figures like income and party affiliation — will still be able to draw conclusions about America 50 years from now? Mass migrations, political revolutions, and world wars are just a few of the things that could render all the conclusions we draw from the <code>trains</code> dataset moot. And, other than expanding our confidence intervals to the point of uselessness, there’s no way to account for the unknown unknowns.</p>
<p>In short, <em>while we can accept the model as representative of the United States at or around 2012 (the year in which Enos conducted his study), we cannot reasonably extrapolate that to the far future</em>.</p>
<!-- EM: Is the above statement true? -->
<!-- Will the term "prediction game" be brought up earlier in PPBDS? -->
</div>
</div>
<div id="rubin-causal-model-will-come-back-to-this-last" class="section level2">
<h2>
<span class="header-section-number">8.10</span> Rubin Causal Model (WILL COME BACK TO THIS LAST)</h2>
<p>Let’s establish the two types of models we’ve studied thus far. What we explored above was a predictive model: with someone’s party affiliation, we can make a better guess as to what his or her income is. Conversely, given someone’s income, we can make a more accurate prediction of his or her income.</p>
<p>However, that’s just about all we can do with this relationship. Recall that the trains dataset was originally introduced in the context of the Rubin Causal Model back in chapter 3. That model cannot be applied to the relationship between party and income because these values were independently decided outside the experiment — although we were able to identify correlations between those two variables, the combinations of party and income were predetermined and not randomly assigned in a way that allows us to establish a causal relationship.</p>
<p>If that’s difficult to wrap your head around, here’s big-idea reason for why we wouldn’t look at the party-income relationship as causal: if an individual suddenly decided to change party affiliations — say, he or she decided to vote for Biden in the 2020 election despite having voted for Trump in 2016 — we wouldn’t suddenly expect his or her income to, solely because of this change in party affiliation, spike or plummet. There are many other factors at play when determining these two variables that make identifying a causal relationship impossible.</p>
<p>In conclusion, while we can explore correlations or trends between party and income, we cannot label these correlations or trends as causal. However, <code>treatment</code> was a variable that was randomly assigned to subjects, and we have a variable that was measured after this random assignment, <code>att_end</code>. With this setup, we can calculate the Average Treatment Effect, or the average difference in <code>att_end</code> for treated subjects and control subjects.</p>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="two-parameters.html#cb782-1"></a>mean_ends &lt;-<span class="st"> </span>trains <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb782-2"><a href="two-parameters.html#cb782-2"></a><span class="st">  </span><span class="kw">group_by</span>(treatment) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb782-3"><a href="two-parameters.html#cb782-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_att_end =</span> <span class="kw">mean</span>(att_end))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<p>Here, we see that the average treatment effect is -1.546875; this is the average change in att_end caused by treatment (if this statistic looks unfamiliar, refer back to chapter 3 for a refresher on ATE). But how confident are we in this ATE? We can use <code>lm()</code> again to generate confidence intervals for this parameter (note that, as mean is a linear measure, we can use <code>lm()</code> no problem!):</p>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="two-parameters.html#cb784-1"></a><span class="co">#This is necessary so we can see the offset as caused by treatmentTreated, not treatmentControl.</span></span>
<span id="cb784-2"><a href="two-parameters.html#cb784-2"></a></span>
<span id="cb784-3"><a href="two-parameters.html#cb784-3"></a>trains<span class="op">$</span>treatment &lt;-<span class="kw">fct_relevel</span>(trains<span class="op">$</span>treatment, <span class="st">"Control"</span>, <span class="st">"Treated"</span>)</span>
<span id="cb784-4"><a href="two-parameters.html#cb784-4"></a></span>
<span id="cb784-5"><a href="two-parameters.html#cb784-5"></a><span class="kw">lm</span>(<span class="dt">data =</span> trains, att_end <span class="op">~-</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>treatment) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb784-6"><a href="two-parameters.html#cb784-6"></a><span class="st">  </span><span class="kw">tidy</span>(<span class="dt">conf.int =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb784-7"><a href="two-parameters.html#cb784-7"></a><span class="st">  </span><span class="kw">select</span>(term, estimate, conf.low, conf.high)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 4
##   term             estimate conf.low conf.high
##   &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 treatmentControl     8.45     7.77      9.14
## 2 treatmentTreated    10.       9.23     10.8</code></pre>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="two-parameters.html#cb786-1"></a><span class="co">#To do: add row numbers, figure out a way to mutate columns as to include both values — maybe a function could be useful here?)</span></span></code></pre></div>
<p>The confidence intervals represent our confidence in the average treatment effect of the <code>trains</code> dataset being representative of the true average treatment effect on Boston commuters.</p>
<p>Now, we’ll create the RCM table of possible outcomes, as we did back in ch3:</p>
<!-- EM: The Rubin tables below should be structurally different from the ones you constructed for age and party affiliation because age~party is merely predictive while att_end~treatment is CAUSAL. This explains there being TWO outcome columns for the att_end~treament model instead of only ONE outcome column, like we have for the age~party Rubin Table. Make sure that this distinction is clear — burn it into the reader's mind. -->
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="two-parameters.html#cb787-1"></a><span class="co">#Adding question marks where necessary</span></span>
<span id="cb787-2"><a href="two-parameters.html#cb787-2"></a></span>
<span id="cb787-3"><a href="two-parameters.html#cb787-3"></a>trains_RCM &lt;-<span class="st"> </span>trains <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb787-4"><a href="two-parameters.html#cb787-4"></a><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> treatment, <span class="dt">values_from =</span> att_end) <span class="op">%&gt;%</span></span>
<span id="cb787-5"><a href="two-parameters.html#cb787-5"></a><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) <span class="op">%&gt;%</span></span>
<span id="cb787-6"><a href="two-parameters.html#cb787-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">subject =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) <span class="op">%&gt;%</span></span>
<span id="cb787-7"><a href="two-parameters.html#cb787-7"></a><span class="st">  </span><span class="kw">replace_na</span>(<span class="kw">list</span>(<span class="dt">Treated =</span> <span class="st">"?"</span>, <span class="dt">Control =</span> <span class="st">"?"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb787-8"><a href="two-parameters.html#cb787-8"></a><span class="st">  </span><span class="kw">select</span>(subject, Control, Treated)</span>
<span id="cb787-9"><a href="two-parameters.html#cb787-9"></a></span>
<span id="cb787-10"><a href="two-parameters.html#cb787-10"></a><span class="co">#Mathematical notation</span></span>
<span id="cb787-11"><a href="two-parameters.html#cb787-11"></a></span>
<span id="cb787-12"><a href="two-parameters.html#cb787-12"></a>trains_RCM <span class="op">%&gt;%</span></span>
<span id="cb787-13"><a href="two-parameters.html#cb787-13"></a><span class="st">  </span><span class="kw">gt</span>() <span class="op">%&gt;%</span></span>
<span id="cb787-14"><a href="two-parameters.html#cb787-14"></a><span class="st">  </span><span class="kw">cols_label</span>(<span class="dt">subject =</span> <span class="kw">md</span>(<span class="st">"$$</span><span class="ch">\\</span><span class="st">mathbf{Subject}$$"</span>),</span>
<span id="cb787-15"><a href="two-parameters.html#cb787-15"></a>                <span class="dt">Control =</span> <span class="kw">md</span>(<span class="st">"$$Y_c(u)$$"</span>),</span>
<span id="cb787-16"><a href="two-parameters.html#cb787-16"></a>                <span class="dt">Treated =</span> <span class="kw">md</span>(<span class="st">"$$Y_t(u)$$"</span>)) <span class="op">%&gt;%</span></span>
<span id="cb787-17"><a href="two-parameters.html#cb787-17"></a><span class="st">  </span><span class="kw">tab_style</span>(<span class="kw">cell_borders</span>(<span class="dt">sides =</span> <span class="st">"right"</span>),</span>
<span id="cb787-18"><a href="two-parameters.html#cb787-18"></a>            <span class="dt">location =</span> <span class="kw">cells_body</span>(<span class="dt">columns =</span> <span class="kw">vars</span>(subject))) <span class="op">%&gt;%</span></span>
<span id="cb787-19"><a href="two-parameters.html#cb787-19"></a><span class="st">  </span><span class="kw">tab_style</span>(<span class="kw">cell_text</span>(<span class="dt">weight =</span> <span class="st">"bold"</span>),</span>
<span id="cb787-20"><a href="two-parameters.html#cb787-20"></a>            <span class="dt">location =</span> <span class="kw">cells_body</span>(<span class="dt">columns =</span> <span class="kw">vars</span>(subject))) <span class="op">%&gt;%</span></span>
<span id="cb787-21"><a href="two-parameters.html#cb787-21"></a><span class="st">  </span><span class="kw">cols_align</span>(<span class="dt">align =</span> <span class="st">"center"</span>, <span class="dt">columns =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb787-22"><a href="two-parameters.html#cb787-22"></a><span class="st">  </span><span class="kw">tab_header</span>(<span class="dt">title =</span> <span class="st">"Att_end of First Ten Respondents of Train Dataset"</span>)</span></code></pre></div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#jtawudmdkk .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jtawudmdkk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jtawudmdkk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jtawudmdkk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jtawudmdkk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jtawudmdkk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jtawudmdkk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jtawudmdkk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jtawudmdkk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jtawudmdkk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jtawudmdkk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jtawudmdkk .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#jtawudmdkk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jtawudmdkk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jtawudmdkk .gt_from_md > :first-child {
  margin-top: 0;
}

#jtawudmdkk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jtawudmdkk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jtawudmdkk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#jtawudmdkk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jtawudmdkk .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#jtawudmdkk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jtawudmdkk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jtawudmdkk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jtawudmdkk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jtawudmdkk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#jtawudmdkk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jtawudmdkk .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#jtawudmdkk .gt_left {
  text-align: left;
}

#jtawudmdkk .gt_center {
  text-align: center;
}

#jtawudmdkk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jtawudmdkk .gt_font_normal {
  font-weight: normal;
}

#jtawudmdkk .gt_font_bold {
  font-weight: bold;
}

#jtawudmdkk .gt_font_italic {
  font-style: italic;
}

#jtawudmdkk .gt_super {
  font-size: 65%;
}

#jtawudmdkk .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="jtawudmdkk" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
<thead class="gt_header">
<tr>
<th colspan="3" class="gt_heading gt_title gt_font_normal" style>Att_end of First Ten Respondents of Train Dataset</th>
    </tr>
<tr>
<th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
</thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">$$\mathbf{Subject}$$</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">$$Y_c(u)$$</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">$$Y_t(u)$$</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">1</td>
      <td class="gt_row gt_center">?</td>
      <td class="gt_row gt_center">11</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">2</td>
      <td class="gt_row gt_center">?</td>
      <td class="gt_row gt_center">10</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">3</td>
      <td class="gt_row gt_center">?</td>
      <td class="gt_row gt_center">5</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">4</td>
      <td class="gt_row gt_center">?</td>
      <td class="gt_row gt_center">11</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">5</td>
      <td class="gt_row gt_center">5</td>
      <td class="gt_row gt_center">?</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">6</td>
      <td class="gt_row gt_center">?</td>
      <td class="gt_row gt_center">13</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">7</td>
      <td class="gt_row gt_center">13</td>
      <td class="gt_row gt_center">?</td>
    </tr>
</tbody>
</table></div>
<p>Recall that the Rubin Causal Model centers on filling in the unknowns, which are indicated by the “?”s in the table. There’s one way we could fill in the missing values — we could use our approximations we generated with our <code>lm()</code> model: that is, for each unknown Treated value, we use 10, and for each unknown Control value, we use 8.45. This is certainly a reasonable prediction.</p>
<p>There’s one way we could fill in the missing values — we could use our approximations we generated with our <code>lm()</code> model: that is, for each unknown Treated value, we use 10, and for each unknown Control value, we use 8.45. We also attach the uncertainty attached for these predictions.</p>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#gaczxfonea .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gaczxfonea .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gaczxfonea .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gaczxfonea .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gaczxfonea .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gaczxfonea .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gaczxfonea .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gaczxfonea .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gaczxfonea .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gaczxfonea .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gaczxfonea .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gaczxfonea .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#gaczxfonea .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gaczxfonea .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gaczxfonea .gt_from_md > :first-child {
  margin-top: 0;
}

#gaczxfonea .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gaczxfonea .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gaczxfonea .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#gaczxfonea .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gaczxfonea .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#gaczxfonea .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gaczxfonea .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gaczxfonea .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gaczxfonea .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gaczxfonea .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#gaczxfonea .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gaczxfonea .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#gaczxfonea .gt_left {
  text-align: left;
}

#gaczxfonea .gt_center {
  text-align: center;
}

#gaczxfonea .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gaczxfonea .gt_font_normal {
  font-weight: normal;
}

#gaczxfonea .gt_font_bold {
  font-weight: bold;
}

#gaczxfonea .gt_font_italic {
  font-style: italic;
}

#gaczxfonea .gt_super {
  font-size: 65%;
}

#gaczxfonea .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="gaczxfonea" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
<thead class="gt_header">
<tr>
<th colspan="3" class="gt_heading gt_title gt_font_normal" style>Att_end of First Ten Respondents of Train Dataset</th>
    </tr>
<tr>
<th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
</thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">$$\mathbf{Subject}$$</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">$$Y_c(u)$$</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">$$Y_t(u)$$</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">1</td>
      <td class="gt_row gt_center">8.45 (7.76-9.14)</td>
      <td class="gt_row gt_center">11</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">2</td>
      <td class="gt_row gt_center">8.45 (7.76-9.14)</td>
      <td class="gt_row gt_center">10</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">3</td>
      <td class="gt_row gt_center">8.45 (7.76-9.14)</td>
      <td class="gt_row gt_center">5</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">4</td>
      <td class="gt_row gt_center">8.45 (7.76-9.14)</td>
      <td class="gt_row gt_center">11</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">5</td>
      <td class="gt_row gt_center">5</td>
      <td class="gt_row gt_center">10 (9.2-10.8)</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">6</td>
      <td class="gt_row gt_center">8.45 (7.76-9.14)</td>
      <td class="gt_row gt_center">13</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">7</td>
      <td class="gt_row gt_center">13</td>
      <td class="gt_row gt_center">10 (9.2-10.8)</td>
    </tr>
</tbody>
</table></div>
<p>Recall our earlier conversation regarding the difference between confidence intervals; an argument could be made that, taking individual variation into account, prediction intervals would be more accurate indicators of uncertainty than confidence intervals. We can construct the above table using prediction intervals instead, generated using the <code>predict()</code> function:</p>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="two-parameters.html#cb788-1"></a><span class="kw">lm</span>(<span class="dt">data =</span> trains, att_end <span class="op">~</span><span class="st"> </span>treatment) <span class="op">%&gt;%</span></span>
<span id="cb788-2"><a href="two-parameters.html#cb788-2"></a><span class="kw">predict</span>(<span class="kw">tibble</span>(<span class="dt">treatment =</span> <span class="kw">c</span>(<span class="st">"Treated"</span>, <span class="st">"Control"</span>)), </span>
<span id="cb788-3"><a href="two-parameters.html#cb788-3"></a>        <span class="dt">interval =</span> <span class="st">"prediction"</span>)</span></code></pre></div>
<pre><code>##         fit      lwr      upr
## 1 10.000000 4.443202 15.55680
## 2  8.453125 2.907191 13.99906</code></pre>
<p>And we can reconstruct the table by filling in the unknowns with the predictions (note that these are unchanged) and their associated levels of uncertainty (which HAVE changed to accomodate for individual variation within the data):</p>
<!-- EM: Note that some of the uncertainty boundaries exceed 3 or 15, which were the minimum and maximum values for att_end, respectively. This should be made apparent in a margin note for the tables that have uncertainty bounds below 3 or above 15. -->
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="two-parameters.html#cb790-1"></a>trains.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data =</span> trains, att_end <span class="op">~</span><span class="st"> </span>treatment)</span>
<span id="cb790-2"><a href="two-parameters.html#cb790-2"></a>newdata &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">treatment =</span> <span class="kw">c</span>(<span class="st">"Treated"</span>, <span class="st">"Control"</span>))</span>
<span id="cb790-3"><a href="two-parameters.html#cb790-3"></a></span>
<span id="cb790-4"><a href="two-parameters.html#cb790-4"></a><span class="kw">predict</span>(trains.lm, newdata, <span class="dt">interval =</span> <span class="st">"prediction"</span>)</span></code></pre></div>
<pre><code>##         fit      lwr      upr
## 1 10.000000 4.443202 15.55680
## 2  8.453125 2.907191 13.99906</code></pre>
<p>And we can reconstruct the table by filling in the unknowns with the predictions (note that these are unchanged) and their associated levels of uncertainty (which HAVE changed to accomodate for individual variation within the data):</p>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#hgclfhersm .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hgclfhersm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hgclfhersm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hgclfhersm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hgclfhersm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hgclfhersm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hgclfhersm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hgclfhersm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hgclfhersm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hgclfhersm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hgclfhersm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hgclfhersm .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#hgclfhersm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hgclfhersm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hgclfhersm .gt_from_md > :first-child {
  margin-top: 0;
}

#hgclfhersm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hgclfhersm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hgclfhersm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#hgclfhersm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hgclfhersm .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#hgclfhersm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hgclfhersm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hgclfhersm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hgclfhersm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hgclfhersm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#hgclfhersm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hgclfhersm .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#hgclfhersm .gt_left {
  text-align: left;
}

#hgclfhersm .gt_center {
  text-align: center;
}

#hgclfhersm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hgclfhersm .gt_font_normal {
  font-weight: normal;
}

#hgclfhersm .gt_font_bold {
  font-weight: bold;
}

#hgclfhersm .gt_font_italic {
  font-style: italic;
}

#hgclfhersm .gt_super {
  font-size: 65%;
}

#hgclfhersm .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="hgclfhersm" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
<thead class="gt_header">
<tr>
<th colspan="3" class="gt_heading gt_title gt_font_normal" style>Att_end of First Ten Respondents of Train Dataset</th>
    </tr>
<tr>
<th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
</thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">$$\mathbf{Subject}$$<sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">$$Y_c(u)$$<sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">$$Y_t(u)$$<sup class="gt_footnote_marks">1</sup>
</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">1</td>
      <td class="gt_row gt_center">8.45 (2.9-14.0)</td>
      <td class="gt_row gt_center">11</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">2</td>
      <td class="gt_row gt_center">8.45 (2.9-14.0)</td>
      <td class="gt_row gt_center">10</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">3</td>
      <td class="gt_row gt_center">8.45 (2.9-14.0)</td>
      <td class="gt_row gt_center">5</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">4</td>
      <td class="gt_row gt_center">8.45 (2.9-14.0)</td>
      <td class="gt_row gt_center">11</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">5</td>
      <td class="gt_row gt_center">5</td>
      <td class="gt_row gt_center">10 (4.4-15.6)</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">6</td>
      <td class="gt_row gt_center">8.45 (2.9-14.0)</td>
      <td class="gt_row gt_center">13</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">7</td>
      <td class="gt_row gt_center">13</td>
      <td class="gt_row gt_center">10 (4.4-15.6)</td>
    </tr>
</tbody>
<tfoot><tr class="gt_footnotes">
<td colspan="3">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks"><em>1</em>
          </sup>
           
          Note: minimum att_end is 3 and maximum att_end is 15
          <br></p>
      </td>
    </tr></tfoot>
</table></div>
<p>Regardless of whether we use confidence or prediction intervals for these unknowns, however, the table looks a bit funky: take a look at subject 3. According to this model, subject 3’s attitude under control would be HIGHER than his/her attitude under treatment, which corresponds to a negative treatment effect. This would mean that he/she would become more LIBERAL after undergoing treatment, which flies in the face of the ATE we calculated earlier. Another example of this can be seen with subject 7, whose predicted <code>att_end</code> under treatment is lower than his/her <code>att_end</code> under control (also signifying a shift towards liberal attitudes regarding immigration).</p>
<p>Clearly, using the same control and treatment values to fill in the unknowns doesn’t capture the entire picture. While using <code>lm()</code> to fill in the <code>att_end</code> unknowns towards the center of the distribution, it makes less sense for values towards the outskirts of the dataset. So, how can we predict outcomes in a way that equally addresses data towards the center of the distribution, and data that isn’t?</p>
<p>One such way is by attaching the ATE in the appropriate direction to fill in the unknowns. Here, we use lm() to calculate confidence intervals for the ATE, which we previously calculated to be -1.546875, and add and subtract those from the known values to fill in the unknown values:</p>
<pre><code>## # A tibble: 2 x 4
##   term             estimate conf.low conf.high
##   &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)          8.45    7.77       9.14
## 2 treatmentTreated     1.55    0.514      2.58</code></pre>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#lgfghrlfmu .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lgfghrlfmu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lgfghrlfmu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lgfghrlfmu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lgfghrlfmu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lgfghrlfmu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lgfghrlfmu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lgfghrlfmu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lgfghrlfmu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lgfghrlfmu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lgfghrlfmu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lgfghrlfmu .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#lgfghrlfmu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lgfghrlfmu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lgfghrlfmu .gt_from_md > :first-child {
  margin-top: 0;
}

#lgfghrlfmu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lgfghrlfmu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lgfghrlfmu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#lgfghrlfmu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lgfghrlfmu .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#lgfghrlfmu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lgfghrlfmu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lgfghrlfmu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lgfghrlfmu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lgfghrlfmu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#lgfghrlfmu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lgfghrlfmu .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#lgfghrlfmu .gt_left {
  text-align: left;
}

#lgfghrlfmu .gt_center {
  text-align: center;
}

#lgfghrlfmu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lgfghrlfmu .gt_font_normal {
  font-weight: normal;
}

#lgfghrlfmu .gt_font_bold {
  font-weight: bold;
}

#lgfghrlfmu .gt_font_italic {
  font-style: italic;
}

#lgfghrlfmu .gt_super {
  font-size: 65%;
}

#lgfghrlfmu .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="lgfghrlfmu" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
<thead class="gt_header">
<tr>
<th colspan="3" class="gt_heading gt_title gt_font_normal" style>Att_end of First Ten Respondents of Train Dataset</th>
    </tr>
<tr>
<th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
</thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">$$\mathbf{Subject}$$</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">$$Y_c(u)$$</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">$$Y_t(u)$$</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">1</td>
      <td class="gt_row gt_center">9.45 (8.42, 10.48)</td>
      <td class="gt_row gt_center">11</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">2</td>
      <td class="gt_row gt_center">8.45 (7.42, 9.48)</td>
      <td class="gt_row gt_center">10</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">3</td>
      <td class="gt_row gt_center">3.45 (2.42, 4.48)</td>
      <td class="gt_row gt_center">5</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">4</td>
      <td class="gt_row gt_center">9.45 (8.42, 10.48)</td>
      <td class="gt_row gt_center">11</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">5</td>
      <td class="gt_row gt_center">5</td>
      <td class="gt_row gt_center">6.55 (5.52, 7.58)</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">6</td>
      <td class="gt_row gt_center">11.45 (10.42, 12.48)</td>
      <td class="gt_row gt_center">13</td>
    </tr>
<tr>
<td class="gt_row gt_center" style="border-right-width: 1px; border-right-style: solid; border-right-color: #000000; font-weight: bold;">7</td>
      <td class="gt_row gt_center">13</td>
      <td class="gt_row gt_center">14.55 (13.52, 15.58)</td>
    </tr>
</tbody>
</table></div>
<!-- EM: Unsure how to tie in probability -->
</div>
<div id="uncertainties" class="section level2">
<h2>
<span class="header-section-number">8.11</span> Uncertainties</h2>
<p>There are various sources of uncertainties and problems that have addressed in previous chapters and again in this chapter. It’s important that you always have these in the back of your mind when working with data:</p>
<ol style="list-style-type: decimal">
<li><p><em>Validity</em>. At the surface level, parameter names might not invoke too much thought — but once you really sit down and think about the story the numbers are trying to tell, it’s not always the case that the numbers deserve to tell that story. In our earlier discussion regarding <code>income</code> and <code>att_end</code>, the conclusions we draw from these data might be misleading just because the way they were collected or computed inevitably change these conclusions. Even when there’s nothing WRONG with a setup, we need to keep in mind that the smallest differences</p></li>
<li><p>When we dive deeper into the data, we run into the issue of <em>parameter uncertainty</em>, which is the uncertainty associated with our analysis of summary parameters, such as mean, median, and range. In our above analysis with the <code>trains</code> dataset, we account for parameter uncertainty using confidence intervals.</p></li>
<li><p>As great as confidence intervals are, they don’t capture the uncertainty of using summary statistics to predict parameter values of random individuals. We are more sure, for example, about the range of possible incomes for the mean income of American democrats than we are about the range of possible incomes for a single American democrat, whose income could stray far from the mean democrat income. This <em>unmodeled variation</em>, or variation between data points that is not fully captured by bootstrapping, deserves much consideration when dealing with data.</p></li>
<li><p><em>Unknown unknowns</em> are an especially unavoidable source of uncertainty. The world is changing, and people 50 years from now might act differently and have vastly different lifestyles and characteristics; in the case of the <code>trains</code> dataset, it wouldn’t be unreasonable to expect completely different combinations of income and party affiliation. That would render our mean income, median ratio, and prediction intervals for both those measures useless.</p></li>
</ol>
</div>
<div id="testing-is-evil" class="section level2">
<h2>
<span class="header-section-number">8.12</span> Testing is Evil</h2>
<!-- Will probably make more sense to dive into this after finishing up RCM step?

<!-- See style.Rmd for a discussion -->

</div>
</div></body></html>

<p style="text-align: center;">
<a href="one-parameter.html"><button class="btn btn-default">Previous</button></a>
<a href="n-parameters.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2020-07-08
</p>
</div>
</div>



</body>
</html>
