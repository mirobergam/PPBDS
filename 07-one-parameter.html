<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="07-one-parameter.utf8" />
<meta property="og:type" content="book" />







<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="07-one-parameter.utf8">

<title>07-one-parameter.utf8</title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css-0/msmb.css" rel="stylesheet" />
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }

code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



</head>

<body>




<!--bookdown:toc:start-->
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title"><p><p class="author"></p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="#confidence-intervals"><span class="toc-section-number">1</span> One Parameter</a>
</div>
</li>
</ul>
</div>
<!--bookdown:toc:end-->

<!--bookdown:body:start-->
<div id="confidence-intervals" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> One Parameter</h1>
<!-- Test1 -->
<!-- Get git pictures -->
<!-- 0) Get rid of all kable(). Use gt() instead. -->
<!-- 2) Need to get rid of `rep_sample_n()` and replace with `rsample:boostraps()`. Example usage [here](https://juliasilge.com/blog/beer-production/). Do this first, just to get warmed up. Make sure everything still works! Consult this [useful tutorial](https://www.danielphadley.com/bootstrap_tutto/) for the bootstraps function. We can keep everything else with the penny example the same, for now. -->
<!-- 3) Clean up "absurd hack" table code. -->
<!-- 4) After completing the current penny example, show how we can estimate other estimands --- the median, 3rd biggest, et cetera --- in exactly the same way. All the same procedures apply in these cases. Obviously, we can go much faster and don't have to do them all. Key is to see that there are many things (and their uncertainty) which we can estimate. The mean is just one of them. We can still just use our standard Bayesian interpretation for all these estimands and uncertainty intervals. -->
<!-- 3) Refer back to the probability chapter. Note that it ends with the estimating of a single parameter, the p associated with a coin. You want to remind readers of what they have already learned and also move a little bit further. Read the set of notes at the start of chapter 6.  -->
<!-- 4) Recall how the probability chapter goes farther than this. It gets all the way to posterior predictions. What will be the mint year of the next penny we get from the bank? What will be the average of the next five pennies we pull? What is a reasonable uncertainty for these forecasts?  Do a posterior predictive checks. Note that we should use all the same "tools" as in that probability chapter. That is, our bootstraps has built a posterior distribution, just like the posterior distribution we built with the coin tosses. We then sample from this posterior to answer other questions. -->
<!-- 4a) Key issue: How to we transition from this crazy bootstrap approach to using R functions to make the same calculations. Bootstraps take too long, and they are a bother. We need to show how they give the same answer as the built in R functions and then transition away from the bootstrap. Indeed, there is an argument that this chapter (or last chapter?) is the last Bayes Scatterplot we show. That was all about intuition. Once we have that, we can just go to doing things the right way. -->
<!-- 4b) Key issue two: Do we go straight from the bootstrap to rstanarm functions? That would be pretty aggressive. But also pretty cool! Or maybe this chapter we show the bootstrap, the base R (t.test()? lm()?) and rstanarm together. Indeed, the goal for this chapter is to connect them all. Then, next chapter (two parameters) leaves out the bootstrap. And then N parameters drop base functions. But does that really work? Maybe we use base and rstanarm for the rest of the book? Maybe rstanarm only appears in advanced sections. We never use them in this class. Save them for Gov 52? I don't know! -->
<!-- 5) Need to build a Rubin Table. (Read chapter 3 for background and discussion.) We want to have the year for every penny in the world. Sadly, we don't have that! But we do have 50 pennies. Show an RT, which shows both pennies we know the year of and pennies we don't know the year of. If we knew all the pennies, we could just caculate our estimand directly. We would know exactly the mean, the median, the 3rd oldest and so on. No uncertainty. But, we don't have all the years. The question marks mock us! So, we need to infer what is in the missing rows. (And then we . . . not sure I have thought this through.) Also, we can discuss lots of possible biases in the sampling mechanism. Indeed, the sampling mechanism is the key thing to discuss in this section. -->
<!-- 6) We should start the chapter with a decision we face, even a toy one which is not much more than the prediction game. Maybe our friend Joe bets us that a random penny that we get in change from Starbuck's will be older than 1990. Should we take the bet? At what odds? Then, we come back to this at the end and, with the information we have learned, take the bet or not. -->
<!-- 7) Always nice to highlight how flexible the simulation approach is. You might be able to solve the basic problem analytically. But, as soon as some complexity comes in, simulation is your only hope. For example, Joe bets that the second oldest of the four pennies he got in change is older than 1990. Take that bet? Only (?) approach is simulation. Or maybe we should start with a bet which we know can only be solved with simulation. -->
<!-- Other Notes -->
<!-- Are pennies the best example? Maybe we should use more interesting data? We want it to be a smallish data set since the the bootstraps take time. Maybe we go through the penny example solely, with all the nice pictures and discussion. Then we do something else, like income in Massachusetts, and then do the same series of steps much more quickly. -->
<!-- This is probably too hard for the chapter itself but might make for a good problem set: Estimating who is going to win an election as the votes come in. After one vote, don't know anything. After 5 votes, maybe a little. After 10 votes, more. And so on. Show how the best estimate evolves over time, as information comes in. Do this as a contest. What procedure is best? Show that some shrinkage is a very good idea. Each stage is, potentially, a new contest. See which approach wins the most contests. In the end, of course, they converge. Can't just be "Repub ahead" as H_1. Need to be "Repub = 0.6" Without this hack, can't calculate the likelihood easily. Right? See Rossman approach for tennis matches.  -->
<!-- Show updating as each vote comes in. Then show that you get the same answer if you just include all the votes at once. -->
<!-- First, look at competing models. Who is ahead, D or R? -->
<!-- Second, add another model. D or R or tied? -->
<!-- Third, what is D percentage of support? -->
<!-- Assuming this is correct, we get to bring in prediction and betting. Then, we have the motivating question: What is a good estimate for the percentage of Democrats in this bucket? How do we combine information from the overall population and from our sample to come up with a good estimate, and confidence interval, for the percentage Democratic in that bucket? Perhaps this multi-level model is one of the last things we do. Even Mr P??  -->
<!-- Find a place for this quote somewhere. -->
<!-- > In this sense, the bootstrap distribution represents an (approximate) -->
<!-- nonparametric, noninformative posterior distribution for our parameter. -->
<!-- But this bootstrap distribution is obtained painlessly --- without having to -->
<!-- formally specify a prior and without having to sample from the posterior -->
<!-- distribution. Hence we might think of the bootstrap distribution as a “poor -->
<!-- man’s” Bayes posterior. By perturbing the data, the bootstrap approximates -->
<!-- the Bayesian effect of perturbing the parameters, and is typically -->
<!-- much simpler to carry out. --- Elements of Statistical Learning, 2nd edition, by Hastie et al, page 271. -->
<!-- Workshop Statistics:  Discovery with Data, A Bayesian Approach by James H. Albert and Allan J. Rossman --- Topic 16 has some interesting stuff about how we learn a proportion.  -->
<p>In Chapter <a href="#sampling"><strong>??</strong></a>, we studied sampling. We started with a “tactile” exercise where we wanted to know the proportion of balls in the urn in Figure <a href="#fig:sampling-exercise-1"><strong>??</strong></a> that are red. While we could have performed an exhaustive count, this would have been a tedious process. So instead, we used a shovel to extract a sample of 50 balls and used the resulting proportion that were red as an <em>estimate</em>. Furthermore, we made sure to mix the urn’s contents before every use of the shovel. Because of the randomness created by the mixing, different uses of the shovel yielded different proportions red and hence different estimates of the proportion of the urn’s balls that are red.</p>
<p>Remember: There is a <em>truth</em> here. There is an urn. It has red and white balls in it. An exact, but unknown, number of the balls are red. An exact, but unknown, number of the balls are white. An exact, but unknown, percentage of the balls are red – defined as the number red divided by the sum of the number red and the number white. Our goal is to estimate that unknown percentage. We want to make statements about the world, even if we can never be certain that those statements are <em>true</em>. We will never have the time or inclination to actually count all the balls. We use the term <em>parameter</em> for things that exist but which are unknown. We use statistics to estimate the true values of parameters.</p>
<p>We then mimicked this <em>physical</em> sampling exercise with an equivalent <em>virtual</em> sampling exercise using the computer. In Subsection <a href="#different-shovels"><strong>??</strong></a>, we repeated this sampling procedure 1,000 times, using three different virtual shovels with 25, 50, and 100 slots. We visualized these three sets of 1,000 estimates in Figure <a href="#fig:comparing-sampling-distributions-3"><strong>??</strong></a> and saw that as the sample size increased, the variation in the estimates decreased. We then expanded this for all sample sizes from 1 to 100.</p>
<p>In doing so, we constructed <em>sampling distributions</em>. The motivation for taking a 1,000 repeated samples and visualizing the resulting estimates was to study how these estimates varied from one sample to another; in other words, we wanted to study the effect of <em>sampling variation</em>. We quantified the variation of these estimates using their standard deviation, which has a special name: the <em>standard error</em>. In particular, we saw that as the sample size increased from 1 to 100, the standard error decreased and thus the sampling distributions narrowed. Larger sample sizes led to more <em>precise</em> estimates that varied less around the center.</p>
<p>We then tied these sampling exercises to terminology and mathematical notation related to sampling in Subsection <a href="#terminology-and-notation"><strong>??</strong></a>. Our <em>study population</em> was the large urn with <span class="math inline">\(N\)</span> = 2,400 balls, while the <em>population parameter</em>, the unknown quantity of interest, was the population proportion <span class="math inline">\(p\)</span> of the urn’s balls that were red. Since performing a <em>census</em> would be expensive in terms of time and energy, we instead extracted a <em>sample</em> of size <span class="math inline">\(n\)</span> = 50. The <em>point estimate</em>, also known as a <em>sample statistic</em>, used to estimate <span class="math inline">\(p\)</span> was the sample proportion <span class="math inline">\(\widehat{p}\)</span> of these 50 sampled balls that were red. Furthermore, since the sample was obtained at <em>random</em>, it can be considered as <em>unbiased</em> and as <em>representative</em> of the population. Thus any results based on the sample could be <em>generalized</em> to the population. Therefore, the proportion of the shovel’s balls that were red was a “good guess” of the proportion of the urn’s balls that are red. In other words, we used the sample to draw <em>inferences</em> about the population.</p>
<p>However, as described in Section <a href="#sampling-simulation"><strong>??</strong></a>, both the physical and virtual sampling exercises are not what one would do in real life. This was merely an activity used to study the effects of sampling variation. In a real life situation, we would not take 1,000 samples of size <span class="math inline">\(n\)</span>, but rather take a <em>single</em> representative sample that’s as large as possible. Additionally, we knew that the true proportion of the urn’s balls that were red was 37.5%. In a real-life situation, we will not know what this value is. Because if we did, then why would we take a sample to estimate it?</p>
<p>An example of a realistic sampling situation would be a poll, like the <a href="https://www.npr.org/sections/itsallpolitics/2013/12/04/248793753/poll-support-for-obama-among-young-americans-eroding">Obama poll</a> you saw in Section <a href="#sampling-case-study"><strong>??</strong></a>. Pollsters did not know the true proportion of <em>all</em> young Americans who supported President Obama in 2013, and thus they took a single sample of size <span class="math inline">\(n\)</span> = 2,089 young Americans to estimate this value.</p>
<p>So how does one quantify the effects of sampling variation when you only have a <em>single sample</em> to work with? You cannot directly study the effects of sampling variation when you only have one sample. One common method to study this is <em>bootstrapping resampling</em>.</p>
<p>What if we would like, not only a single estimate of the unknown population parameter, but also a <em>range of highly plausible</em> values? Going back to the Obama poll article, it stated that the pollsters’ estimate of the proportion of all young Americans who supported President Obama was 41%. But in addition it stated that the poll’s “margin of error was plus or minus 2.1 percentage points.” This “plausible range” was [41% - 2.1%, 41% + 2.1%] = [38.9%, 43.1%]. This range of plausible values is what’s known as a <em>confidence interval</em>, which will be the focus of the later sections of this chapter.</p>
<!--
Create graphic illustrating two-step process of 1) construct bootstrap distribution
and then 2) based on bootstrap dist'n create CI?
-->
<div id="needed-packages" class="section level3 unnumbered">
<h3>Needed packages</h3>
<p>Let’s load all the packages needed for this chapter (this assumes you’ve already installed them). Recall from our discussion in Section <a href="#tidyverse-package"><strong>??</strong></a> that loading the <strong>tidyverse</strong> package by running <code>library(tidyverse)</code> loads the following commonly used data science packages all at once:</p>
<ul>
<li><strong>ggplot2</strong> for data visualization</li>
<li><strong>dplyr</strong> for data wrangling</li>
<li><strong>tidyr</strong> for converting data to tidy format</li>
<li><strong>readr</strong> for importing spreadsheet data into R</li>
<li>As well as the more advanced <strong>purrr</strong>, <strong>tibble</strong>, <strong>stringr</strong>, and <strong>forcats</strong> packages</li>
</ul>
<p>If needed, read Section <a href="#packages"><strong>??</strong></a> for information on how to install and load R packages.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
</div>
</div>
<div id="resampling-tactile" class="section level2">
<h2><span class="header-section-number">1.1</span> Pennies activity</h2>
<p>As we did in Chapter <a href="#sampling"><strong>??</strong></a>, we’ll begin with a hands-on tactile activity.</p>
<div id="what-is-the-average-year-on-us-pennies-in-2019" class="section level3">
<h3><span class="header-section-number">1.1.1</span> What is the average year on US pennies in 2019?</h3>
<p>Try to imagine all the pennies being used in the United States in 2019. That’s a lot of pennies! Now say we’re interested in the average year of minting of <em>all</em> these pennies. One way to compute this value would be to gather up all pennies being used in the US, record the year, and compute the average. However, this would be near impossible! So instead, let’s collect a <em>sample</em> of 50 pennies from a local bank in downtown Northampton, Massachusetts, USA as seen in Figure <a href="#fig:resampling-exercise-a"><strong>??</strong></a>.</p>
<div class="figure"><span id="fig:unnamed-chunk-3-1"></span>
<p class="caption marginnote shownote">
FIGURE 1.1: Collecting a sample of 50 US pennies from a local bank.
</p>
<img src="07-one-parameter/images/bank.jpg" alt="Collecting a sample of 50 US pennies from a local bank."  />
</div>
<div class="figure"><span id="fig:unnamed-chunk-3-2"></span>
<p class="caption marginnote shownote">
FIGURE 1.2: Collecting a sample of 50 US pennies from a local bank.
</p>
<img src="07-one-parameter/images/roll.jpg" alt="Collecting a sample of 50 US pennies from a local bank."  />
</div>
<p>An image of these 50 pennies can be seen in Figure <a href="#fig:resampling-exercise-c"><strong>??</strong></a>. For each of the 50 pennies starting in the top left, progressing row-by-row, and ending in the bottom right, note there is an “ID” identification variable printed in black and the year of minting printed in white.</p>
<div class="figure"><span id="fig:unnamed-chunk-4"></span>
<p class="caption marginnote shownote">
FIGURE 1.3: 50 US pennies labelled.
</p>
<img src="07-one-parameter/images/3.jpg" alt="50 US pennies labelled."  />
</div>
<p>The <strong>moderndive</strong>  package contains this data on our 50 sampled pennies in the <code>pennies_sample</code> data frame:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(moderndive)</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a>pennies_sample</span></code></pre></div>
<pre><code>## # A tibble: 50 x 2
##       ID  year
##    &lt;int&gt; &lt;dbl&gt;
##  1     1  2002
##  2     2  1986
##  3     3  2017
##  4     4  1988
##  5     5  2008
##  6     6  1983
##  7     7  2008
##  8     8  1996
##  9     9  2004
## 10    10  2000
## # … with 40 more rows</code></pre>
<p>The <code>pennies_sample</code> data frame has 50 rows corresponding to each penny with two variables. The first variable <code>ID</code> corresponds to the ID labels in Figure <a href="#fig:resampling-exercise-c"><strong>??</strong></a>, whereas the second variable <code>year</code> corresponds to the year of minting saved as a numeric variable, also known as a double (<code>dbl</code>).</p>
<p>Based on these 50 sampled pennies, what can we say about <em>all</em> US pennies in 2019? Let’s study some properties of our sample by performing an exploratory data analysis. Let’s first visualize the distribution of the year of these 50 pennies using our data visualization tools from Chapter <a href="#viz"><strong>??</strong></a>. Since <code>year</code> is a numerical variable, we use a histogram in Figure <a href="#fig:pennies-sample-histogram"><strong>??</strong></a> to visualize its distribution.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>pennies_sample <span class="op">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year)) <span class="op">+</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">10</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-6"></span>
<p class="caption marginnote shownote">
FIGURE 1.4: Distribution of year on 50 US pennies.
</p>
<img src="07-one-parameter_files/figure-html/unnamed-chunk-6-1.png" alt="Distribution of year on 50 US pennies." width="672"  />
</div>
<p>Observe a slightly left-skewed  distribution, since most pennies fall between 1980 and 2010 with only a few pennies older than 1970. What is the average year for the 50 sampled pennies? Eyeballing the histogram it appears to be around 1990. Let’s now compute this value exactly using our data wrangling tools from Chapter <a href="#wrangling"><strong>??</strong></a>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_year =</span> <span class="kw">mean</span>(year))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   mean_year
##       &lt;dbl&gt;
## 1     1995.</code></pre>
<p>Thus, if we’re willing to assume that <code>pennies_sample</code> is a representative sample from <em>all</em> US pennies, a “good guess” of the average year of minting of all US pennies would be 1995.44. In other words, around 1995. This should all start sounding similar to what we did previously in Chapter <a href="#sampling"><strong>??</strong></a>!</p>
<p>In Chapter <a href="#sampling"><strong>??</strong></a>, our <em>study population</em> was the urn of <span class="math inline">\(N\)</span> = 2400 balls. Our <em>population parameter</em> was the <em>population proportion</em> of these balls that were red, denoted by <span class="math inline">\(p\)</span>. In order to estimate <span class="math inline">\(p\)</span>, we extracted a sample of 50 balls using the shovel. We then computed the relevant <em>point estimate</em>: the <em>sample proportion</em> of these 50 balls that were red, denoted mathematically by <span class="math inline">\(\widehat{p}\)</span>.</p>
<p>Here our population is <span class="math inline">\(N\)</span> = whatever the number of pennies are being used in the US, a value which we don’t know and probably never will. The population parameter of interest is now the <em>population mean</em> year of all these pennies, a value denoted mathematically by the Greek letter <span class="math inline">\(\mu\)</span> (pronounced “mu”). In order to estimate <span class="math inline">\(\mu\)</span>, we went to the bank and obtained a sample of 50 pennies and computed the relevant point estimate: the <em>sample mean</em> year of these 50 pennies, denoted mathematically by <span class="math inline">\(\overline{x}\)</span> (pronounced “x-bar”). An alternative and more intuitive notation for the sample mean is <span class="math inline">\(\widehat{\mu}\)</span>. However, this is unfortunately not as commonly used, so in this book we’ll stick with convention and always denote the sample mean as <span class="math inline">\(\overline{x}\)</span>.</p>
<p>We summarize the correspondence between the sampling urn exercise in Chapter <a href="#sampling"><strong>??</strong></a> and our pennies exercise in Table <a href="#tab:table-ch8-b"><strong>??</strong></a>.</p>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#bjjzskmryt .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bjjzskmryt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bjjzskmryt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bjjzskmryt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bjjzskmryt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bjjzskmryt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bjjzskmryt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bjjzskmryt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bjjzskmryt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bjjzskmryt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bjjzskmryt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bjjzskmryt .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#bjjzskmryt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bjjzskmryt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bjjzskmryt .gt_from_md > :first-child {
  margin-top: 0;
}

#bjjzskmryt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bjjzskmryt .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bjjzskmryt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#bjjzskmryt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bjjzskmryt .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#bjjzskmryt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bjjzskmryt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bjjzskmryt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bjjzskmryt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bjjzskmryt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#bjjzskmryt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bjjzskmryt .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#bjjzskmryt .gt_left {
  text-align: left;
}

#bjjzskmryt .gt_center {
  text-align: center;
}

#bjjzskmryt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bjjzskmryt .gt_font_normal {
  font-weight: normal;
}

#bjjzskmryt .gt_font_bold {
  font-weight: bold;
}

#bjjzskmryt .gt_font_italic {
  font-style: italic;
}

#bjjzskmryt .gt_super {
  font-size: 65%;
}

#bjjzskmryt .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="bjjzskmryt" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Scenario</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Population_parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Notation</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Point_Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Symbol</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>1</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>Population Proportion</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>$$p$$</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>Sample Proportion</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>$$\widehat{p}$$</p>
</div></td>
    </tr>
    <tr>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>2</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>Population mean</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>$$\mu $$</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>Sample mean</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>$$\overline{x}$$ or $$\widehat{\mu}$$</p>
</div></td>
    </tr>
    <tr>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>3</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>Difference in population proportions</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>$$p_1 - p_2$$</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>Difference in sample proportions</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>$$\widehat{p}_1 - \widehat{p}_2$$</p>
</div></td>
    </tr>
    <tr>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>4</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>Difference in Pupulation means</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>$$\mu_1 - \mu_2$$</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>Difference in sample means</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>$$\overline{x}_1 - \overline{x}_2$$</p>
</div></td>
    </tr>
    <tr>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>5</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>Population regression slope</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>$$\beta_1$$</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>Fitted regression slope</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>$$b_1$$ or $$\widehat{\beta}_1$$</p>
</div></td>
    </tr>
    <tr>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>6</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>Population regression coefficient</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>$$\beta_0$$</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>Fitted regression intercept</p>
</div></td>
      <td class="gt_row gt_left"><div class='gt_from_md'><p>$$b_0$$ or $$\widehat{\beta}_0$$</p>
</div></td>
    </tr>
  </tbody>
  
  
</table></div>
<p>Going back to our 50 sampled pennies in Figure <a href="#fig:resampling-exercise-c"><strong>??</strong></a>, the point estimate of interest is the sample mean <span class="math inline">\(\overline{x}\)</span> of 1995.44. This quantity is an <em>estimate</em> of the population mean year of <em>all</em> US pennies <span class="math inline">\(\mu\)</span>.</p>
<p>Recall that we also saw in Chapter <a href="#sampling"><strong>??</strong></a> that such estimates are prone to <em>sampling variation</em>. For example, in this particular sample in Figure <a href="#fig:resampling-exercise-c"><strong>??</strong></a>, we observed three pennies with the year 1999. If we sampled another 50 pennies, would we observe exactly three pennies with the year 1999 again? More than likely not. We might observe none, one, two, or maybe even all 50! The same can be said for the other 26 unique years that are represented in our sample of 50 pennies.</p>
<p>To study the effects of <em>sampling variation</em> in Chapter <a href="#sampling"><strong>??</strong></a>, we took many samples, something we could easily do with our shovel. In our case with pennies, however, how would we obtain another sample? By going to the bank and getting another roll of 50 pennies.</p>
<p>Say we’re feeling lazy, however, and don’t want to go back to the bank. How can we study the effects of sampling variation using our <em>single sample</em>? We will do so using a technique known as <em>bootstrap resampling with replacement</em>, which we now illustrate.</p>
</div>
<div id="resampling-once" class="section level3">
<h3><span class="header-section-number">1.1.2</span> Resampling once</h3>
<p><strong>Step 1</strong>: Let’s print out identically sized slips of paper representing our 50 pennies as seen in Figure <a href="#fig:tactile-resampling-1"><strong>??</strong></a>.</p>
<div class="figure"><span id="fig:unnamed-chunk-10"></span>
<p class="caption marginnote shownote">
FIGURE 1.5: Step 1: 50 slips of paper representing 50 US pennies.
</p>
<img src="07-one-parameter/images/1_paper_slips.png" alt="Step 1: 50 slips of paper representing 50 US pennies."  />
</div>
<p><strong>Step 2</strong>: Put the 50 slips of paper into a hat or tuque as seen in Figure <a href="#fig:tactile-resampling-2"><strong>??</strong></a>.</p>
<div class="figure"><span id="fig:unnamed-chunk-11"></span>
<p class="caption marginnote shownote">
FIGURE 1.6: Step 2: Putting 50 slips of paper in a hat.
</p>
<img src="07-one-parameter/images/2_insert_in_hat.png" alt="Step 2: Putting 50 slips of paper in a hat."  />
</div>
<p><strong>Step 3</strong>: Mix the hat’s contents and draw one slip of paper at random as seen in Figure <a href="#fig:tactile-resampling-3"><strong>??</strong></a>. Record the year.</p>
<div class="figure"><span id="fig:unnamed-chunk-12"></span>
<p class="caption marginnote shownote">
FIGURE 1.7: Step 3: Drawing one slip of paper at random.
</p>
<img src="07-one-parameter/images/3_draw_at_random.png" alt="Step 3: Drawing one slip of paper at random."  />
</div>
<p><strong>Step 4</strong>: Put the slip of paper back in the hat! In other words, replace it as seen in Figure <a href="#fig:tactile-resampling-4"><strong>??</strong></a>.</p>
<div class="figure"><span id="fig:unnamed-chunk-13"></span>
<p class="caption marginnote shownote">
FIGURE 1.8: Step 4: Replacing slip of paper.
</p>
<img src="07-one-parameter/images/4_put_it_back.png" alt="Step 4: Replacing slip of paper."  />
</div>
<p><strong>Step 5</strong>: Repeat Steps 3 and 4 a total of 49 more times, resulting in 50 recorded years.</p>
<p>What we just performed was a <em>resampling</em>  of the original sample of 50 pennies. We are not sampling 50 pennies from the population of all US pennies as we did in our trip to the bank. Instead, we are mimicking this act by resampling 50 pennies from our original sample of 50 pennies.</p>
<p>Now ask yourselves, why did we replace our resampled slip of paper back into the hat in Step 4? Because if we left the slip of paper out of the hat each time we performed Step 4, we would end up with the same 50 original pennies! In other words, replacing the slips of paper induces <em>sampling variation</em>.</p>
<p>Being more precise with our terminology, we just performed a <em>resampling with replacement</em> from the original sample of 50 pennies. Had we left the slip of paper out of the hat each time we performed Step 4, this would be <em>resampling without replacement</em>.</p>
<p>Let’s study our 50 resampled pennies via an exploratory data analysis. First, let’s load the data into R by manually creating a data frame <code>pennies_resample</code> of our 50 resampled values. We’ll do this using the <code>tibble()</code> command from the <strong>dplyr</strong> package. Note that the 50 values you resample will almost certainly not be the same as ours given the inherent randomness.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>pennies_resample &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="dt">year =</span> <span class="kw">c</span>(<span class="dv">1976</span>, <span class="dv">1962</span>, <span class="dv">1976</span>, <span class="dv">1983</span>, <span class="dv">2017</span>, <span class="dv">2015</span>, <span class="dv">2015</span>, <span class="dv">1962</span>, <span class="dv">2016</span>, <span class="dv">1976</span>, </span>
<span id="cb7-3"><a href="#cb7-3"></a>           <span class="dv">2006</span>, <span class="dv">1997</span>, <span class="dv">1988</span>, <span class="dv">2015</span>, <span class="dv">2015</span>, <span class="dv">1988</span>, <span class="dv">2016</span>, <span class="dv">1978</span>, <span class="dv">1979</span>, <span class="dv">1997</span>, </span>
<span id="cb7-4"><a href="#cb7-4"></a>           <span class="dv">1974</span>, <span class="dv">2013</span>, <span class="dv">1978</span>, <span class="dv">2015</span>, <span class="dv">2008</span>, <span class="dv">1982</span>, <span class="dv">1986</span>, <span class="dv">1979</span>, <span class="dv">1981</span>, <span class="dv">2004</span>, </span>
<span id="cb7-5"><a href="#cb7-5"></a>           <span class="dv">2000</span>, <span class="dv">1995</span>, <span class="dv">1999</span>, <span class="dv">2006</span>, <span class="dv">1979</span>, <span class="dv">2015</span>, <span class="dv">1979</span>, <span class="dv">1998</span>, <span class="dv">1981</span>, <span class="dv">2015</span>, </span>
<span id="cb7-6"><a href="#cb7-6"></a>           <span class="dv">2000</span>, <span class="dv">1999</span>, <span class="dv">1988</span>, <span class="dv">2017</span>, <span class="dv">1992</span>, <span class="dv">1997</span>, <span class="dv">1990</span>, <span class="dv">1988</span>, <span class="dv">2006</span>, <span class="dv">2000</span>)</span>
<span id="cb7-7"><a href="#cb7-7"></a>)</span></code></pre></div>
<p>The 50 values of <code>year</code> in <code>pennies_resample</code> represent a resample of size 50 from the original sample of 50 pennies. We display the 50 resampled pennies in Figure <a href="#fig:resampling-exercise-d"><strong>??</strong></a>.</p>
<div class="figure"><span id="fig:unnamed-chunk-15"></span>
<p class="caption marginnote shownote">
FIGURE 1.9: 50 resampled US pennies labelled.
</p>
<img src="07-one-parameter/images/4.jpg" alt="50 resampled US pennies labelled."  />
</div>
<p>Let’s compare the distribution of the numerical variable <code>year</code> of our 50 resampled pennies with the distribution of the numerical variable <code>year</code> of our original sample of 50 pennies in Figure <a href="#fig:origandresample"><strong>??</strong></a>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>pennies_resample <span class="op">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year)) <span class="op">+</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">10</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Resample of 50 pennies&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-6"><a href="#cb8-6"></a>pennies_sample <span class="op">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year)) <span class="op">+</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">10</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Original sample of 50 pennies&quot;</span>)</span></code></pre></div>

<pre><code>## Warning: Removed 3 rows containing missing values (geom_bar).</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_bar).</code></pre>
<div class="figure"><span id="fig:unnamed-chunk-17"></span>
<p class="caption marginnote shownote">
FIGURE 1.10: Comparing <code>year</code> in the resampled <code>pennies_resample</code> with the original sample <code>pennies_sample</code>.
</p>
<img src="07-one-parameter_files/figure-html/unnamed-chunk-17-1.png" alt="Comparing year in the resampled pennies_resample with the original sample pennies_sample." width="672"  />
</div>
<p>Observe in Figure <a href="#fig:origandresample"><strong>??</strong></a> that while the general shapes of both distributions of <code>year</code> are roughly similar, they are not identical.</p>
<p>Recall from the previous section that the sample mean of the original sample of 50 pennies from the bank was 1995.44. What about for our resample? Any guesses? Let’s have <strong>dplyr</strong> help us out as before:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>pennies_resample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_year =</span> <span class="kw">mean</span>(year))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   mean_year
##       &lt;dbl&gt;
## 1     2000.</code></pre>
<p>We obtained a different mean year of 1999.78. This variation is induced by the resampling <em>with replacement</em> we performed earlier.</p>
<p>What if we repeated this resampling exercise many times? Would we obtain the same mean <code>year</code> each time? In other words, would our guess at the mean year of all pennies in the US in 2019 be exactly 1999.78 every time? Just as we did in Chapter <a href="#sampling"><strong>??</strong></a>, let’s perform this resampling activity with the help of some of our friends: 35 friends in total.</p>
</div>
<div id="student-resamples" class="section level3">
<h3><span class="header-section-number">1.1.3</span> Resampling 35 times</h3>
<p>Each of our 35 friends will repeat the same five steps:</p>
<ol style="list-style-type: decimal">
<li>Start with 50 identically sized slips of paper representing the 50 pennies.</li>
<li>Put the 50 small pieces of paper into a hat or beanie cap.</li>
<li>Mix the hat’s contents and draw one slip of paper at random. Record the year in a spreadsheet.</li>
<li>Replace the slip of paper back in the hat!</li>
<li>Repeat Steps 3 and 4 a total of 49 more times, resulting in 50 recorded years.</li>
</ol>
<p>Since we had 35 of our friends perform this task, we will end up with <span class="math inline">\(35 \cdot 50 = 1750\)</span> values. These values are recorded in a <a href="https://docs.google.com/spreadsheets/d/1y3kOsU_wDrDd5eiJbEtLeHT9L5SvpZb_TrzwFBsouk0/">shared spreadsheet</a> with 50 rows (plus a header row) and 35 columns. We display a snapshot of the first 10 rows and five columns of this shared spreadsheet in Figure <a href="#fig:tactile-resampling-5"><strong>??</strong></a>.</p>
<div class="figure"><span id="fig:unnamed-chunk-20"></span>
<p class="caption marginnote shownote">
FIGURE 1.11: Snapshot of shared spreadsheet of resampled pennies.
</p>
<img src="07-one-parameter/images/5_shared_spreadsheet.png" alt="Snapshot of shared spreadsheet of resampled pennies."  />
</div>
<p>These 35 <span class="math inline">\(\cdot\)</span> 50 = 1750 values are saved in <code>pennies_resamples</code>, a “tidy” data frame included in the <strong>moderndive</strong> package. We saw what it means for a data frame to be “tidy” in Subsection <a href="#tidy-definition"><strong>??</strong></a>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>pennies_resamples</span></code></pre></div>
<pre><code>## # A tibble: 1,750 x 3
## # Groups:   name [35]
##    replicate name     year
##        &lt;int&gt; &lt;chr&gt;   &lt;dbl&gt;
##  1         1 Arianna  1988
##  2         1 Arianna  2002
##  3         1 Arianna  2015
##  4         1 Arianna  1998
##  5         1 Arianna  1979
##  6         1 Arianna  1971
##  7         1 Arianna  1971
##  8         1 Arianna  2015
##  9         1 Arianna  1988
## 10         1 Arianna  1979
## # … with 1,740 more rows</code></pre>
<p>What did each of our 35 friends obtain as the mean year? Once again, <strong>dplyr</strong> to the rescue! After grouping the rows by <code>name</code>, we summarize each group of 50 rows by their mean <code>year</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>resampled_means &lt;-<span class="st"> </span>pennies_resamples <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="st">  </span><span class="kw">group_by</span>(name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_year =</span> <span class="kw">mean</span>(year))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>resampled_means</span></code></pre></div>
<pre><code>## # A tibble: 35 x 2
##    name      mean_year
##    &lt;chr&gt;         &lt;dbl&gt;
##  1 Arianna       1992.
##  2 Artemis       1996.
##  3 Bea           1996.
##  4 Camryn        1997.
##  5 Cassandra     1991.
##  6 Cindy         1995.
##  7 Claire        1996.
##  8 Dahlia        1998.
##  9 Dan           1994.
## 10 Eindra        1994.
## # … with 25 more rows</code></pre>
<p>Observe that <code>resampled_means</code> has 35 rows corresponding to the 35 means based on the 35 resamples. Furthermore, observe the variation in the 35 values in the variable <code>mean_year</code>. Let’s visualize this variation using a histogram in Figure <a href="#fig:tactile-resampling-6"><strong>??</strong></a>. Recall that adding the argument <code>boundary = 1990</code> to the <code>geom_histogram()</code> sets the binning structure so that one of the bin boundaries is at 1990 exactly.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">ggplot</span>(resampled_means, <span class="kw">aes</span>(<span class="dt">x =</span> mean_year)) <span class="op">+</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">boundary =</span> <span class="dv">1990</span>) <span class="op">+</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Sampled mean year&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-23"></span>
<p class="caption marginnote shownote">
FIGURE 1.12: Distribution of 35 sample means from 35 resamples.
</p>
<img src="07-one-parameter_files/figure-html/unnamed-chunk-23-1.png" alt="Distribution of 35 sample means from 35 resamples." width="672"  />
</div>
<p>Observe in Figure <a href="#fig:tactile-resampling-6"><strong>??</strong></a> that the distribution looks roughly normal and that we rarely observe sample mean years less than 1992 or greater than 2000. Also observe how the distribution is roughly centered at 1995, which is close to the sample mean of 1995.44 of the <em>original sample</em> of 50 pennies from the bank.</p>
</div>
<div id="what-did-we-just-do" class="section level3">
<h3><span class="header-section-number">1.1.4</span> What did we just do?</h3>
<p>What we just demonstrated in this activity is the statistical procedure known as  <em>bootstrap resampling with replacement</em>. We used <em>resampling</em> to mimic the sampling variation we studied in Chapter <a href="#sampling"><strong>??</strong></a> on sampling. However, in this case, we did so using only a <em>single</em> sample from the population.</p>
<p>In fact, the histogram of sample means from 35 resamples in Figure <a href="#fig:tactile-resampling-6"><strong>??</strong></a> is called the  <em>bootstrap distribution</em>. It is an <em>approximation</em> to the <em>sampling distribution</em> of the sample mean, in the sense that both distributions will have a similar shape and similar spread. In fact in the upcoming Section <a href="#ci-conclusion">1.8</a>, we’ll show you that this is the case. Using this bootstrap distribution, we can study the effect of sampling variation on our estimates. In particular, we’ll study the typical “error” of our estimates, known as the  <em>standard error</em>.</p>
<p>Starting in Subsection <a href="#resampling-simulation">1.1.5</a>, we’ll mimic our tactile resampling activity virtually on the computer, allowing us to quickly perform the resampling many more than 35 times. In Section <a href="#ci-build-up">1.2</a> we’ll define the statistical concept of a <em>confidence interval</em>, which builds off the concept of bootstrap distributions.</p>
<p>As we did in Chapter <a href="#sampling"><strong>??</strong></a>, we’ll tie all these ideas together with a real-life case study in Section <a href="#case-study-two-prop-ci">1.7</a>. This time we’ll look at data from an experiment about yawning from the US television show <em>Mythbusters</em>.</p>
<p>Let’s now mimic our tactile resampling activity virtually with a computer.</p>
</div>
<div id="resampling-simulation" class="section level3">
<h3><span class="header-section-number">1.1.5</span> Virtually resampling once</h3>
<p>First, let’s perform the virtual analog of resampling once. Recall that the <code>pennies_sample</code> data frame included in the <strong>moderndive</strong> package contains the years of our original sample of 50 pennies from the bank. Furthermore, recall in Chapter <a href="#sampling"><strong>??</strong></a> on sampling that we used the <code>rep_sample_n()</code> function in the <strong>infer</strong> package as a virtual shovel to sample balls from our virtual urn of 2400 balls as follows:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">library</span>(infer)</span>
<span id="cb20-2"><a href="#cb20-2"></a></span>
<span id="cb20-3"><a href="#cb20-3"></a>virtual_shovel &lt;-<span class="st"> </span>urn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>)</span></code></pre></div>
<p>Let’s modify this code to perform the resampling with replacement of the 50 slips of paper representing our original sample of 50 pennies:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>virtual_resample &lt;-<span class="st"> </span>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>Observe how we explicitly set the <code>replace</code> argument to <code>TRUE</code> in order to tell <code>rep_sample_n()</code> that we would like to sample pennies  <em>with</em> replacement. Had we not set <code>replace = TRUE</code>, the function would’ve assumed the default value of <code>FALSE</code> and hence done resampling <em>without</em> replacement. Additionally, since we didn’t specify the number of replicates via the <code>reps</code> argument, the function assumes the default of one replicate <code>reps = 1</code>. Lastly, observe also that the <code>size</code> argument is set to match the original sample size of 50 pennies.</p>
<p>Let’s look at only the first 10 out of 50 rows of <code>virtual_resample</code>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>virtual_resample</span></code></pre></div>
<pre><code>## # A tibble: 50 x 3
## # Groups:   replicate [1]
##    replicate    ID  year
##        &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
##  1         1    39  2015
##  2         1    37  1962
##  3         1    13  2015
##  4         1    36  2015
##  5         1     4  1988
##  6         1     1  2002
##  7         1    12  1995
##  8         1    27  1993
##  9         1     5  2008
## 10         1    10  2000
## # … with 40 more rows</code></pre>
<p>The <code>replicate</code> variable only takes on the value of 1 corresponding to us only having <code>reps = 1</code>, the <code>ID</code> variable indicates which of the 50 pennies from <code>pennies_sample</code> was resampled, and <code>year</code> denotes the year of minting. Let’s now compute the mean <code>year</code> in our virtual resample of size 50 using data wrangling functions included in the <strong>dplyr</strong> package:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>virtual_resample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">resample_mean =</span> <span class="kw">mean</span>(year))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 1 x 2
##   replicate resample_mean
##       &lt;int&gt;         &lt;dbl&gt;
## 1         1         1998.</code></pre>
<p>As we saw when we did our tactile resampling exercise, the resulting mean year is different than the mean year of our 50 originally sampled pennies of 1995.44.</p>
<!-- 
Chester: Not sure if needed, but those trying to follow along may be mystified if we don't include this. 

Note that tibbles will try to print as pretty as possible which may result in numbers being rounded. In this chapter, we have set the default number of values to be printed to six in tibbles with `options(pillar.sigfig = 6)`.

Albert: We'll need to explain that command and why tidyverse opts for 3 sigfigs.
-->
</div>
<div id="bootstrap-35-replicates" class="section level3">
<h3><span class="header-section-number">1.1.6</span> Virtually resampling 35 times</h3>
<p>Let’s now perform the virtual analog of our 35 friends’ resampling. Using these results, we’ll be able to study the variability in the sample means from 35 resamples of size 50. Let’s first add a <code>reps = 35</code> argument to <code>rep_sample_n()</code>  to indicate we would like 35 replicates. Thus, we want to repeat the resampling with the replacement of 50 pennies 35 times.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>virtual_resamples &lt;-<span class="st"> </span>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">35</span>)</span>
<span id="cb27-3"><a href="#cb27-3"></a>virtual_resamples</span></code></pre></div>
<pre><code>## # A tibble: 1,750 x 3
## # Groups:   replicate [35]
##    replicate    ID  year
##        &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
##  1         1    33  1979
##  2         1    36  2015
##  3         1    46  2017
##  4         1     7  2008
##  5         1    12  1995
##  6         1    33  1979
##  7         1    20  1971
##  8         1    10  2000
##  9         1    28  2006
## 10         1    18  1996
## # … with 1,740 more rows</code></pre>
<p>The resulting <code>virtual_resamples</code> data frame has 35 <span class="math inline">\(\cdot\)</span> 50 = 1750 rows corresponding to 35 resamples of 50 pennies. Let’s now compute the resulting 35 sample means using the same <strong>dplyr</strong> code as we did in the previous section, but this time adding a <code>group_by(replicate)</code>:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>virtual_resampled_means &lt;-<span class="st"> </span>virtual_resamples <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_year =</span> <span class="kw">mean</span>(year))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>virtual_resampled_means</span></code></pre></div>
<pre><code>## # A tibble: 35 x 2
##    replicate mean_year
##        &lt;int&gt;     &lt;dbl&gt;
##  1         1     1996.
##  2         2     1995.
##  3         3     1990.
##  4         4     1996.
##  5         5     1997.
##  6         6     1994.
##  7         7     1998.
##  8         8     1993.
##  9         9     1999.
## 10        10     1993.
## # … with 25 more rows</code></pre>
<p>Observe that <code>virtual_resampled_means</code> has 35 rows, corresponding to the 35 resampled means. Furthermore, observe that the values of <code>mean_year</code> vary. Let’s visualize this variation using a histogram in Figure <a href="#fig:tactile-resampling-7"><strong>??</strong></a>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">ggplot</span>(virtual_resampled_means, <span class="kw">aes</span>(<span class="dt">x =</span> mean_year)) <span class="op">+</span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">boundary =</span> <span class="dv">1990</span>) <span class="op">+</span></span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Resample mean year&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-32"></span>
<p class="caption marginnote shownote">
FIGURE 1.13: Distribution of 35 sample means from 35 resamples.
</p>
<img src="07-one-parameter_files/figure-html/unnamed-chunk-32-1.png" alt="Distribution of 35 sample means from 35 resamples." width="672"  />
</div>
<p>Let’s compare our virtually constructed bootstrap distribution with the one our 35 friends constructed via our tactile resampling exercise in Figure <a href="#fig:orig-and-resample-means"><strong>??</strong></a>. Observe how they are somewhat similar, but not identical.</p>
<div class="figure"><span id="fig:unnamed-chunk-33"></span>
<p class="caption marginnote shownote">
FIGURE 1.14: Comparing distributions of means from resamples.
</p>
<img src="07-one-parameter_files/figure-html/unnamed-chunk-33-1.png" alt="Comparing distributions of means from resamples." width="672"  />
</div>
<p>Recall that in the “resampling with replacement” scenario we are illustrating here, both of these histograms have a special name: the <em>bootstrap distribution of the sample mean</em>. Furthermore, recall they are an approximation to the <em>sampling distribution</em> of the sample mean, a concept you saw in Chapter <a href="#sampling"><strong>??</strong></a> on sampling. These distributions allow us to study the effect of sampling variation on our estimates of the true population mean, in this case the true mean year for <em>all</em> US pennies. However, unlike in Chapter <a href="#sampling"><strong>??</strong></a> where we took multiple samples (something one would never do in practice), bootstrap distributions are constructed by taking multiple resamples from a <em>single</em> sample: in this case, the 50 original pennies from the bank.</p>
</div>
<div id="bootstrap-1000-replicates" class="section level3">
<h3><span class="header-section-number">1.1.7</span> Virtually resampling 1,000 times</h3>
<p>Remember that one of the goals of resampling with replacement is to construct the bootstrap distribution, which is an approximation of the sampling distribution. However, the bootstrap distribution in Figure <a href="#fig:tactile-resampling-7"><strong>??</strong></a> is based only on 35 resamples and hence looks a little coarse. Let’s increase the number of resamples to 1,000, so that we can hopefully better see the shape and the variability between different resamples.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># Repeat resampling 1,000 times</span></span>
<span id="cb34-2"><a href="#cb34-2"></a></span>
<span id="cb34-3"><a href="#cb34-3"></a>virtual_resamples &lt;-<span class="st"> </span>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">1000</span>)</span>
<span id="cb34-5"><a href="#cb34-5"></a></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="co"># Compute 1,000 sample means</span></span>
<span id="cb34-7"><a href="#cb34-7"></a></span>
<span id="cb34-8"><a href="#cb34-8"></a>virtual_resampled_means &lt;-<span class="st"> </span>virtual_resamples <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb34-9"><a href="#cb34-9"></a><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb34-10"><a href="#cb34-10"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_year =</span> <span class="kw">mean</span>(year))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<p>However, in the interest of brevity, going forward let’s combine these two operations into a single chain of pipe (<code>%&gt;%</code>) operators:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>virtual_resampled_means &lt;-<span class="st"> </span>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_year =</span> <span class="kw">mean</span>(year))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>virtual_resampled_means</span></code></pre></div>
<pre><code>## # A tibble: 1,000 x 2
##    replicate mean_year
##        &lt;int&gt;     &lt;dbl&gt;
##  1         1     1993.
##  2         2     1996.
##  3         3     1993.
##  4         4     1992.
##  5         5     1995.
##  6         6     1999.
##  7         7     1995.
##  8         8     1992.
##  9         9     1992.
## 10        10     1998.
## # … with 990 more rows</code></pre>
<p>In Figure <a href="#fig:one-thousand-sample-means"><strong>??</strong></a> let’s visualize the bootstrap distribution of these 1,000 means based on 1,000 virtual resamples:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>virtual_resampled_means <span class="op">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> mean_year)) <span class="op">+</span></span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">boundary =</span> <span class="dv">1990</span>) <span class="op">+</span></span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;sample mean&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-36"></span>
<p class="caption marginnote shownote">
FIGURE 1.15: Bootstrap resampling distribution based on 1000 resamples.
</p>
<img src="07-one-parameter_files/figure-html/unnamed-chunk-36-1.png" alt="Bootstrap resampling distribution based on 1000 resamples." width="672"  />
</div>
<p>Note here that the bell shape is starting to become much more apparent. We now have a general sense for the range of values that the sample mean may take on. But where is this histogram centered? Let’s compute the mean of the 1,000 resample means:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>virtual_resampled_means <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_of_means =</span> <span class="kw">mean</span>(mean_year))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   mean_of_means
##           &lt;dbl&gt;
## 1         1996.</code></pre>
<p>The mean of these 1,000 means is 1995.51, which is quite close to the mean of our original sample of 50 pennies of 1995.44. This is the case since each of the 1,000 resamples is based on the original sample of 50 pennies.</p>
<p>Congratulations! You’ve just constructed your first bootstrap distribution! In the next section, you’ll see how to use this bootstrap distribution to construct <em>confidence intervals</em>.</p>
</div>
</div>
<div id="ci-build-up" class="section level2">
<h2><span class="header-section-number">1.2</span> Measuring uncertainty with confidence intervals</h2>
<p>Let’s start this section with an analogy involving fishing. Say you are trying to catch a fish. On the one hand, you could use a spear, while on the other you could use a net. Using the net will probably allow you to catch more fish!</p>
<p>Now think back to our pennies exercise where you are trying to estimate the true population mean year <span class="math inline">\(\mu\)</span> of <em>all</em> US pennies.  Think of the value of <span class="math inline">\(\mu\)</span> as a fish.</p>
<p>On the one hand, we could use the appropriate <em>point estimate/sample statistic</em> to estimate <span class="math inline">\(\mu\)</span>, which we saw in Table <a href="#tab:table-ch8-b"><strong>??</strong></a> is the sample mean <span class="math inline">\(\overline{x}\)</span>. Based on our sample of 50 pennies from the bank, the sample mean was 1995.44. Think of using this value as “fishing with a spear.”</p>
<p>What would “fishing with a net” correspond to? Look at the bootstrap distribution in Figure <a href="#fig:one-thousand-sample-means"><strong>??</strong></a> once more. Between which two years would you say that “most” sample means lie? While this question is somewhat subjective, saying that most sample means lie between 1992 and 2000 would not be unreasonable. Think of this interval as the “net.”</p>
<p>What we’ve just illustrated is the concept of a <em>confidence interval</em>, which we’ll abbreviate with “CI” throughout this book. As opposed to a point estimate/sample statistic that estimates the value of an unknown population parameter with a single value, a <em>confidence interval</em>  gives what can be interpreted as a range of plausible values. Going back to our analogy, point estimates/sample statistics can be thought of as spears, whereas confidence intervals can be thought of as nets.</p>
<!--
Point estimate           |  Confidence interval
:-------------------------:|:-------------------------:
![](images/shutterstock/shutterstock_149730074_cropped.jpg){ height=2.5in } |  ![](images/shutterstock/shutterstock_176684936.jpg){ height=2.5in }
-->
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-39"></span>
<p class="caption marginnote shownote">
FIGURE 1.16: Analogy of difference between point estimates and confidence intervals.
</p>
<img src="07-one-parameter/images/point_estimate_vs_conf_int.png" alt="Analogy of difference between point estimates and confidence intervals."  />
</div>
<p>Our proposed interval of 1992 to 2000 was constructed by eye and was thus somewhat subjective. We now introduce two methods for constructing such intervals in a more exact fashion: the <em>percentile method</em> and the <em>standard error method</em>.</p>
<p>Both methods for confidence interval construction share some commonalities. First, they are both constructed from a bootstrap distribution, as you constructed in Subsection <a href="#bootstrap-1000-replicates">1.1.7</a> and visualized in Figure <a href="#fig:one-thousand-sample-means"><strong>??</strong></a>.</p>
<p>Second, they both require you to specify the  <em>confidence level</em>. Commonly used confidence levels include 90%, 95%, and 99%. All other things being equal, higher confidence levels correspond to wider confidence intervals, and lower confidence levels correspond to narrower confidence intervals. In this book, we’ll be mostly using 95% and hence constructing “95% confidence intervals for <span class="math inline">\(\mu\)</span>” for our pennies activity.</p>
<div id="percentile-method" class="section level3">
<h3><span class="header-section-number">1.2.1</span> Percentile method</h3>
<p>One method to construct a confidence interval is to use the middle 95% of values of the bootstrap distribution. We can do this by computing the 2.5th and 97.5th percentiles, which are 1991.2 and 1999.741, respectively. This is known as the <em>percentile method</em> for constructing confidence intervals. You can get these values using the <code>quantile()</code> function on the <code>mean_year</code> column of <code>virtual_resampled_means</code>:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>virtual_resampled_means <span class="op">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="st">  </span><span class="kw">pull</span>(mean_year) <span class="op">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="st">  </span><span class="kw">quantile</span>(<span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##     2.5%    97.5% 
## 1991.200 1999.741</code></pre>
<p>Let’s mark these percentiles on the bootstrap distribution with vertical lines in Figure <a href="#fig:percentile-method"><strong>??</strong></a>. About 95% of the <code>mean_year</code> variable values in <code>virtual_resampled_means</code> fall between 1991.2 and 1999.741, with 2.5% to the left of the leftmost line and 2.5% to the right of the rightmost line.</p>

<div class="figure"><span id="fig:unnamed-chunk-42"></span>
<p class="caption marginnote shownote">
FIGURE 1.17: Percentile method 95% confidence interval. Interval endpoints marked by vertical lines.
</p>
<img src="07-one-parameter_files/figure-html/unnamed-chunk-42-1.png" alt="Percentile method 95% confidence interval. Interval endpoints marked by vertical lines." width="672"  />
</div>
</div>
<div id="se-method" class="section level3">
<h3><span class="header-section-number">1.2.2</span> Standard error method</h3>
<p>If a numerical variable follows a normal distribution, or, in other words, the histogram of this variable is bell-shaped, then roughly 95% of values fall between <span class="math inline">\(\pm\)</span> 1.96 standard deviations of the mean. Given that our bootstrap distribution based on 1,000 resamples with replacement in Figure <a href="#fig:one-thousand-sample-means"><strong>??</strong></a> is normally shaped, let’s use this fact about normal distributions to construct a confidence interval in a different way.</p>
<p>First, recall the bootstrap distribution has a mean equal to 1995.51. This value almost coincides exactly with the value of the sample mean <span class="math inline">\(\overline{x}\)</span> of our original 50 pennies of 1995.44. Second, let’s compute the standard deviation of the bootstrap distribution using the values of <code>mean_year</code> in the <code>virtual_resampled_means</code> data frame:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>virtual_resampled_means <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">SE =</span> <span class="kw">sd</span>(mean_year))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##      SE
##   &lt;dbl&gt;
## 1  2.18</code></pre>
<p>What is this value? Recall that the bootstrap distribution is an approximation to the sampling distribution. Recall also that the standard deviation of a sampling distribution has a special name: the <em>standard error</em>. Putting these two facts together, we can say that 2.17868 is an approximation of the standard error of <span class="math inline">\(\overline{x}\)</span>.</p>
<p>Thus, using our 95% rule of thumb about normal distributions, we can use the following formula to determine the lower and upper endpoints of a 95% confidence interval for <span class="math inline">\(\mu\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\overline{x} \pm 1.96 \cdot SE &amp;= (\overline{x} - 1.96 \cdot SE, \overline{x} + 1.96 \cdot SE)\\
&amp;= (1995.44 - 1.96 \cdot 2.18, 1995.44 + 1.96 \cdot 2.18)\\
&amp;= (1991.15, 1999.73)
\end{aligned}
\]</span></p>
<p>Let’s now add the SE method confidence interval with dashed lines in Figure <a href="#fig:percentile-and-se-method"><strong>??</strong></a>.</p>

<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<div class="figure"><span id="fig:unnamed-chunk-45"></span>
<p class="caption marginnote shownote">
FIGURE 1.18: Comparing two 95% confidence interval methods.
</p>
<img src="07-one-parameter_files/figure-html/unnamed-chunk-45-1.png" alt="Comparing two 95% confidence interval methods." width="672"  />
</div>
<p>We see that both methods produce nearly identical 95% confidence intervals for <span class="math inline">\(\mu\)</span> with the percentile method yielding <span class="math inline">\((1991.2, 1999.74)\)</span> while the standard error method produces <span class="math inline">\((1991.17, 1999.71)\)</span>. Thus, the standard error method can be a good quick way to construct confidence intervals when you already have an estimate of the standard error and don’t want to go through the steps to obtain a confidence interval by the percentile method. It is particularly handy since <span class="math inline">\(1.96 \approx 2\)</span>, and thus it is easy to calculate in one’s head. However, recall that we can only use the standard error rule when the bootstrap distribution is roughly normally shaped. If you have an unusually shaped distribution, it is better to use the percentile method.</p>
</div>
<div id="one-prop-ci" class="section level3">
<h3><span class="header-section-number">1.2.3</span> Interpreting confidence intervals</h3>
<p>Now that we’ve shown you how to construct confidence intervals using a sample drawn from a population, let’s now focus on how to interpret them.</p>
<p>The traditional approach is referred to as either “Frequentist” or “Classical.” In this interpretation, 95% of the time that you perform this exercise, the <em>intervals</em> constructed will contain the true but unknown population parameter. You are making a claim about how well this approach — bootstrap resampling — works if you do it many, many times. You do not know anything about how well it worked this time.</p>
<p>In this book, we use a “Bayesian” interpretation. There is a true, but unknown, average year of minting for all the pennies in the world. In theory, we could find all those pennies and then calculate this number. The Bayesian interpretation of a 95% confidence interval is that we are 95% certain that the true value is within the CI limits. It would be a fair wager to bet, at 19:1 odds, that the true value is outside those limits because there is a 5% chance that it is.</p>
<p>Note that these are just <em>interpretations</em>. The reality of what we did is the same in both cases. The computer code is the same. This Bayesian interpretation of the bootstrap confidence interval is often called a <a href="https://en.wikipedia.org/wiki/Credible_interval">credible interval</a> in the academic literature. You may find yourself in a statistics class that uses the phrase “confidence interval” to refer only to the <a href="https://en.wikipedia.org/wiki/Frequentist_inference">frequentist</a> concept.</p>
<p>Does our percentile-based confidence interval of (1991.2, 1999.74) “capture” the true mean year <span class="math inline">\(\mu\)</span> of <em>all</em> US pennies? Alas, we’ll never know, because we don’t know what the true value of <span class="math inline">\(\mu\)</span> is. After all, we’re sampling to estimate it!</p>
<p>However, we can answer a different question. Given that we’ve observed the 50 pennies that we did, what’s the <em>chance</em> that the true value falls within (1991.2, 1999.74)? If the answer is 95%, then we can call this a 95% interval.</p>
<p>This is a statement about <em>probability</em>. We thus can think of the mean year of the pennies as a random variable that has its own <em>probability distribution</em>. Of course, we don’t know exactly what that distribution is. The bootstrap resampling procedure, however, generates a distribution of values for the mean. Since the bootstrap distribution is a good approximation of the <em>sampling</em> distribution we learned about in the last chapter (see Subsection <a href="#bootstrap-vs-sampling">1.8.1</a>), this is a reasonable thing to do. Then, if we take the bootstrap distribution as our “best guess” of the probability distribution of the variable we are interested in, we can guess that the variable has a 95% chance of lying between the 2.5th and 97.5th percentiles of the bootstrap distribution.</p>
<!-- AR: took this language from the regression chapter.  Maybe OK to repeat it
-->
<p>Instead of looking at confidence intervals, a common alternative approach is to conduct <em>hypothesis tests</em>, where one hypothesis is called the “null hypothesis” (often that a value, such as a mean, is equal to zero) and the result of the test is either <em>rejecting</em> the null hypothesis (so you’d conclude that the mean is not zero) or <em>failing to reject</em> the null hypothesis. The decision whether to reject the null hypothesis is generally made with reference to a <em>p-value</em>, a measure of how likely one would be, if the null hypothesis were true, to observe results at least as extreme as the results actually observed. A <em>p</em>-value cutoff, often 0.05, is employed: if the <em>p</em>-value is lower, the null hypothesis is rejected, otherwise the hypothesis is not rejected.</p>
<p>We think this is a bad way to make decisions. Two very similar datasets could produce <em>p</em>-values of <span class="math inline">\(p = 0.04\)</span> and <span class="math inline">\(p = 0.06\)</span> for a quantity of interest. If you would make one decision in the former case and a totally different decision in the latter case, then there’s something wrong with your decision-making process! Rather, we think it is more sensible to look at the data, construct models to summarize important features of the data, and make decisions based on those models that take into account the uncertainty in the models’ estimates.</p>
<!-- The above is not bad, but we need more, more, more. Every chapter should repeat this and provide examples. Maybe, each chapter, we need a specific example of the stupidity of NHST. (And maybe an actual decision problem.) And then show how a model summary helps us. -->
</div>
</div>
<div id="ci-width" class="section level2">
<h2><span class="header-section-number">1.3</span> Width of confidence intervals</h2>
<p>Now that we know how to interpret confidence intervals, let’s go over some factors that determine their width.</p>
<div id="impact-of-confidence-level" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Impact of confidence level</h3>
<p>One factor that determines confidence interval widths is the pre-specified <em>confidence level</em>. The quantification of the confidence level should match what many expect of the word “confident.” In order to be more confident in our best guess of a range of values, we need to widen the range of values.</p>
<p>Imagine we want to forecast the high temperature in Seoul, South Korea on August 15th. Given Seoul’s temperate climate with four distinct seasons, we could say somewhat confidently that the high temperature would be between 50°F - 95°F (10°C - 35°C). However, if we wanted a temperature range we were <em>absolutely</em> confident about, we would need to widen it.</p>
<p>We need this wider range to allow for the possibility of anomalous weather, like a freak cold spell or an extreme heat wave. So a range of temperatures we could be near certain about would be between 32°F - 110°F (0°C - 43°C). On the other hand, if we could tolerate being a little less confident, we could narrow this range to between 70°F - 85°F (21°C - 30°C).</p>
<!-- DK: Is it a good idea to go back to the urn example here? Why not just stick with pennies? Or perhaps it is important to connect the previous chapter to this one, to see how our new knowledge of confidence intervals applies in the urn case. Even if we do keep it, this part definitely goes much too fast. First, remind people about the urn. Then, do one sample and show how we can build a confidence interval from that, at a given confidence level. Then show how we build it for different confidence levels. Then do it 10 times for each confidence level. Or something like that. -->
<p>Let’s revisit our sampling urn from Chapter <a href="#sampling"><strong>??</strong></a>. Let’s compare <span class="math inline">\(10 \cdot 3 = 30\)</span> confidence intervals for <span class="math inline">\(p\)</span> based on three different confidence levels: 80%, 95%, and 99%.</p>
<p>Specifically, we’ll first take 30 different random samples of size <span class="math inline">\(n = 50\)</span> balls from the urn. Then we’ll construct ten percentile-based confidence intervals using each of the three different confidence levels.</p>
<p>Finally, we’ll compare the widths of these intervals.</p>
<p>We’ll start by walking through the process for the 80% confidence intervals. We begin by taking 10 random samples from the urn of size <span class="math inline">\(n = 50\)</span>:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="kw">set.seed</span>(<span class="dv">9</span>)</span>
<span id="cb48-2"><a href="#cb48-2"></a></span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="co"># Compute 80% confidence intervals</span></span>
<span id="cb48-4"><a href="#cb48-4"></a></span>
<span id="cb48-5"><a href="#cb48-5"></a><span class="co"># Get 10 random samples</span></span>
<span id="cb48-6"><a href="#cb48-6"></a></span>
<span id="cb48-7"><a href="#cb48-7"></a>perc_cis_<span class="dv">80</span> &lt;-<span class="st"> </span>urn <span class="op">%&gt;%</span></span>
<span id="cb48-8"><a href="#cb48-8"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">reps =</span> <span class="dv">10</span>)</span>
<span id="cb48-9"><a href="#cb48-9"></a>perc_cis_<span class="dv">80</span></span></code></pre></div>
<pre><code>## # A tibble: 500 x 3
## # Groups:   replicate [10]
##    replicate ball_ID color
##        &lt;int&gt;   &lt;int&gt; &lt;chr&gt;
##  1         1    2235 red  
##  2         1    1589 white
##  3         1    1286 white
##  4         1    1851 white
##  5         1     408 red  
##  6         1     595 red  
##  7         1    1027 red  
##  8         1     556 red  
##  9         1     549 white
## 10         1      42 red  
## # … with 490 more rows</code></pre>
<!-- DK: Is this the first time we are using nest? If so, it is going way too fast! -->
<p>Next, we’ll construct a confidence interval for each one. This will require <code>nest</code>ing the data by sample and then <code>map</code>ping to construct each confidence interval. Let’s grab 1,000 bootstrap replicates for each sample:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>perc_cis_<span class="dv">80</span> &lt;-<span class="st"> </span>perc_cis_<span class="dv">80</span> <span class="op">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="st">  </span></span>
<span id="cb50-3"><a href="#cb50-3"></a><span class="st">  </span><span class="co"># For each one, construct a CI</span></span>
<span id="cb50-4"><a href="#cb50-4"></a><span class="st">  </span></span>
<span id="cb50-5"><a href="#cb50-5"></a><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span></span>
<span id="cb50-6"><a href="#cb50-6"></a><span class="st">  </span><span class="kw">nest</span>() <span class="op">%&gt;%</span></span>
<span id="cb50-7"><a href="#cb50-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">boots =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="st"> </span><span class="kw">rep_sample_n</span>(., <span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">1000</span>)))</span>
<span id="cb50-8"><a href="#cb50-8"></a></span>
<span id="cb50-9"><a href="#cb50-9"></a>perc_cis_<span class="dv">80</span></span></code></pre></div>
<pre><code>## # A tibble: 10 x 3
## # Groups:   replicate [10]
##    replicate data              boots                
##        &lt;int&gt; &lt;list&gt;            &lt;list&gt;               
##  1         1 &lt;tibble [50 × 2]&gt; &lt;tibble [50,000 × 3]&gt;
##  2         2 &lt;tibble [50 × 2]&gt; &lt;tibble [50,000 × 3]&gt;
##  3         3 &lt;tibble [50 × 2]&gt; &lt;tibble [50,000 × 3]&gt;
##  4         4 &lt;tibble [50 × 2]&gt; &lt;tibble [50,000 × 3]&gt;
##  5         5 &lt;tibble [50 × 2]&gt; &lt;tibble [50,000 × 3]&gt;
##  6         6 &lt;tibble [50 × 2]&gt; &lt;tibble [50,000 × 3]&gt;
##  7         7 &lt;tibble [50 × 2]&gt; &lt;tibble [50,000 × 3]&gt;
##  8         8 &lt;tibble [50 × 2]&gt; &lt;tibble [50,000 × 3]&gt;
##  9         9 &lt;tibble [50 × 2]&gt; &lt;tibble [50,000 × 3]&gt;
## 10        10 &lt;tibble [50 × 2]&gt; &lt;tibble [50,000 × 3]&gt;</code></pre>
<!-- DK: Need to make variable name choice, like `boots` more consistent across chapters. Wouldn't `data` be better? Also, the next chunk of code is very confusing! Isn't there an easier way? We do something like this in each of the next few chapters. Worth getting right! -->
<p>Now that we have a list column called <code>boots</code> for each of our original 10 samples, we can now get 1,000 estimates per sample of <code>prop_red</code> from the bootstrap:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>perc_cis_<span class="dv">80</span> &lt;-<span class="st"> </span>perc_cis_<span class="dv">80</span> <span class="op">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop_red_results =</span> <span class="kw">map</span>(boots, <span class="op">~</span><span class="st"> </span><span class="kw">group_by</span>(., replicate) <span class="op">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="st">                                            </span><span class="kw">summarize</span>(<span class="dt">prop_red =</span> <span class="kw">mean</span>(color <span class="op">==</span><span class="st"> &quot;red&quot;</span>))),</span>
<span id="cb52-4"><a href="#cb52-4"></a>         <span class="dt">prop_red =</span> <span class="kw">map</span>(prop_red_results, <span class="op">~</span><span class="st"> </span><span class="kw">pull</span>(., prop_red)))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>perc_cis_<span class="dv">80</span></span></code></pre></div>
<pre><code>## # A tibble: 10 x 5
## # Groups:   replicate [10]
##    replicate data            boots              prop_red_results    prop_red    
##        &lt;int&gt; &lt;list&gt;          &lt;list&gt;             &lt;list&gt;              &lt;list&gt;      
##  1         1 &lt;tibble [50 × … &lt;tibble [50,000 ×… &lt;tibble [1,000 × 2… &lt;dbl [1,000…
##  2         2 &lt;tibble [50 × … &lt;tibble [50,000 ×… &lt;tibble [1,000 × 2… &lt;dbl [1,000…
##  3         3 &lt;tibble [50 × … &lt;tibble [50,000 ×… &lt;tibble [1,000 × 2… &lt;dbl [1,000…
##  4         4 &lt;tibble [50 × … &lt;tibble [50,000 ×… &lt;tibble [1,000 × 2… &lt;dbl [1,000…
##  5         5 &lt;tibble [50 × … &lt;tibble [50,000 ×… &lt;tibble [1,000 × 2… &lt;dbl [1,000…
##  6         6 &lt;tibble [50 × … &lt;tibble [50,000 ×… &lt;tibble [1,000 × 2… &lt;dbl [1,000…
##  7         7 &lt;tibble [50 × … &lt;tibble [50,000 ×… &lt;tibble [1,000 × 2… &lt;dbl [1,000…
##  8         8 &lt;tibble [50 × … &lt;tibble [50,000 ×… &lt;tibble [1,000 × 2… &lt;dbl [1,000…
##  9         9 &lt;tibble [50 × … &lt;tibble [50,000 ×… &lt;tibble [1,000 × 2… &lt;dbl [1,000…
## 10        10 &lt;tibble [50 × … &lt;tibble [50,000 ×… &lt;tibble [1,000 × 2… &lt;dbl [1,000…</code></pre>
<p>Finally, we will use the list column <code>prop_red</code> to get the lower and upper bounds of our confidence intervals and note the level of confidence we used:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>perc_cis_<span class="dv">80</span> &lt;-<span class="st"> </span>perc_cis_<span class="dv">80</span> <span class="op">%&gt;%</span></span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">lower =</span> <span class="kw">map_dbl</span>(prop_red, <span class="op">~</span><span class="st"> </span><span class="kw">quantile</span>(., <span class="dt">probs =</span> <span class="fl">0.1</span>)),</span>
<span id="cb56-3"><a href="#cb56-3"></a>         <span class="dt">upper =</span> <span class="kw">map_dbl</span>(prop_red, <span class="op">~</span><span class="st"> </span><span class="kw">quantile</span>(., <span class="dt">probs =</span> <span class="fl">0.9</span>)),</span>
<span id="cb56-4"><a href="#cb56-4"></a>         <span class="dt">confidence_level =</span> <span class="st">&quot;80%&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb56-5"><a href="#cb56-5"></a><span class="st">  </span><span class="kw">select</span>(replicate, lower, upper, confidence_level)</span>
<span id="cb56-6"><a href="#cb56-6"></a>perc_cis_<span class="dv">80</span></span></code></pre></div>
<pre><code>## # A tibble: 10 x 4
## # Groups:   replicate [10]
##    replicate lower upper confidence_level
##        &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;           
##  1         1  0.36  0.54 80%             
##  2         2  0.3   0.48 80%             
##  3         3  0.22  0.38 80%             
##  4         4  0.26  0.42 80%             
##  5         5  0.32  0.5  80%             
##  6         6  0.3   0.5  80%             
##  7         7  0.32  0.5  80%             
##  8         8  0.32  0.48 80%             
##  9         9  0.32  0.48 80%             
## 10        10  0.26  0.42 80%</code></pre>
<p>Now we can do the same for the 95% and 99% confidence intervals:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="co"># Compute 95% confidence intervals</span></span>
<span id="cb58-2"><a href="#cb58-2"></a></span>
<span id="cb58-3"><a href="#cb58-3"></a><span class="co"># Get 10 random samples</span></span>
<span id="cb58-4"><a href="#cb58-4"></a></span>
<span id="cb58-5"><a href="#cb58-5"></a>perc_cis_<span class="dv">95</span> &lt;-<span class="st"> </span>urn <span class="op">%&gt;%</span></span>
<span id="cb58-6"><a href="#cb58-6"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">reps =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span></span>
<span id="cb58-7"><a href="#cb58-7"></a><span class="st">  </span></span>
<span id="cb58-8"><a href="#cb58-8"></a><span class="st">  </span><span class="co"># For each one, construct a CI</span></span>
<span id="cb58-9"><a href="#cb58-9"></a><span class="st">  </span></span>
<span id="cb58-10"><a href="#cb58-10"></a><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span></span>
<span id="cb58-11"><a href="#cb58-11"></a><span class="st">  </span><span class="kw">nest</span>() <span class="op">%&gt;%</span></span>
<span id="cb58-12"><a href="#cb58-12"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">boots =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="st"> </span><span class="kw">rep_sample_n</span>(., <span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">1000</span>)),</span>
<span id="cb58-13"><a href="#cb58-13"></a>         <span class="dt">prop_red_results =</span> <span class="kw">map</span>(boots, <span class="op">~</span><span class="st"> </span><span class="kw">group_by</span>(., replicate) <span class="op">%&gt;%</span></span>
<span id="cb58-14"><a href="#cb58-14"></a><span class="st">                                  </span><span class="kw">summarize</span>(<span class="dt">prop_red =</span> <span class="kw">mean</span>(color <span class="op">==</span><span class="st"> &quot;red&quot;</span>))),</span>
<span id="cb58-15"><a href="#cb58-15"></a>         <span class="dt">prop_red =</span> <span class="kw">map</span>(prop_red_results, <span class="op">~</span><span class="st"> </span><span class="kw">pull</span>(., prop_red)),</span>
<span id="cb58-16"><a href="#cb58-16"></a>         <span class="dt">lower =</span> <span class="kw">map_dbl</span>(prop_red, <span class="op">~</span><span class="st"> </span><span class="kw">quantile</span>(., <span class="dt">probs =</span> <span class="fl">0.025</span>)),</span>
<span id="cb58-17"><a href="#cb58-17"></a>         <span class="dt">upper =</span> <span class="kw">map_dbl</span>(prop_red, <span class="op">~</span><span class="st"> </span><span class="kw">quantile</span>(., <span class="dt">probs =</span> <span class="fl">0.975</span>)),</span>
<span id="cb58-18"><a href="#cb58-18"></a>         <span class="dt">confidence_level =</span> <span class="st">&quot;95%&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb58-19"><a href="#cb58-19"></a><span class="st">  </span><span class="kw">select</span>(replicate, lower, upper, confidence_level)</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="co"># Compute 99% confidence intervals</span></span>
<span id="cb60-2"><a href="#cb60-2"></a></span>
<span id="cb60-3"><a href="#cb60-3"></a><span class="co"># Get 10 random samples</span></span>
<span id="cb60-4"><a href="#cb60-4"></a></span>
<span id="cb60-5"><a href="#cb60-5"></a>perc_cis_<span class="dv">99</span> &lt;-<span class="st"> </span>urn <span class="op">%&gt;%</span></span>
<span id="cb60-6"><a href="#cb60-6"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">reps =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span></span>
<span id="cb60-7"><a href="#cb60-7"></a><span class="st">  </span></span>
<span id="cb60-8"><a href="#cb60-8"></a><span class="st">  </span><span class="co"># For each one, construct a CI</span></span>
<span id="cb60-9"><a href="#cb60-9"></a><span class="st">  </span></span>
<span id="cb60-10"><a href="#cb60-10"></a><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span></span>
<span id="cb60-11"><a href="#cb60-11"></a><span class="st">  </span><span class="kw">nest</span>() <span class="op">%&gt;%</span></span>
<span id="cb60-12"><a href="#cb60-12"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">boots =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="st"> </span><span class="kw">rep_sample_n</span>(., <span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">1000</span>)),</span>
<span id="cb60-13"><a href="#cb60-13"></a>         <span class="dt">prop_red_results =</span> <span class="kw">map</span>(boots, <span class="op">~</span><span class="st"> </span><span class="kw">group_by</span>(., replicate) <span class="op">%&gt;%</span></span>
<span id="cb60-14"><a href="#cb60-14"></a><span class="st">                                  </span><span class="kw">summarize</span>(<span class="dt">prop_red =</span> <span class="kw">mean</span>(color <span class="op">==</span><span class="st"> &quot;red&quot;</span>))),</span>
<span id="cb60-15"><a href="#cb60-15"></a>         <span class="dt">prop_red =</span> <span class="kw">map</span>(prop_red_results, <span class="op">~</span><span class="st"> </span><span class="kw">pull</span>(., prop_red)),</span>
<span id="cb60-16"><a href="#cb60-16"></a>         <span class="dt">lower =</span> <span class="kw">map_dbl</span>(prop_red, <span class="op">~</span><span class="st"> </span><span class="kw">quantile</span>(., <span class="dt">probs =</span> <span class="fl">0.005</span>)),</span>
<span id="cb60-17"><a href="#cb60-17"></a>         <span class="dt">upper =</span> <span class="kw">map_dbl</span>(prop_red, <span class="op">~</span><span class="st"> </span><span class="kw">quantile</span>(., <span class="dt">probs =</span> <span class="fl">0.995</span>)),</span>
<span id="cb60-18"><a href="#cb60-18"></a>         <span class="dt">confidence_level =</span> <span class="st">&quot;99%&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb60-19"><a href="#cb60-19"></a><span class="st">  </span><span class="kw">select</span>(replicate, lower, upper, confidence_level)</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="co"># Combine into single data frame</span></span>
<span id="cb62-2"><a href="#cb62-2"></a></span>
<span id="cb62-3"><a href="#cb62-3"></a>percentile_cis_by_level &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(perc_cis_<span class="dv">80</span>, perc_cis_<span class="dv">95</span>, perc_cis_<span class="dv">99</span>)</span></code></pre></div>
<p>Observe that as the confidence level increases from 80% to 95% to 99%, the confidence intervals tend to get wider as seen in Table <a href="#tab:perc-cis-average-width"><strong>??</strong></a> where we compare their average widths.</p>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ehobpdhpip .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ehobpdhpip .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ehobpdhpip .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ehobpdhpip .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ehobpdhpip .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ehobpdhpip .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ehobpdhpip .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ehobpdhpip .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ehobpdhpip .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ehobpdhpip .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ehobpdhpip .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ehobpdhpip .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ehobpdhpip .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ehobpdhpip .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ehobpdhpip .gt_from_md > :first-child {
  margin-top: 0;
}

#ehobpdhpip .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ehobpdhpip .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ehobpdhpip .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#ehobpdhpip .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ehobpdhpip .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#ehobpdhpip .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ehobpdhpip .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ehobpdhpip .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ehobpdhpip .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ehobpdhpip .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#ehobpdhpip .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ehobpdhpip .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#ehobpdhpip .gt_left {
  text-align: left;
}

#ehobpdhpip .gt_center {
  text-align: center;
}

#ehobpdhpip .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ehobpdhpip .gt_font_normal {
  font-weight: normal;
}

#ehobpdhpip .gt_font_bold {
  font-weight: bold;
}

#ehobpdhpip .gt_font_italic {
  font-style: italic;
}

#ehobpdhpip .gt_super {
  font-size: 65%;
}

#ehobpdhpip .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="ehobpdhpip" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="2" class="gt_heading gt_title gt_font_normal" style>Average width of 80, 95, and 99% confidence intervals</th>
    </tr>
    <tr>
      <th colspan="2" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Confidence level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Mean width</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">80%</td>
      <td class="gt_row gt_right">0.172</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">95%</td>
      <td class="gt_row gt_right">0.268</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">99%</td>
      <td class="gt_row gt_right">0.348</td>
    </tr>
  </tbody>
  
  
</table></div>
<p>So in order to have a higher confidence level, our confidence intervals must be wider. Ideally, we would have both a high confidence level and narrow confidence intervals. However, we cannot have it both ways. If we want to <em>be more confident</em>, we need to allow for wider intervals. Conversely, if we would like a narrow interval, we must tolerate a lower confidence level.</p>
<p>The moral of the story is:  <strong>Higher confidence levels tend to produce wider confidence intervals.</strong> When looking at Table <a href="#tab:perc-cis-average-width"><strong>??</strong></a> it is important to keep in mind that we kept the sample size fixed at <span class="math inline">\(n = 50\)</span>. Thus, all <span class="math inline">\(10 \cdot 3 = 30\)</span> random samples from the <code>urn</code> had the same sample size. What happens if instead we took samples of different sizes? Recall that we did this in Subsection <a href="#different-shovels"><strong>??</strong></a> using virtual shovels with 25, 50, and 100 slots.</p>
</div>
<div id="fitting-multiple-models-using-map" class="section level3">
<h3><span class="header-section-number">1.3.2</span> Fitting multiple models using <code>map()</code></h3>
<p>Note that we have used the same code three times. That means we should write a function! Let’s adapt the code from the last section to take 10 samples of an arbitrary size and then construct confidence intervals of an arbitrary level:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>urn_confidence &lt;-<span class="st"> </span><span class="cf">function</span>(bowl, <span class="dt">n =</span> <span class="dv">50</span>, <span class="dt">level =</span> <span class="fl">0.95</span>) {</span>
<span id="cb64-2"><a href="#cb64-2"></a>  </span>
<span id="cb64-3"><a href="#cb64-3"></a>  <span class="co"># Get lower and upper probabilities</span></span>
<span id="cb64-4"><a href="#cb64-4"></a>  </span>
<span id="cb64-5"><a href="#cb64-5"></a>  lower_prob =<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>level) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb64-6"><a href="#cb64-6"></a>  upper_prob =<span class="st"> </span>level <span class="op">+</span><span class="st"> </span>lower_prob</span>
<span id="cb64-7"><a href="#cb64-7"></a>  </span>
<span id="cb64-8"><a href="#cb64-8"></a>  <span class="co"># Get 10 random samples</span></span>
<span id="cb64-9"><a href="#cb64-9"></a>  </span>
<span id="cb64-10"><a href="#cb64-10"></a>  bowl <span class="op">%&gt;%</span></span>
<span id="cb64-11"><a href="#cb64-11"></a><span class="st">    </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> n, <span class="dt">reps =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span></span>
<span id="cb64-12"><a href="#cb64-12"></a><span class="st">    </span></span>
<span id="cb64-13"><a href="#cb64-13"></a><span class="st">      </span><span class="co"># For each one, construct a CI</span></span>
<span id="cb64-14"><a href="#cb64-14"></a><span class="st">    </span></span>
<span id="cb64-15"><a href="#cb64-15"></a><span class="st">    </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span></span>
<span id="cb64-16"><a href="#cb64-16"></a><span class="st">    </span><span class="kw">nest</span>() <span class="op">%&gt;%</span></span>
<span id="cb64-17"><a href="#cb64-17"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">boots =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="st"> </span><span class="kw">rep_sample_n</span>(., <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">1000</span>)),</span>
<span id="cb64-18"><a href="#cb64-18"></a>           <span class="dt">prop_red_results =</span> <span class="kw">map</span>(boots, <span class="op">~</span><span class="st"> </span><span class="kw">group_by</span>(., replicate) <span class="op">%&gt;%</span></span>
<span id="cb64-19"><a href="#cb64-19"></a><span class="st">                                    </span><span class="kw">summarize</span>(<span class="dt">prop_red =</span> <span class="kw">mean</span>(color <span class="op">==</span><span class="st"> &quot;red&quot;</span>))),</span>
<span id="cb64-20"><a href="#cb64-20"></a>           <span class="dt">prop_red =</span> <span class="kw">map</span>(prop_red_results, <span class="op">~</span><span class="st"> </span><span class="kw">pull</span>(., prop_red)),</span>
<span id="cb64-21"><a href="#cb64-21"></a>           <span class="dt">lower =</span> <span class="kw">map_dbl</span>(prop_red, <span class="op">~</span><span class="st"> </span><span class="kw">quantile</span>(., <span class="dt">probs =</span> lower_prob)),</span>
<span id="cb64-22"><a href="#cb64-22"></a>           <span class="dt">upper =</span> <span class="kw">map_dbl</span>(prop_red, <span class="op">~</span><span class="st"> </span><span class="kw">quantile</span>(., <span class="dt">probs =</span> upper_prob)),</span>
<span id="cb64-23"><a href="#cb64-23"></a>           <span class="dt">sample_size =</span> n,</span>
<span id="cb64-24"><a href="#cb64-24"></a>           <span class="dt">confidence_level =</span> level) <span class="op">%&gt;%</span></span>
<span id="cb64-25"><a href="#cb64-25"></a><span class="st">    </span><span class="kw">select</span>(replicate, lower, upper, sample_size, confidence_level)</span>
<span id="cb64-26"><a href="#cb64-26"></a>}</span></code></pre></div>
<p>Note that we saved the sample size as <code>sample_size</code> and the confidence level as <code>confidence_level</code> for convenient display later.</p>
<p>So we now could create our objects like so:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>perc_cis_<span class="dv">80</span> &lt;-<span class="st"> </span><span class="kw">urn_confidence</span>(<span class="dt">bowl =</span> urn, <span class="dt">n =</span> <span class="dv">50</span>, <span class="dt">level =</span> <span class="fl">0.80</span>)</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>perc_cis_<span class="dv">95</span> &lt;-<span class="st"> </span><span class="kw">urn_confidence</span>(<span class="dt">bowl =</span> urn, <span class="dt">n =</span> <span class="dv">50</span>, <span class="dt">level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>perc_cis_<span class="dv">99</span> &lt;-<span class="st"> </span><span class="kw">urn_confidence</span>(<span class="dt">bowl =</span> urn, <span class="dt">n =</span> <span class="dv">50</span>, <span class="dt">level =</span> <span class="fl">0.99</span>)</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="co"># Combine into single data frame</span></span>
<span id="cb71-2"><a href="#cb71-2"></a></span>
<span id="cb71-3"><a href="#cb71-3"></a>percentile_cis_by_level &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(perc_cis_<span class="dv">80</span>, perc_cis_<span class="dv">95</span>, perc_cis_<span class="dv">99</span>)</span>
<span id="cb71-4"><a href="#cb71-4"></a>percentile_cis_by_level</span></code></pre></div>
<pre><code>## # A tibble: 30 x 5
## # Groups:   replicate [10]
##    replicate lower upper sample_size confidence_level
##        &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;            &lt;dbl&gt;
##  1         1 0.34   0.54          50              0.8
##  2         2 0.34   0.52          50              0.8
##  3         3 0.34   0.52          50              0.8
##  4         4 0.26   0.42          50              0.8
##  5         5 0.32   0.48          50              0.8
##  6         6 0.34   0.52          50              0.8
##  7         7 0.338  0.5           50              0.8
##  8         8 0.28   0.44          50              0.8
##  9         9 0.3    0.48          50              0.8
## 10        10 0.32   0.52          50              0.8
## # … with 20 more rows</code></pre>
<p>But this still isn’t the best way. Note that we have three objects we need to deal with. Furthermore, we don’t actually know that the names are accurate! Perhaps we made a mistake and created <code>perc_cis_99</code> with the code <code>perc_cis_99 &lt;- urn_confidence(urn, 50, 0.95)</code>; our object name will now be misleading as to what’s actually in the object.</p>
<p>Instead, let’s store our results in a single tibble by using <code>map()</code> to create a list column.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="kw">tibble</span>(<span class="dt">level =</span> <span class="kw">c</span>(<span class="fl">0.80</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>)) <span class="op">%&gt;%</span></span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">data =</span> <span class="kw">map</span>(level, <span class="op">~</span><span class="st"> </span><span class="kw">urn_confidence</span>(<span class="dt">bowl =</span> urn, <span class="dt">n =</span> <span class="dv">50</span>, <span class="dt">level =</span> .)))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 3 x 2
##   level data             
##   &lt;dbl&gt; &lt;list&gt;           
## 1  0.8  &lt;tibble [10 × 5]&gt;
## 2  0.95 &lt;tibble [10 × 5]&gt;
## 3  0.99 &lt;tibble [10 × 5]&gt;</code></pre>
<p>Now that we have a list column, we want to <code>unnest()</code> it so we can see our actual data. Further, we won’t need the redundant column <code>level</code> any more:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="kw">tibble</span>(<span class="dt">level =</span> <span class="kw">c</span>(<span class="fl">0.80</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>)) <span class="op">%&gt;%</span></span>
<span id="cb76-2"><a href="#cb76-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">data =</span> <span class="kw">map</span>(level, <span class="op">~</span><span class="st"> </span><span class="kw">urn_confidence</span>(<span class="dt">bowl =</span> urn, <span class="dt">n =</span> <span class="dv">50</span>, <span class="dt">level =</span> .))) <span class="op">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3"></a><span class="st">  </span><span class="kw">unnest</span>(data) <span class="op">%&gt;%</span></span>
<span id="cb76-4"><a href="#cb76-4"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>level)</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 30 x 5
##    replicate lower upper sample_size confidence_level
##        &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;            &lt;dbl&gt;
##  1         1  0.24 0.4            50              0.8
##  2         2  0.26 0.42           50              0.8
##  3         3  0.28 0.48           50              0.8
##  4         4  0.14 0.28           50              0.8
##  5         5  0.26 0.42           50              0.8
##  6         6  0.34 0.52           50              0.8
##  7         7  0.26 0.42           50              0.8
##  8         8  0.12 0.28           50              0.8
##  9         9  0.42 0.580          50              0.8
## 10        10  0.26 0.42           50              0.8
## # … with 20 more rows</code></pre>
<p>Now that we can create an object with any confidence level we please, why not calculate the widths for confidence levels from 0.50 to 0.99 and plot the results?</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="co"># Same code as before, but for more levels</span></span>
<span id="cb79-2"><a href="#cb79-2"></a></span>
<span id="cb79-3"><a href="#cb79-3"></a><span class="kw">tibble</span>(<span class="dt">level =</span> <span class="kw">seq</span>(<span class="fl">0.50</span>, <span class="fl">0.99</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)) <span class="op">%&gt;%</span></span>
<span id="cb79-4"><a href="#cb79-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">data =</span> <span class="kw">map</span>(level, <span class="op">~</span><span class="st"> </span><span class="kw">urn_confidence</span>(<span class="dt">bowl =</span> urn, <span class="dt">n =</span> <span class="dv">50</span>, <span class="dt">level =</span> .))) <span class="op">%&gt;%</span></span>
<span id="cb79-5"><a href="#cb79-5"></a><span class="st">  </span><span class="kw">unnest</span>(data) <span class="op">%&gt;%</span></span>
<span id="cb79-6"><a href="#cb79-6"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>level) <span class="op">%&gt;%</span></span>
<span id="cb79-7"><a href="#cb79-7"></a><span class="st">  </span></span>
<span id="cb79-8"><a href="#cb79-8"></a><span class="st">  </span><span class="co"># Calculate mean widths</span></span>
<span id="cb79-9"><a href="#cb79-9"></a><span class="st">  </span></span>
<span id="cb79-10"><a href="#cb79-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">width =</span> upper <span class="op">-</span><span class="st"> </span>lower) <span class="op">%&gt;%</span></span>
<span id="cb79-11"><a href="#cb79-11"></a><span class="st">  </span><span class="kw">group_by</span>(confidence_level) <span class="op">%&gt;%</span></span>
<span id="cb79-12"><a href="#cb79-12"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_width =</span> <span class="kw">mean</span>(width)) <span class="op">%&gt;%</span></span>
<span id="cb79-13"><a href="#cb79-13"></a><span class="st">  </span></span>
<span id="cb79-14"><a href="#cb79-14"></a><span class="st">  </span><span class="co"># Plot results</span></span>
<span id="cb79-15"><a href="#cb79-15"></a><span class="st">  </span></span>
<span id="cb79-16"><a href="#cb79-16"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> confidence_level, <span class="dt">y =</span> mean_width)) <span class="op">+</span></span>
<span id="cb79-17"><a href="#cb79-17"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb79-18"><a href="#cb79-18"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Confidence level&quot;</span>,</span>
<span id="cb79-19"><a href="#cb79-19"></a>       <span class="dt">y =</span> <span class="st">&quot;Mean width&quot;</span>,</span>
<span id="cb79-20"><a href="#cb79-20"></a>       <span class="dt">title =</span> <span class="st">&quot;Change in mean width of CI as level increase&quot;</span>)</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<p><img src="07-one-parameter_files/figure-html/unnamed-chunk-56-1.png" width="672"  /></p>
<p>As the confidence level gets larger, the width of the interval gets larger too.</p>
</div>
<div id="impact-of-sample-size" class="section level3">
<h3><span class="header-section-number">1.3.3</span> Impact of sample size</h3>
<p>This time, let’s fix the confidence level at 95%, but consider three different sample sizes for <span class="math inline">\(n\)</span>: 25, 50, and 100. Specifically, we’ll first take 10 different random samples of size 25, 10 different random samples of size 50, and 10 different random samples of size 100. We’ll then construct 95% percentile-based confidence intervals for each sample. Finally, we’ll compare the widths of these intervals.</p>
<p>Note that now that we have a function, <code>urn_confidence()</code>, we can do this very easily!</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="kw">set.seed</span>(<span class="dv">9</span>)</span>
<span id="cb81-2"><a href="#cb81-2"></a></span>
<span id="cb81-3"><a href="#cb81-3"></a></span>
<span id="cb81-4"><a href="#cb81-4"></a>perc_cis_n_<span class="dv">25</span>  &lt;-<span class="st"> </span><span class="kw">urn_confidence</span>(<span class="dt">bowl =</span> urn, <span class="dt">n =</span> <span class="dv">25</span>, <span class="dt">level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>perc_cis_n_<span class="dv">50</span>  &lt;-<span class="st"> </span><span class="kw">urn_confidence</span>(<span class="dt">bowl =</span> urn, <span class="dt">n =</span> <span class="dv">50</span>, <span class="dt">level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>perc_cis_n_<span class="dv">100</span> &lt;-<span class="st"> </span><span class="kw">urn_confidence</span>(<span class="dt">bowl =</span> urn, <span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="co"># Combine into single data frame</span></span>
<span id="cb87-2"><a href="#cb87-2"></a></span>
<span id="cb87-3"><a href="#cb87-3"></a>percentile_cis_by_n &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(perc_cis_n_<span class="dv">25</span>, perc_cis_n_<span class="dv">50</span>, perc_cis_n_<span class="dv">100</span>)</span></code></pre></div>
<p>Let’s compare the average widths in Table <a href="#tab:perc-cis-average-width-2"><strong>??</strong></a>. Observe that as the confidence intervals are constructed from larger and larger sample sizes, they tend to get narrower.</p>
<!-- Should switch all kable() tables to gt(), I think. Perhaps with a theme! Or at least with standard formatting. -->
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ldtxjfcsuv .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ldtxjfcsuv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ldtxjfcsuv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ldtxjfcsuv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ldtxjfcsuv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ldtxjfcsuv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ldtxjfcsuv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ldtxjfcsuv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ldtxjfcsuv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ldtxjfcsuv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ldtxjfcsuv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ldtxjfcsuv .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ldtxjfcsuv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ldtxjfcsuv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ldtxjfcsuv .gt_from_md > :first-child {
  margin-top: 0;
}

#ldtxjfcsuv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ldtxjfcsuv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ldtxjfcsuv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#ldtxjfcsuv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ldtxjfcsuv .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#ldtxjfcsuv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ldtxjfcsuv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ldtxjfcsuv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ldtxjfcsuv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ldtxjfcsuv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#ldtxjfcsuv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ldtxjfcsuv .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#ldtxjfcsuv .gt_left {
  text-align: left;
}

#ldtxjfcsuv .gt_center {
  text-align: center;
}

#ldtxjfcsuv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ldtxjfcsuv .gt_font_normal {
  font-weight: normal;
}

#ldtxjfcsuv .gt_font_bold {
  font-weight: bold;
}

#ldtxjfcsuv .gt_font_italic {
  font-style: italic;
}

#ldtxjfcsuv .gt_super {
  font-size: 65%;
}

#ldtxjfcsuv .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="ldtxjfcsuv" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="2" class="gt_heading gt_title gt_font_normal" style>Average width of 95% confidence intervals based on $n = 25$, $50f, and $100</th>
    </tr>
    <tr>
      <th colspan="2" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Sample size</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Mean width</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_right">25</td>
      <td class="gt_row gt_right">0.36410</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">50</td>
      <td class="gt_row gt_right">0.27405</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">100</td>
      <td class="gt_row gt_right">0.18605</td>
    </tr>
  </tbody>
  
  
</table></div>
<p>The moral of the story is:  <strong>Larger sample sizes tend to produce narrower confidence intervals.</strong> Recall that this was a key message in Subsection <a href="#moral-of-the-story"><strong>??</strong></a>. As we used larger and larger shovels for our samples, the sample proportions red, <span class="math inline">\(\widehat{p}\)</span>, tended to vary less. In other words, our estimates got more and more <em>precise</em>.</p>
<p>Recall that we visualized these results in Figure <a href="#fig:comparing-sampling-distributions-3"><strong>??</strong></a>, where we compared the <em>sampling distributions</em> for <span class="math inline">\(\widehat{p}\)</span> based on samples of size <span class="math inline">\(n\)</span> equal to 25, 50, and 100. We also quantified the sampling variation of these sampling distributions using their standard deviation, which has that special name: the <em>standard error</em>. So as the sample size increases, the standard error decreases.</p>
<p>Let’s do this again, but creating everything in a single tibble so we can look at sample sizes from 25 to 200:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="co"># Same code as before, but for more sample sizes</span></span>
<span id="cb89-2"><a href="#cb89-2"></a></span>
<span id="cb89-3"><a href="#cb89-3"></a><span class="kw">tibble</span>(<span class="dt">n =</span> <span class="kw">seq</span>(<span class="dv">25</span>, <span class="dv">200</span>, <span class="dt">by =</span> <span class="dv">5</span>)) <span class="op">%&gt;%</span></span>
<span id="cb89-4"><a href="#cb89-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">data =</span> <span class="kw">map</span>(n, <span class="op">~</span><span class="st"> </span><span class="kw">urn_confidence</span>(<span class="dt">bowl =</span> urn, <span class="dt">n =</span> ., <span class="dt">level =</span> <span class="fl">0.95</span>))) <span class="op">%&gt;%</span></span>
<span id="cb89-5"><a href="#cb89-5"></a><span class="st">  </span><span class="kw">unnest</span>(data) <span class="op">%&gt;%</span></span>
<span id="cb89-6"><a href="#cb89-6"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>n) <span class="op">%&gt;%</span></span>
<span id="cb89-7"><a href="#cb89-7"></a><span class="st">  </span></span>
<span id="cb89-8"><a href="#cb89-8"></a><span class="st">  </span><span class="co"># Calculate mean widths</span></span>
<span id="cb89-9"><a href="#cb89-9"></a><span class="st">  </span></span>
<span id="cb89-10"><a href="#cb89-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">width =</span> upper <span class="op">-</span><span class="st"> </span>lower) <span class="op">%&gt;%</span></span>
<span id="cb89-11"><a href="#cb89-11"></a><span class="st">  </span><span class="kw">group_by</span>(sample_size) <span class="op">%&gt;%</span></span>
<span id="cb89-12"><a href="#cb89-12"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_width =</span> <span class="kw">mean</span>(width)) <span class="op">%&gt;%</span></span>
<span id="cb89-13"><a href="#cb89-13"></a><span class="st">  </span></span>
<span id="cb89-14"><a href="#cb89-14"></a><span class="st">  </span><span class="co"># Plot results</span></span>
<span id="cb89-15"><a href="#cb89-15"></a><span class="st">  </span></span>
<span id="cb89-16"><a href="#cb89-16"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sample_size, <span class="dt">y =</span> mean_width)) <span class="op">+</span></span>
<span id="cb89-17"><a href="#cb89-17"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb89-18"><a href="#cb89-18"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Sample size&quot;</span>,</span>
<span id="cb89-19"><a href="#cb89-19"></a>       <span class="dt">y =</span> <span class="st">&quot;Mean width&quot;</span>,</span>
<span id="cb89-20"><a href="#cb89-20"></a>       <span class="dt">title =</span> <span class="st">&quot;Change in mean width of CI as sample size decreases&quot;</span>)</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<p><img src="07-one-parameter_files/figure-html/unnamed-chunk-59-1.png" width="672"  /></p>
<p>As the sample size gets larger, the width of the interval gets smaller.</p>
<!-- 
A good Learning check might be to have the readers calculate confidence intervals when n = 1000, 2000, 2400. To their astonishment (maybe), they'll see that the size of the confidence interval is 0 when they get to 2400. 
-->
<!-- DK: None of the above is bad, but it is all based on the urn. Why not do the same thing for the mean year of pennies? Could be quicker. Maybe with all the analysis combined. Or mayube that is what is about to happen now. -->
</div>
</div>
<div id="using-lm-and-tidy-as-a-shortcut" class="section level2">
<h2><span class="header-section-number">1.4</span> Using <code>lm()</code> and <code>tidy()</code> as a shortcut</h2>
<p>Recall the confidence interval we constructed for the mean year of the pennies using the percentile method:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a>virtual_resampled_means <span class="op">%&gt;%</span></span>
<span id="cb91-2"><a href="#cb91-2"></a><span class="st">  </span><span class="kw">pull</span>(mean_year) <span class="op">%&gt;%</span></span>
<span id="cb91-3"><a href="#cb91-3"></a><span class="st">  </span><span class="kw">quantile</span>(<span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##     2.5%    97.5% 
## 1991.200 1999.741</code></pre>
<p>Is there a way to construct that interval <em>without</em> engaging in the bootstrap resampling? That is, can we approximate this by using the <code>pennies_sample</code> tibble directly?</p>
<p>It turns out that we can, using the <code>lm()</code> function. <code>lm()</code> stands for <code>l</code>inear <code>m</code>odel, and we will be using it in the next two chapters. This function can get the mean of a variable using the following syntax:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="kw">lm</span>(year <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> pennies_sample)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = year ~ 1, data = pennies_sample)
## 
## Coefficients:
## (Intercept)  
##        1995</code></pre>
<!-- DK: Do we explain this later? If so, provide a link here. -->
<p>Once we learn about regression, we’ll learn why this is labeled the “intercept.” The key thing to note right now is that <code>lm()</code> takes two main arguments, <code>formula</code> and <code>data</code>. The notation <code>year ~ 1</code> will get the mean of <code>year</code>.</p>
<p>The <strong>broom</strong> package makes it easier to work with <code>lm()</code> model objects. In particular, the function <code>tidy()</code> has the option <code>conf.int = TRUE</code>, which we can use to get a confidence interval:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="kw">library</span>(broom)</span>
<span id="cb95-2"><a href="#cb95-2"></a></span>
<span id="cb95-3"><a href="#cb95-3"></a><span class="kw">lm</span>(year <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> pennies_sample) <span class="op">%&gt;%</span></span>
<span id="cb95-4"><a href="#cb95-4"></a><span class="st">  </span><span class="kw">tidy</span>(<span class="dt">conf.int =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 7
##   term        estimate std.error statistic   p.value conf.low conf.high
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)    1995.      2.15      930. 1.03e-105    1991.     2000.</code></pre>
<p>This presents a lot of columns that we don’t care about, so we will <code>select()</code> the relevant ones:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="kw">library</span>(broom)</span>
<span id="cb97-2"><a href="#cb97-2"></a><span class="kw">lm</span>(year <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> pennies_sample) <span class="op">%&gt;%</span></span>
<span id="cb97-3"><a href="#cb97-3"></a><span class="st">  </span><span class="kw">tidy</span>(<span class="dt">conf.int =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb97-4"><a href="#cb97-4"></a><span class="st">  </span><span class="kw">select</span>(estimate, conf.low, conf.high)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   estimate conf.low conf.high
##      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1    1995.    1991.     2000.</code></pre>
<!-- DK: Do we need more discussion here? In what sense is this approximation "close enough?" -->
<p>These are not identical to our bootstrap confidence interval estimates, but they are close enough. Thus, if you are interested in constructing a confidence interval for a mean, you can use <code>lm()</code> and <code>tidy()</code> as a shortcut. <code>tidy()</code> also has an argument, <code>conf.level</code>, which allows us to specify the confidence level. By default, it is 0.95.</p>
</div>
<div id="income-from-trains-using-bootstrap" class="section level2">
<h2><span class="header-section-number">1.5</span> Income from trains using Bootstrap</h2>
<p>In addition to using <code>lm()</code>, we can also use bootsrapping to extract confidence intervals. Bootstrapping is a significant tool used in statistics. Bootstrapping repeatedly draws samples from a data set and derives standard errors and confidence intervals for any statistic. While using <code>lm()</code> can produce confidence intervals for the mean of a data set or the coefficient in a regression, bootstrapping can produce confidence intervals for any statistics, such as median, 3rd highest value, etc.</p>
<p>To use bootstrapping, we will need the <strong>tidyverse</strong> and <strong>rsample</strong> packages. The <strong>rsample</strong> package gives us commands to use for bootstrapping. For the purpose of this example, let’s try to find the confidence interval for the mean income in our trains dataset from Chapter 3.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a><span class="co"># library(tidyverse)</span></span>
<span id="cb99-2"><a href="#cb99-2"></a><span class="co"># library(rsample)</span></span>
<span id="cb99-3"><a href="#cb99-3"></a><span class="co"># </span></span>
<span id="cb99-4"><a href="#cb99-4"></a><span class="co"># train_samples &lt;- bootstraps(trains, times = 1000)</span></span>
<span id="cb99-5"><a href="#cb99-5"></a><span class="co"># </span></span>
<span id="cb99-6"><a href="#cb99-6"></a><span class="co"># derive_mean_income &lt;- function(splits) {</span></span>
<span id="cb99-7"><a href="#cb99-7"></a><span class="co">#  x &lt;- analysis(splits)</span></span>
<span id="cb99-8"><a href="#cb99-8"></a><span class="co">#  return(mean(x$income))</span></span>
<span id="cb99-9"><a href="#cb99-9"></a><span class="co"># }</span></span>
<span id="cb99-10"><a href="#cb99-10"></a><span class="co"># </span></span>
<span id="cb99-11"><a href="#cb99-11"></a><span class="co"># train_samples$mean_income &lt;- map_dbl(train_samples$splits, derive_mean_income)</span></span>
<span id="cb99-12"><a href="#cb99-12"></a><span class="co"># quantile(train_samples$mean_income, probs = c(.025, .975))</span></span></code></pre></div>
<p>To find the confidence interval for the mean income in our train dataset, we first create our bootstrap samples using <code>bootstraps()</code>, where the times argument represents the number of bootstrap samples you want. Bootstrap samples are stored in a tibble and each bootstrap sample is nested in a split column. We then create a function for the statistic we are looking at; in this case, we want to focus on the mean income. Once we create our function, we can apply our statistic, the mean income, to each of our bootstrap samples by using map_dbl. Finally, we use quantile to extract our confidence intervals.</p>
<p>If we want to find a different statistic like the median income, we can essentially do the same thing but edit the function to derive the median income.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="co"># library(tidyverse)</span></span>
<span id="cb100-2"><a href="#cb100-2"></a><span class="co"># library(rsample)</span></span>
<span id="cb100-3"><a href="#cb100-3"></a><span class="co"># </span></span>
<span id="cb100-4"><a href="#cb100-4"></a><span class="co"># train_samples &lt;- bootstraps(trains, times = 1000)</span></span>
<span id="cb100-5"><a href="#cb100-5"></a><span class="co"># </span></span>
<span id="cb100-6"><a href="#cb100-6"></a><span class="co"># derive_median_income &lt;- function(splits) {</span></span>
<span id="cb100-7"><a href="#cb100-7"></a><span class="co">#  x &lt;- analysis(splits)</span></span>
<span id="cb100-8"><a href="#cb100-8"></a><span class="co">#  return(median(x$income))</span></span>
<span id="cb100-9"><a href="#cb100-9"></a><span class="co"># }</span></span>
<span id="cb100-10"><a href="#cb100-10"></a><span class="co"># </span></span>
<span id="cb100-11"><a href="#cb100-11"></a><span class="co"># train_samples$median_income &lt;- map_dbl(train_samples$splits, derive_median_income)</span></span>
<span id="cb100-12"><a href="#cb100-12"></a><span class="co"># quantile(train_samples$median_income, probs = c(.025, .975))</span></span></code></pre></div>
<p>Redo but more quickly, estimating mean income.</p>
<p>Estimate median income, or 3rd highest income.</p>
</div>
<div id="parameter-uncertainty-and-unmodeled-variation" class="section level2">
<h2><span class="header-section-number">1.6</span> Parameter Uncertainty and Unmodeled Variation</h2>
<p>Although, we have used bootstrap to predict what we think the mean or a parameter like the median will be, it is important to understand what parameter uncertainty is. Paraameter uncertainty refers to when exact values of parameters are unknown to experimenters and cannot be controlled for. These values usually cannot be inferred by statistical or computational methods. Let’s look at the confidence interval of the mean as an example. Based on our bootstrap method, the 95% CI for the mean income is [128999.8, 155201.6]. However, if we take into consideration parameter uncertainty here, we fall under the trap of overconfidence. This is because we do not know for sure the way our confidence interval is elicited is perfectly accurate. We are thus overconfident here when we use a confidence interval.</p>
<p>Furthermore, it is important that we understand what a residual is. The residual in data science is the error that results. In simple terms, it is the observed value minus the predicted value. So, for example, let’s say that the actual mean income is 140,000 but the predicted mean income we got was 130,000. That means the residual in our estimation is 10,000.</p>
<p>But the reason why residuals are so important is that they help explain why we can’t make perfect predictions, especially for an individual. In our experiments, there is a lot of unmodeled variation, or residual variation. Residual variance refers to the variance of residuals, and occurs because randomness in our data is inherently intrinsic. There will be randomness in our data even if we have full knowldge of our data. This thus implies that we cannot really make fully accurate predictions of the future; we can only make probabilistic predictions. It is essentially difficult to control for residual variation, and predictions we get from methods like bootstrapping should not be taken as the final concensus.</p>
<p>I might need to talk more about unmodeled variation here.</p>
</div>
<div id="case-study-two-prop-ci" class="section level2">
<h2><span class="header-section-number">1.7</span> Case study: Is yawning contagious?</h2>
<p>Let’s apply our knowledge of confidence intervals to answer the question: “Is yawning contagious?” If you see someone else yawn, are you more likely to yawn? In an episode of the US show <a href="http://www.discovery.com/tv-shows/mythbusters/mythbusters-database/yawning-contagious/"><em>Mythbusters</em></a>, the hosts conducted an experiment to answer this question. The episode is available to view in the United States on the Discovery Network website <a href="https://www.discovery.com/tv-shows/mythbusters/videos/is-yawning-contagious">here</a> and more information about the episode is also available on <a href="https://www.imdb.com/title/tt0768479/">IMDb</a>.</p>
<div id="mythbusters-study-data" class="section level3">
<h3><span class="header-section-number">1.7.1</span> <em>Mythbusters</em> study data</h3>
<!-- DK: Let's try to replace this data. First, we want to get rid of Modern Dive. Second, we need more political science. Also, ought to use the same terminology, at least for the first few chapters. So, instead of "seed", it should be treated, or whatever. I also don't think that "group" is a good variable name since it is a common argument in plotting. Also, need to re-visit RCM in every single chapter. -->
<p>Fifty adult participants who thought they were being considered for an appearance on the show were interviewed by a show recruiter. In the interview, the recruiter either yawned or did not. Participants then sat by themselves in a large van and were asked to wait. While in the van, the <em>Mythbusters</em> team watched the participants using a hidden camera to see if they yawned. The data frame containing the results of their experiment is available in the <code>mythbusters_yawn</code> data frame included in the <strong>moderndive</strong> package: </p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>mythbusters_yawn</span></code></pre></div>
<pre><code>## # A tibble: 50 x 3
##     subj group   yawn 
##    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;
##  1     1 seed    yes  
##  2     2 control yes  
##  3     3 seed    no   
##  4     4 seed    yes  
##  5     5 seed    no   
##  6     6 control no   
##  7     7 seed    yes  
##  8     8 control no   
##  9     9 control no   
## 10    10 seed    no   
## # … with 40 more rows</code></pre>
<p>The variables are:</p>
<ul>
<li><code>subj</code>: The participant ID with values 1 through 50.</li>
<li><code>group</code>: A binary <em>treatment</em> variable indicating whether the participant was exposed to yawning. <code>"seed"</code> indicates the participant was exposed to yawning while <code>"control"</code> indicates the participant was not.</li>
<li><code>yawn</code>: A binary <em>response</em> variable indicating whether the participant ultimately yawned.</li>
</ul>
<p>Recall that you learned about treatment and response variables in Appendix <a href="#rubin-causal-model">1.9</a>.</p>
<p>Let’s use some data wrangling to obtain counts of the four possible outcomes:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a>mythbusters_yawn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb103-2"><a href="#cb103-2"></a><span class="st">  </span><span class="kw">group_by</span>(group, yawn) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb103-3"><a href="#cb103-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">count =</span> <span class="kw">n</span>())</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;group&#39; (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 4 x 3
## # Groups:   group [2]
##   group   yawn  count
##   &lt;chr&gt;   &lt;chr&gt; &lt;int&gt;
## 1 control no       12
## 2 control yes       4
## 3 seed    no       24
## 4 seed    yes      10</code></pre>
<p>Let’s first focus on the <code>"control"</code> group participants who were not exposed to yawning. 12 such participants did not yawn, while 4 such participants did. So out of the 16 people who were not exposed to yawning, 4/16 = 0.25 = 25% did yawn.</p>
<p>Let’s now focus on the <code>"seed"</code> group participants who were exposed to yawning. Of these, 24 participants did not yawn, while 10 participants did yawn. So out of the 34 people who were exposed to yawning, 10/34 = 0.294 = 29.4% did yawn. Comparing these two percentages, the participants who were exposed to yawning yawned 29.4% - 25% = 4.4% more often than those who were not.</p>
</div>
<div id="sampling-scenario" class="section level3">
<h3><span class="header-section-number">1.7.2</span> Sampling scenario</h3>
<p>Let’s review the terminology and notation related to sampling we studied in Subsection <a href="#terminology-and-notation"><strong>??</strong></a>. In Chapter <a href="#sampling"><strong>??</strong></a> our <em>study population</em> was the urn of <span class="math inline">\(N = 2400\)</span> balls. Our <em>population parameter</em> of interest was the <em>population proportion</em> of these balls that were red, denoted mathematically by <span class="math inline">\(p\)</span>. In order to estimate <span class="math inline">\(p\)</span>, we extracted a sample of 50 balls using the shovel and computed the relevant <em>point estimate</em>: the <em>sample proportion</em> that were red, denoted mathematically by <span class="math inline">\(\widehat{p}\)</span>.</p>
<p>Who is the study population here? All humans? All the people who watch the show <em>Mythbusters</em>? It’s hard to say! This question can only be answered if we know how the show’s hosts recruited participants! In other words, what was the <em>sampling methodology</em> used by the <em>Mythbusters</em> to recruit participants? We alas are not provided with this information. Only for the purposes of this case study, however, we’ll <em>assume</em> that the 50 participants are a representative sample of all Americans given the popularity of this show. Thus, we’ll be assuming that any results of this experiment will generalize to all <span class="math inline">\(N = 327\)</span> million Americans (2018 population).</p>
<p>Just like with our sampling urn, the population parameter here will involve proportions. However, in this case it will be the <em>difference in population proportions</em> <span class="math inline">\(p_{seed} - p_{control}\)</span>, where <span class="math inline">\(p_{seed}\)</span> is the proportion of <em>all</em> Americans who if exposed to yawning will yawn themselves, and <span class="math inline">\(p_{control}\)</span> is the proportion of <em>all</em> Americans who, if not exposed to yawning, still yawn themselves. Correspondingly, the point estimate/sample statistic based the <em>Mythbusters</em>’ sample of participants will be the <em>difference in sample proportions</em> <span class="math inline">\(\widehat{p}_{seed} - \widehat{p}_{control}\)</span>. Let’s extend our table of scenarios of sampling for inference to include our latest scenario.</p>
<!-- DK: This seems like a great deal of work --- and weird work at that --- to make a simple table. Is this Google doc and/or rds used elsewhere? It is worth thinking about the collection of tables like this which appear in the book. How can they be made as similar as possible across the book? How can they be easily changed? Repitition is key. Indeed, a table like this every chapter should be matched to a problem set question and, eventually, to an exam. In this case, we need to apply this terminology to new cases. -->
<!-- This connects to the issue of similarity in terminology across chapters. seed is bad to use -->
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-68">TABLE 1.1: </span>Scenarios of sampling for inference
</caption>
<thead>
<tr>
<th style="text-align:right;">
Scenario
</th>
<th style="text-align:left;">
Population parameter
</th>
<th style="text-align:left;">
Notation
</th>
<th style="text-align:left;">
Point estimate
</th>
<th style="text-align:left;">
Symbol(s)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;width: 0.5in; ">
1
</td>
<td style="text-align:left;width: 1.5in; ">
Population proportion
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(p\)</span>
</td>
<td style="text-align:left;width: 1.6in; ">
Sample proportion
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(\widehat{p}\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.5in; ">
2
</td>
<td style="text-align:left;width: 1.5in; ">
Population mean
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(\mu\)</span>
</td>
<td style="text-align:left;width: 1.6in; ">
Sample mean
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(\overline{x}\)</span> or <span class="math inline">\(\widehat{\mu}\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.5in; ">
3
</td>
<td style="text-align:left;width: 1.5in; ">
Difference in population proportions
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(p_1 - p_2\)</span>
</td>
<td style="text-align:left;width: 1.6in; ">
Difference in sample proportions
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(\widehat{p}_1 - \widehat{p}_2\)</span>
</td>
</tr>
</tbody>
</table>
<p>This is known as a <em>two-sample</em> inference situation since we have two separate samples. Based on their two-samples of size <span class="math inline">\(n_{seed}\)</span> = 34 and <span class="math inline">\(n_{control}\)</span> = 16, the point estimate is</p>
<p><span class="math display">\[
\widehat{p}_{seed} - \widehat{p}_{control} = \frac{24}{34} - \frac{12}{16} = 0.04411765 \approx 4.4\%
\]</span></p>
<p>However, what if the <em>Mythbusters</em> repeated this experiment? Assume that they recruited 50 new participants and exposed 34 of them to yawning and 16 not. Would they obtain the exact same estimated difference of 4.4%? Probably not, again, because of <em>sampling variation</em>.</p>
<!-- DK: A suble point is whether or not we take the 34/16 split as given. That might not be worth even mentioning in this version, but if we had more advanced chapters, it should be. Similarly, we don't take about assumptions like SUTVA here, but that would belong elsewhere. Also, we need more explicit RCM discussion. Show a table of potential outcomes. -->
<!-- DK: Reading below, I see that we don't take 34/16 as given! Instead, we resample and individual groups of 50 can have very different splits. Should we discuss in the text? Should we have instructor notes throughout the text which over issues like this? Maybe the first version of the 1006 additional chapters starts with instructor notes in this book. Maybe the instructor notes start with comments like this? Note also, that, if initial split were more lopsided, we might get replicates which did not include data from both groups. How to handle that? -->
<p>How does this sampling variation affect their estimate of 4.4%? In other words, what would be a plausible range of values for this difference that accounts for this sampling variation? We can answer this question with confidence intervals! We will construct a 95% confidence interval for <span class="math inline">\(p_{seed} - p_{control}\)</span> using <em>bootstrap resampling with replacement</em>.</p>
<p>We make a couple of important notes. First, for the comparison between the <code>"seed"</code> and <code>"control"</code> groups to make sense, however, both groups need to be <em>independent</em> from each other. Otherwise, they could influence each other’s results. This means that a participant being selected for the <code>"seed"</code> or <code>"control"</code> group has no influence on another participant being assigned to one of the two groups. As an example, if there were a mother and her child as participants in the study, they wouldn’t necessarily be in the same group. They would each be assigned randomly to one of the two groups of the explanatory variable.</p>
<p>Second, the order of the subtraction in the difference doesn’t matter so long as you are consistent and tailor your interpretations accordingly. In other words, using a point estimate of <span class="math inline">\(\widehat{p}_{seed} - \widehat{p}_{control}\)</span> or <span class="math inline">\(\widehat{p}_{control} - \widehat{p}_{seed}\)</span> does not make a material difference, you just need to stay consistent and interpret your results accordingly.</p>
</div>
<div id="ci-build" class="section level3">
<h3><span class="header-section-number">1.7.3</span> Constructing the confidence interval</h3>
<p>Let’s first construct the bootstrap distribution for <span class="math inline">\(\widehat{p}_{seed} - \widehat{p}_{control}\)</span> and then use this to construct 95% confidence intervals for <span class="math inline">\(p_{seed} - p_{control}\)</span>.</p>
<p>Our first step is to perform <em>bootstrap resampling with replacement</em> like we did with the slips of paper in our pennies activity in Section <a href="#resampling-tactile">1.1</a>. However, instead of calculating a mean, we are now calculating a difference in means. As we’ll see, the basic process remains the same, which is one of the reasons the bootstrap is such a powerful tool.</p>
<p>We start by using <code>rep_sample_n()</code> to get 1,000 replicates, or, in other words, we bootstrap resample the 50 participants with replacement 1,000 times.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a>mythbusters_yawn <span class="op">%&gt;%</span></span>
<span id="cb106-2"><a href="#cb106-2"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">reps =</span> <span class="dv">1000</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 50,000 x 4
## # Groups:   replicate [1,000]
##    replicate  subj group   yawn 
##        &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;
##  1         1    35 seed    yes  
##  2         1    13 control no   
##  3         1    17 seed    no   
##  4         1    25 control yes  
##  5         1     4 seed    yes  
##  6         1    38 seed    no   
##  7         1    41 seed    no   
##  8         1    41 seed    no   
##  9         1    44 seed    no   
## 10         1    18 seed    no   
## # … with 49,990 more rows</code></pre>
<p>Observe that the resulting data frame has 50,000 rows. This is because we performed resampling of 50 participants with replacement 1,000 times and 50,000 = 1,000 <span class="math inline">\(\cdot\)</span> 50. The variable <code>replicate</code> indicates which resample each row belongs to. So it has the value <code>1</code> 50 times, the value <code>2</code> 50 times, all the way through to the value <code>1000</code> 50 times.</p>
<p>After we generate many replicates of bootstrap resampling with replacement, we next want to summarize the bootstrap resamples of size 50 with a single summary statistic, the difference in proportions. All this requires is taking the proportion of “yes” outcomes for both groups (control and seed) and then subtracting those proportions from one another. To do this, we will <code>group_by()</code> both <code>replicate</code> and <code>group</code>:</p>
<!-- DK: I think that we need more discussion of group_by() in all these examples, highlighting how we decide what goes in there. In fact, we need more of an attempt to find out what students find confusing and to help fix it in the book. -->
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a>mythbusters_yawn <span class="op">%&gt;%</span></span>
<span id="cb108-2"><a href="#cb108-2"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">reps =</span> <span class="dv">1000</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb108-3"><a href="#cb108-3"></a><span class="st">  </span><span class="kw">group_by</span>(replicate, group) <span class="op">%&gt;%</span></span>
<span id="cb108-4"><a href="#cb108-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">prop_yawn =</span> <span class="kw">mean</span>(yawn <span class="op">==</span><span class="st"> &quot;yes&quot;</span>))</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;replicate&#39; (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 2,000 x 3
## # Groups:   replicate [1,000]
##    replicate group   prop_yawn
##        &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;
##  1         1 control    0.0588
##  2         1 seed       0.182 
##  3         2 control    0.3   
##  4         2 seed       0.275 
##  5         3 control    0.316 
##  6         3 seed       0.258 
##  7         4 control    0.389 
##  8         4 seed       0.312 
##  9         5 control    0.385 
## 10         5 seed       0.162 
## # … with 1,990 more rows</code></pre>
<p>We now have two rows per <code>replicate</code>, the first being <code>control</code> and the second being <code>seed</code>. That means we can construct our difference in proportions by <code>group</code>ing <code>by</code> <code>replicate</code> and subtracting one <code>prop_yawn</code> from the other:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a>mythbusters_yawn <span class="op">%&gt;%</span></span>
<span id="cb111-2"><a href="#cb111-2"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">reps =</span> <span class="dv">1000</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb111-3"><a href="#cb111-3"></a><span class="st">  </span><span class="kw">group_by</span>(replicate, group) <span class="op">%&gt;%</span></span>
<span id="cb111-4"><a href="#cb111-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">prop_yawn =</span> <span class="kw">mean</span>(yawn <span class="op">==</span><span class="st"> &quot;yes&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb111-5"><a href="#cb111-5"></a><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> group, <span class="dt">values_from =</span> prop_yawn) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb111-6"><a href="#cb111-6"></a><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span></span>
<span id="cb111-7"><a href="#cb111-7"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">diff_prop_yawn =</span> seed <span class="op">-</span><span class="st"> </span>control)</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;replicate&#39; (override with `.groups` argument)</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 1,000 x 2
##    replicate diff_prop_yawn
##        &lt;int&gt;          &lt;dbl&gt;
##  1         1        0.0347 
##  2         2       -0.0146 
##  3         3        0.149  
##  4         4       -0.0492 
##  5         5        0.132  
##  6         6        0.0921 
##  7         7       -0.00794
##  8         8       -0.0190 
##  9         9        0.0153 
## 10        10        0.0746 
## # … with 990 more rows</code></pre>
<p>There are two important coding tricks. First, we use <code>group_by()</code> twice, once to perform a calculation for each <code>replicate</code> and <code>group</code>, and once to perform a calculation just for each <code>replicate</code>. Failure to keep track of exactly what is currently being <code>group_by()</code>’d is a common cause of bugs. Second, <code>pivot_wider()</code> helps us to bring values into the same row, this making later calculations (like subtraction) easier.</p>
<p>Observe that the resulting data frame has 1,000 rows and 2 columns corresponding to the 1,000 <code>replicate</code> ID’s and the 1,000 differences in proportions, one for each bootstrap resample, in <code>diff_prop_yawn</code>.</p>
<p>Next, let’s compute the 95% confidence interval for <span class="math inline">\(p_{seed} - p_{control}\)</span> using the percentile method, in other words, by identifying the 2.5th and 97.5th percentiles which include the middle 95% of values. Recall that this method does not require the bootstrap distribution to be normally shaped.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a>mythbusters_yawn <span class="op">%&gt;%</span></span>
<span id="cb115-2"><a href="#cb115-2"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">reps =</span> <span class="dv">1000</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb115-3"><a href="#cb115-3"></a><span class="st">  </span><span class="kw">group_by</span>(replicate, group) <span class="op">%&gt;%</span></span>
<span id="cb115-4"><a href="#cb115-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">prop_yawn =</span> <span class="kw">mean</span>(yawn <span class="op">==</span><span class="st"> &quot;yes&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb115-5"><a href="#cb115-5"></a><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> group, <span class="dt">values_from =</span> prop_yawn) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb115-6"><a href="#cb115-6"></a><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span></span>
<span id="cb115-7"><a href="#cb115-7"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">diff_prop_yawn =</span> seed <span class="op">-</span><span class="st"> </span>control) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb115-8"><a href="#cb115-8"></a><span class="st">  </span><span class="kw">pull</span>(diff_prop_yawn) <span class="op">%&gt;%</span></span>
<span id="cb115-9"><a href="#cb115-9"></a><span class="st">  </span><span class="kw">quantile</span>(<span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;replicate&#39; (override with `.groups` argument)</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>##       2.5%      97.5% 
## -0.2022059  0.3140117</code></pre>
<p>There is one value of particular interest that this 95% confidence interval contains: zero. If <span class="math inline">\(p_{seed} - p_{control}\)</span> were equal to 0, then there would be no difference in proportion yawning between the two groups. This would suggest that there is no associated effect of being exposed to a yawning recruiter on whether you yawn yourself.</p>
<p>In our case, since the 95% confidence interval includes 0, we cannot conclusively say if either proportion is larger. Of our 1,000 bootstrap resamples with replacement, sometimes <span class="math inline">\(\widehat{p}_{seed}\)</span> was higher and thus those exposed to yawning yawned themselves more often. At other times, the reverse happened.</p>
<p>Say, on the other hand, the 95% confidence interval was entirely above zero. This would suggest that <span class="math inline">\(p_{seed} - p_{control} &gt; 0\)</span>, or, in other words <span class="math inline">\(p_{seed} &gt; p_{control}\)</span>, and thus we’d have evidence suggesting those exposed to yawning do yawn more often.</p>
<p>Furthermore, if the 50 participants were randomly allocated to the <code>"seed"</code> and <code>"control"</code> groups, then this would be suggestive that being exposed to yawning doesn’t not <em>cause</em> yawning. In other words, yawning is not contagious. However, no information on how participants were assigned to be exposed to yawning or not could be found, so we cannot make such a causal statement.</p>
<!-- DK: The above discussion is not bad. But we should, each chapter, show an example of an NHST and then explain clearly why it is bad and stupid. -->
</div>
<div id="using-lm-and-tidy-as-a-shortcut-1" class="section level3">
<h3><span class="header-section-number">1.7.4</span> Using <code>lm()</code> and <code>tidy()</code> as a shortcut</h3>
<p>We have learned that you can use <code>lm()</code> as a shortcut to construct confidence interval for a mean. You can also use it to construct a confidence interval for a difference in means. Recall that you’ll need the <strong>broom</strong> package loaded in order to use the <code>tidy()</code> function. Let’s start by considering the <code>lm()</code> syntax:</p>
<!-- DK: The prior syntax, creating a logical value on the fly as our lefthand side variable, was problematic. This is not much better. Perhaps we should just have the yawn variable be 0/1 from the start? Also, is there a more natural way to use lm() within a pipe. -->
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a>mythbusters_yawn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb119-2"><a href="#cb119-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">yawn_numeric =</span> <span class="kw">ifelse</span>(yawn <span class="op">==</span><span class="st"> &quot;yes&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb119-3"><a href="#cb119-3"></a><span class="st">  </span><span class="kw">lm</span>(<span class="dt">formula =</span> yawn_numeric <span class="op">~</span><span class="st"> </span>group)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yawn_numeric ~ group, data = .)
## 
## Coefficients:
## (Intercept)    groupseed  
##     0.25000      0.04412</code></pre>
<p>There are three differences from what we’ve seen before. First, since <code>yawn</code> is a character variable, we had to create a new variable, <code>yawn_numeric</code>, which would take on the value 1 if there was a yawn and zero otherwise. Working with <code>lm()</code> requires numbers. Second, since we are interested in the difference in means by group, we used <code>group</code> instead of <code>1</code> on the right side of the <code>~</code>. Third, because we are using <code>lm()</code> within a pipe, we need to explicitly declare our formula. If, instead, we had used the <code>data</code> argument, this would not have been necessary.</p>
<p>Next, let’s <code>tidy()</code> this object:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a>mythbusters_yawn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb121-2"><a href="#cb121-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">yawn_numeric =</span> <span class="kw">ifelse</span>(yawn <span class="op">==</span><span class="st"> &quot;yes&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb121-3"><a href="#cb121-3"></a><span class="st">  </span><span class="kw">lm</span>(<span class="dt">formula =</span> yawn_numeric <span class="op">~</span><span class="st"> </span>group) <span class="op">%&gt;%</span></span>
<span id="cb121-4"><a href="#cb121-4"></a><span class="st">  </span><span class="kw">tidy</span>(<span class="dt">conf.int =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb121-5"><a href="#cb121-5"></a><span class="st">  </span><span class="kw">select</span>(term, estimate, conf.low, conf.high)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 4
##   term        estimate conf.low conf.high
##   &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)   0.25     0.0199     0.480
## 2 groupseed     0.0441  -0.235      0.323</code></pre>
<p>We are also <code>select</code>ing the <code>term</code> column, since now <code>lm()</code> gives estimates for two terms: <code>(Intercept)</code> and <code>groupseed</code>. We will hold off on interpreting <code>lm()</code> model objects until the next chapter, but, for now, all you need to know is that <code>groupseed</code> is the <code>term</code> that represents our difference in means. Let’s <code>filter()</code> to that <code>term</code>:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a>mythbusters_yawn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb123-2"><a href="#cb123-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">yawn_numeric =</span> <span class="kw">ifelse</span>(yawn <span class="op">==</span><span class="st"> &quot;yes&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb123-3"><a href="#cb123-3"></a><span class="st">  </span><span class="kw">lm</span>(<span class="dt">formula =</span> yawn_numeric <span class="op">~</span><span class="st"> </span>group) <span class="op">%&gt;%</span></span>
<span id="cb123-4"><a href="#cb123-4"></a><span class="st">  </span><span class="kw">tidy</span>(<span class="dt">conf.int =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb123-5"><a href="#cb123-5"></a><span class="st">  </span><span class="kw">select</span>(term, estimate, conf.low, conf.high) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb123-6"><a href="#cb123-6"></a><span class="st">  </span><span class="kw">filter</span>(term <span class="op">==</span><span class="st"> &quot;groupseed&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##   term      estimate conf.low conf.high
##   &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 groupseed   0.0441   -0.235     0.323</code></pre>
<p>Again, the confidence interval using <code>lm()</code> and <code>tidy()</code> is similar to what we saw using the bootstrap method, but <code>lm()</code> often runs much faster.</p>
</div>
</div>
<div id="ci-conclusion" class="section level2">
<h2><span class="header-section-number">1.8</span> Conclusion</h2>
<!-- DK: This section --- and, indeed, the conclusion to each chapter --- are very important. This is a real chance to hit all the highlights. Everything here should be considered fair game for the exam. Indeed, everything here should be covered in the exam. This one is not bad. But it could be cleaned up a bit, with much nicer plots. Maybe a table which directly compares bootstrap and sampling distributions. Need to remind people about why we bootstrap. (We do it because it proves that the lm() simple approaches make sense. It is the justification for our shortcuts. And, indeed, whenever those shortcuts don't work --- which is often! --- a bootstrap still will work.) -->
<div id="bootstrap-vs-sampling" class="section level3">
<h3><span class="header-section-number">1.8.1</span> Comparing bootstrap and sampling distributions</h3>
<p>Let’s talk more about the relationship between <em>sampling distributions</em> and <em>bootstrap distributions</em>.</p>
<p>Recall back in Subsection <a href="#shovel-1000-times"><strong>??</strong></a>, we took 1,000 virtual samples from the <code>urn</code> using a virtual shovel, computed 1,000 values of the sample proportion red <span class="math inline">\(\widehat{p}\)</span>, then visualized their distribution in a histogram. Recall that this distribution is called the <em>sampling distribution of</em> <span class="math inline">\(\widehat{p}\)</span> . Furthermore, the standard deviation of the sampling distribution has a special name: the <em>standard error</em>.</p>
<p>We also mentioned that this sampling activity does not reflect how sampling is done in real life. Rather, it was an <em>idealized version</em> of sampling so that we could study the effects of sampling variation on estimates, like the proportion of the shovel’s balls that are red. In real life, however, one would take a single sample that’s as large as possible, much like in the Obama poll we saw in Section <a href="#sampling-case-study"><strong>??</strong></a>. But how can we get a sense of the effect of sampling variation on estimates if we only have one sample and thus only one estimate? Don’t we need many samples and hence many estimates?</p>
<!-- DK: There is nothing wrong with this text, but I don't like it. We need a more coherent story connecting sampling to the bootstrap. Randomization is magic and these are two forms of randomization. Maybe each chapter after this should mention three types of randomization. These two and then assignment to treatment. Indeed, all of statistics is dealing with situations in which we could not use all three randomization techniques, or approximations thereto. -->
<p>The workaround to having a <em>single</em> sample was to perform <em>bootstrap resampling with replacement</em> from the single sample. We did this in the resampling activity in Section <a href="#resampling-tactile">1.1</a> where we focused on the mean year of minting of pennies. We used pieces of paper representing the original sample of 50 pennies from the bank and resampled them with replacement from a hat. We had 35 of our friends perform this activity and visualized the resulting 35 sample means <span class="math inline">\(\overline{x}\)</span> in a histogram in Figure <a href="#fig:tactile-resampling-6"><strong>??</strong></a>.</p>
<p>This distribution was called the <em>bootstrap distribution</em> of <span class="math inline">\(\overline{x}\)</span>. We stated at the time that the bootstrap distribution is an <em>approximation</em> to the sampling distribution of <span class="math inline">\(\overline{x}\)</span> in the sense that both distributions will have a similar shape and similar spread.  Thus the <em>standard error</em> of the bootstrap distribution can be used as an approximation to the <em>standard error</em> of the sampling distribution.
<!-- DK: The below seems useful, but does it belong in a Conclusion? Probably not. Perhaps each chapter ends with some stats nonsense (like CLT in sampling chapter) before we get to the real conclusion. --></p>
<p>Let’s show you that this is the case by now comparing these two types of distributions. Specifically, we’ll compare</p>
<ol style="list-style-type: decimal">
<li>the sampling distribution of <span class="math inline">\(\widehat{p}\)</span> based on 1,000 virtual samples from the <code>urn</code> from Subsection <a href="#shovel-1000-times"><strong>??</strong></a> to</li>
<li>the bootstrap distribution of <span class="math inline">\(\widehat{p}\)</span> based on 1,000 virtual resamples with replacement from Ilyas and Yohan’s single sample <code>urn_sample_1</code>.</li>
</ol>
<div id="sampling-distribution" class="section level4 unnumbered">
<h4>Sampling distribution</h4>
<p>Here is the code you saw in Subsection <a href="#shovel-1000-times"><strong>??</strong></a> to construct the sampling distribution of <span class="math inline">\(\widehat{p}\)</span> shown again in Figure <a href="#fig:sampling-distribution-part-deux"><strong>??</strong></a>, with some changes to incorporate the statistical terminology relating to sampling from Subsection <a href="#terminology-and-notation"><strong>??</strong></a>.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a><span class="co"># Take 1000 virtual samples of size 50 from the urn.</span></span>
<span id="cb125-2"><a href="#cb125-2"></a></span>
<span id="cb125-3"><a href="#cb125-3"></a><span class="co"># DK: Need to do a better job of ensuring that this is the same as the one</span></span>
<span id="cb125-4"><a href="#cb125-4"></a><span class="co"># &quot;seen&quot; before.</span></span>
<span id="cb125-5"><a href="#cb125-5"></a></span>
<span id="cb125-6"><a href="#cb125-6"></a><span class="kw">set.seed</span>(<span class="dv">76</span>)</span>
<span id="cb125-7"><a href="#cb125-7"></a></span>
<span id="cb125-8"><a href="#cb125-8"></a>virtual_samples &lt;-<span class="st"> </span>urn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb125-9"><a href="#cb125-9"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">reps =</span> <span class="dv">1000</span>)</span>
<span id="cb125-10"><a href="#cb125-10"></a></span>
<span id="cb125-11"><a href="#cb125-11"></a><span class="co"># Compute the sampling distribution of 1000 values of p-hat</span></span>
<span id="cb125-12"><a href="#cb125-12"></a></span>
<span id="cb125-13"><a href="#cb125-13"></a>sampling_distribution &lt;-<span class="st"> </span>virtual_samples <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb125-14"><a href="#cb125-14"></a><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb125-15"><a href="#cb125-15"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">red =</span> <span class="kw">sum</span>(color <span class="op">==</span><span class="st"> &quot;red&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb125-16"><a href="#cb125-16"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop_red =</span> red <span class="op">/</span><span class="st"> </span><span class="dv">50</span>)</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a><span class="co"># Visualize sampling distribution of p-hat</span></span>
<span id="cb127-2"><a href="#cb127-2"></a></span>
<span id="cb127-3"><a href="#cb127-3"></a>sampling_distribution <span class="op">%&gt;%</span></span>
<span id="cb127-4"><a href="#cb127-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> prop_red)) <span class="op">+</span></span>
<span id="cb127-5"><a href="#cb127-5"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.05</span>, <span class="dt">boundary =</span> <span class="fl">0.4</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb127-6"><a href="#cb127-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Proportion of 50 balls that were red&quot;</span>, </span>
<span id="cb127-7"><a href="#cb127-7"></a>       <span class="dt">title =</span> <span class="st">&quot;Sampling distribution&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-76"></span>
<p class="caption marginnote shownote">
FIGURE 1.19: Previously seen sampling distribution of sample proportion red for <span class="math inline">\(n = 1000\)</span>.
</p>
<img src="07-one-parameter_files/figure-html/unnamed-chunk-76-1.png" alt="Previously seen sampling distribution of sample proportion red for $n = 1000$." width="672"  />
</div>
<p>An important thing to keep in mind is the default value for <code>replace</code> is <code>FALSE</code> when using <code>rep_sample_n()</code>. This is because when sampling 50 balls with a shovel, we are extracting 50 balls one-by-one <em>without</em> replacing them. This is in contrast to bootstrap resampling <em>with</em> replacement, where we resample a ball and put it back, and repeat this process 50 times.</p>
<p>Let’s quantify the variability in this sampling distribution by calculating the standard deviation of the <code>prop_red</code> variable representing 1,000 values of the sample proportion <span class="math inline">\(\widehat{p}\)</span>. Remember that the standard deviation of the sampling distribution is the <em>standard error</em>, frequently denoted as <code>se</code>.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a>sampling_distribution <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">se =</span> <span class="kw">sd</span>(prop_red))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##       se
##    &lt;dbl&gt;
## 1 0.0667</code></pre>
</div>
<div id="bootstrap-distribution" class="section level4 unnumbered">
<h4>Bootstrap distribution</h4>
<p>Here is the code to construct the bootstrap distribution of <span class="math inline">\(\widehat{p}\)</span> based on Ilyas and Yohan’s original sample of 50 balls saved in <code>urn_sample_1</code>.</p>
<!-- DK: This is still ugly. Might also be nice to show this exercise with sampling of 100, 1000, 10000 and then 100000, in order to show how things smooth out and look more normal as n increases. -->
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a><span class="kw">set.seed</span>(<span class="dv">14</span>)</span>
<span id="cb130-2"><a href="#cb130-2"></a>bootstrap_distribution &lt;-<span class="st"> </span>urn_sample_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb130-3"><a href="#cb130-3"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">reps =</span> <span class="dv">1000</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb130-4"><a href="#cb130-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">prop_red =</span> <span class="kw">mean</span>(color <span class="op">==</span><span class="st"> &quot;red&quot;</span>))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1"></a>bootstrap_distribution <span class="op">%&gt;%</span></span>
<span id="cb132-2"><a href="#cb132-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> prop_red)) <span class="op">+</span></span>
<span id="cb132-3"><a href="#cb132-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.05</span>, <span class="dt">boundary =</span> <span class="fl">0.4</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb132-4"><a href="#cb132-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Proportion of 50 balls that were red&quot;</span>,</span>
<span id="cb132-5"><a href="#cb132-5"></a>       <span class="dt">title =</span> <span class="st">&quot;Bootstrap distribution&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-81"></span>
<p class="caption marginnote shownote">
FIGURE 1.20: Bootstrap distribution of proportion red for <span class="math inline">\(n = 1000\)</span>.
</p>
<img src="07-one-parameter_files/figure-html/unnamed-chunk-81-1.png" alt="Bootstrap distribution of proportion red for $n = 1000$." width="672"  />
</div>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a>bootstrap_distribution <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">se =</span> <span class="kw">sd</span>(prop_red))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##       se
##    &lt;dbl&gt;
## 1 0.0675</code></pre>
</div>
<div id="comparison" class="section level4 unnumbered">
<h4>Comparison</h4>
<p>Now that we have computed both the sampling distribution and the bootstrap distributions, let’s compare them side-by-side in Figure <a href="#fig:side-by-side"><strong>??</strong></a>. We’ll make both histograms have matching scales on the x- and y-axes to make them more comparable. Furthermore, we’ll add:</p>
<ol style="list-style-type: decimal">
<li>To the sampling distribution on the top: a solid line denoting the proportion of the urn’s balls that are red <span class="math inline">\(p\)</span> = 0.375.</li>
<li>To the bootstrap distribution on the bottom: a dashed line at the sample proportion <span class="math inline">\(\widehat{p}\)</span> = 21/50 = 0.42 = 42% that Ilyas and Yohan observed.</li>
</ol>
<div class="figure"><span id="fig:unnamed-chunk-85"></span>
<p class="caption marginnote shownote">
FIGURE 1.21: Comparing the sampling and bootstrap distributions of <span class="math inline">\(\widehat{p}\)</span>.
</p>
<img src="07-one-parameter_files/figure-html/unnamed-chunk-85-1.png" alt="Comparing the sampling and bootstrap distributions of $\widehat{p}$." width="672"  />
</div>
<p>There is a lot going on in Figure <a href="#fig:side-by-side"><strong>??</strong></a>, so let’s break down all the comparisons slowly. First, observe how the sampling distribution on top is centered at <span class="math inline">\(p\)</span> = 0.375. This is because the sampling is done at random and in an unbiased fashion. So the estimates <span class="math inline">\(\widehat{p}\)</span> are centered at the true value of <span class="math inline">\(p\)</span>.</p>
<p>However, this is not the case with the following bootstrap distribution. The bootstrap distribution is centered at 0.42, which is the proportion red of Ilyas and Yohan’s 50 sampled balls. This is because we are resampling from the same sample over and over again. Since the bootstrap distribution is centered at the original sample’s proportion, it doesn’t necessarily provide a better estimate of <span class="math inline">\(p\)</span> = 0.375. This leads us to our first lesson about bootstrapping:</p>
<blockquote>
<p>The bootstrap distribution will likely not have the same center as the sampling distribution. In other words, bootstrapping cannot improve the quality of an estimate.</p>
</blockquote>
<p>Second, let’s now compare the spread of the two distributions: they are somewhat similar. In the previous code, we computed the standard deviations of both distributions as well. Recall that such standard deviations have a special name: <em>standard errors</em>. Let’s compare them in Table <a href="#tab:comparing-se"><strong>??</strong></a>.</p>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#fbgiluhkuj .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fbgiluhkuj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fbgiluhkuj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fbgiluhkuj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fbgiluhkuj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fbgiluhkuj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fbgiluhkuj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fbgiluhkuj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fbgiluhkuj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fbgiluhkuj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fbgiluhkuj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fbgiluhkuj .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#fbgiluhkuj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fbgiluhkuj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fbgiluhkuj .gt_from_md > :first-child {
  margin-top: 0;
}

#fbgiluhkuj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fbgiluhkuj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fbgiluhkuj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#fbgiluhkuj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fbgiluhkuj .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#fbgiluhkuj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fbgiluhkuj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fbgiluhkuj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fbgiluhkuj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fbgiluhkuj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#fbgiluhkuj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fbgiluhkuj .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#fbgiluhkuj .gt_left {
  text-align: left;
}

#fbgiluhkuj .gt_center {
  text-align: center;
}

#fbgiluhkuj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fbgiluhkuj .gt_font_normal {
  font-weight: normal;
}

#fbgiluhkuj .gt_font_bold {
  font-weight: bold;
}

#fbgiluhkuj .gt_font_italic {
  font-style: italic;
}

#fbgiluhkuj .gt_super {
  font-size: 65%;
}

#fbgiluhkuj .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="fbgiluhkuj" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="2" class="gt_heading gt_title gt_font_normal" style>Comparing standard errors</th>
    </tr>
    <tr>
      <th colspan="2" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Distribution type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Standard Error</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">Sampling distribution</td>
      <td class="gt_row gt_right">0.067</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">Bootstrap distribution</td>
      <td class="gt_row gt_right">0.067</td>
    </tr>
  </tbody>
  
  
</table></div>
<p>Notice that the bootstrap distribution’s standard error is a rather good <em>approximation</em> to the sampling distribution’s standard error. This leads us to our second lesson about bootstrapping:</p>
<blockquote>
<p>Even if the bootstrap distribution might not have the same center as the sampling distribution, it will likely have very similar shape and spread. In other words, bootstrapping will give you a good estimate of the <em>standard error</em>.</p>
</blockquote>
<p>Thus, using the fact that the bootstrap distribution and sampling distributions have similar spreads, we can build confidence intervals using bootstrapping as we’ve done all throughout this chapter!</p>
</div>
</div>
</div>
<div id="rubin-causal-model" class="section level2">
<h2><span class="header-section-number">1.9</span> Rubin Causal Model</h2>
<!-- At least then we could have an average blood pressure for the respondents in our sample, right? -->
<!-- Not so fast! It is probably not reasonable to assume that every blood pressure measurement is perfectly accurate.  Some survey respondents may misremember or round the values, or use measurements from a doctor's visit long ago.  (How many American adults own blood pressure monitors?)  Furthermore, blood pressure monitors aren't 100% accurate. -->
<!-- One's blood pressure reading also isn't a single, constant number, even if it could be perfectly measured: it depends on the time of day, whether one exercised or ate before taking the measurement, and so on. -->
<!-- So what we really should do is think of each measurement as being drawn from a distribution of potential values for each person; we could construct a *confidence interval* around each of the values to try to reflect these sources of error.  Let's say that a fair CI is 15 points in either direction.  (It may actually be higher; this is just for illustration.)  Then our table really looks something like this: -->
<!-- ```{r, echo = FALSE} -->
<!-- # First, we create a tibble with the values we want for the table -->
<!-- tibble(subject = c("Respondent 1", "Respondent 2", "Respondent 3", "...", "Respondent 1,000"), -->
<!--        `Blood Pressure` = c("130 (115, 145)", "110 (95, 125)", "115 (100, 130)", "...", "140 (125, 155)")) %>% -->
<!--   # Then, we use the gt function to make it pretty -->
<!--   gt() %>% -->
<!--   cols_label(subject = md("**Respondent**")) %>% -->
<!--   tab_style(cell_borders(sides = "right"), -->
<!--             location = cells_body(columns = vars(subject))) %>% -->
<!--   tab_style(cell_text(weight = "bold"), -->
<!--             location = cells_body(columns = vars(subject))) -->
<!-- ``` -->
<!-- 1. **Uncertainty in estimating the ATE**.  Even if treatment is randomly assigned, and thus $\widehat{ATE}$ is an unbiased estimate of the true ATE, we still may not have a very *precise* estimate if our sample is small.  With this miniscule sample (five sujects!), the uncertainty might be gigantic, perhaps someting like ($-25$, $13$), which would lead to a prediction for Joe of ($117, 155$).  As we get a larger sample size, this uncertainty decreases.   -->
<!-- 1. **Individual variation**.  Even if we have a perfect estimate of the *average* treatment effect, it still may be the case that the effect *for Joe* is higher or lower than average.  We can assume this away if we say that the treatment effect is a constant $\tau$ for everyone, but that is not likely to be true in the real world --- and this source of uncertainty does not go away simply by collecting more observations.  So with a large sample, let's say that we calculated a confidence interval around $\widehat{ATE}$ of ($-6, -5.67$), leading to an interval for Joe's outcome under control of ($135.67, 136$).  The uncertainty due to individual variation may still be a great deal higher---say ($120, 152$).  These numbers are simply illustrative, but they highlight an important point: even if you have a good estimate of the ATE, you should still be much more uncertain about the causal effect for any *particular individual*. -->
<!-- The main takeaway is that we can get rid of #1 by collecting more data, but the only way to get rid of #2 is through making assumptions, potentially very strong ones. -->
</div>
<div id="conclusion" class="section level2">
<h2><span class="header-section-number">1.10</span> Conclusion</h2>
<!--
Other stuff which might be added

The kind of computer-based statistical inference we've seen so far has a particular name in the field of statistics: *simulation-based inference*. This is because we are performing statistical inference using computer simulations.\index{simulation-based inference} In our opinion, two large benefits of simulation-based methods over theory-based methods are that (1) they are easier for people new to statistical inference to understand and (2) they also work in situations where theory-based methods and mathematical formulas don't exist.


#### Confidence intervals based on 100 virtual samples {-}

Let's say, however, we repeated this 100 times, not tactilely, but virtually. Let's do this only 100 times instead of 1000 like we did before so that the results can fit on the screen. Again, the steps for compute a 95% confidence interval for $p$ are:

1. Collect a sample of size $n = 50$ as we did in Chapter \@ref(sampling)
1. Compute $\widehat{p}$: the sample proportion red of these $n$ = 50 balls
1. Compute the standard error $\text{SE} = \sqrt{\frac{\widehat{p}(1-\widehat{p})}{n}}$
1. Compute the margin of error $\text{MoE} = 1.96 \cdot \text{SE} =  1.96 \cdot \sqrt{\frac{\widehat{p}(1-\widehat{p})}{n}}$
1. Compute both end points of the confidence interval:
    + `lower_ci`: $\widehat{p} - \text{MoE} = \widehat{p} - 1.96 \cdot \text{SE} = \widehat{p} - 1.96 \cdot \sqrt{\frac{\widehat{p}(1-\widehat{p})}{n}}$
    + `upper_ci`: $\widehat{p} + \text{MoE} = \widehat{p} + 1.96 \cdot \text{SE} = \widehat{p} +1.96 \cdot \sqrt{\frac{\widehat{p}(1-\widehat{p})}{n}}$

Run the following three steps, being sure to `View()` the resulting data frame after each step so you can convince yourself of what's going on:


```r
# First: Take 100 virtual samples of n=50 balls
virtual_samples <- urn %>% 
  rep_sample_n(size = 50, reps = 100)

# Second: For each virtual sample compute the proportion red
virtual_prop_red <- virtual_samples %>% 
  group_by(replicate) %>% 
  summarize(red = sum(color == "red")) %>% 
  mutate(prop_red = red / 50)

# Third: Compute the 95% confidence interval as before
virtual_prop_red <- virtual_prop_red %>% 
  rename(p_hat = prop_red) %>% 
  mutate(
    n = 50,
    SE = sqrt(p_hat*(1-p_hat)/n),
    MoE = 1.96 * SE,
    lower_ci = p_hat - MoE,
    upper_ci = p_hat + MoE
  )
```

Here are the results:



We see that of our 100 confidence intervals based on samples of size $n$ = 50, `sum(virtual_prop_red[["captured"]])` of them captured the true $p = 900/2400$, whereas `100 - sum(virtual_prop_red[["captured"]])` of them missed. As we create more and more confidence intervals based on more and more samples, about 95% of these intervals will capture. In other words, our procedure is "95% reliable." 
-->
</div>
<!-- </div> -->
<!--bookdown:body:end-->



</body>
</html>
